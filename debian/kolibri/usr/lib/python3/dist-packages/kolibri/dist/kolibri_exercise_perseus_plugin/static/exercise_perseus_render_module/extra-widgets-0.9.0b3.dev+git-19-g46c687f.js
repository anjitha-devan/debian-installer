webpackJsonp([0],{668:function(e,t,n){e.exports=[[n(681),!1],[n(682),!1],[n(683),!1],[n(684),!1],[n(685),!1],[n(686),!1],[n(673),!1],[n(691),!1],[n(692),!1],[n(693),!1],[n(694),!1],[n(695),!1],[n(696),!1],[n(698),!1],[n(699),!1],[n(700),!1],[n(701),!1],[n(677),!1],[n(705),!1],[n(706),!1],[n(707),!1],[n(247),!1],[n(715),!1],[n(716),!1],[n(717),!1],[n(718),!1],[n(719),!1],[n(720),!1],[n(721),!1],[n(722),!1],[n(723),!1],[n(725),!1],!1,!1,!1]},669:function(e,t,n){n(670).babelPluginFlowReactPropTypes_proptype_DOMRange||n(0).PropTypes.any,n(670).babelPluginFlowReactPropTypes_proptype_DOMHighlightSet||n(0).PropTypes.any,n(670).babelPluginFlowReactPropTypes_proptype_DOMHighlight||n(0).PropTypes.any;Object.defineProperty(e.exports,"babelPluginFlowReactPropTypes_proptype_Position",n(0).PropTypes.shape({left:n(0).PropTypes.number.isRequired,top:n(0).PropTypes.number.isRequired})),Object.defineProperty(e.exports,"babelPluginFlowReactPropTypes_proptype_ZIndexes",n(0).PropTypes.shape({aboveContent:n(0).PropTypes.number.isRequired,belowContent:n(0).PropTypes.number.isRequired}))},670:function(e,t,n){Object.defineProperty(e.exports,"babelPluginFlowReactPropTypes_proptype_SerializedRange",n(0).PropTypes.shape({type:n(0).PropTypes.oneOf(["word-indexes"]).isRequired,firstWordIndex:n(0).PropTypes.number.isRequired,lastWordIndex:n(0).PropTypes.number.isRequired})),Object.defineProperty(e.exports,"babelPluginFlowReactPropTypes_proptype_DOMHighlight",n(0).PropTypes.shape({firstWordIndex:n(0).PropTypes.number.isRequired,lastWordIndex:n(0).PropTypes.number.isRequired,domRange:n(0).PropTypes.any.isRequired})),Object.defineProperty(e.exports,"babelPluginFlowReactPropTypes_proptype_DOMHighlightSet",n(0).PropTypes.shape({})),Object.defineProperty(e.exports,"babelPluginFlowReactPropTypes_proptype_SerializedHighlight",n(0).PropTypes.shape({range:n(0).PropTypes.shape({type:n(0).PropTypes.oneOf(["word-indexes"]).isRequired,firstWordIndex:n(0).PropTypes.number.isRequired,lastWordIndex:n(0).PropTypes.number.isRequired}).isRequired})),Object.defineProperty(e.exports,"babelPluginFlowReactPropTypes_proptype_SerializedHighlightSet",n(0).PropTypes.shape({}))},671:function(e,t,n){(function(t){var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(21),i=n(0),s=n(8),a=n(1),p=n(19).firstNumericalParse,l=n(19).captureScratchpadTouchStart,u=n(9).number,c=n(43),h=c.toNumericString,d=c.getNumericFormat,f=i.createClass({displayName:"NumberInput",propTypes:{value:i.PropTypes.number,format:i.PropTypes.string,placeholder:i.PropTypes.oneOfType([i.PropTypes.string,i.PropTypes.number]),onChange:i.PropTypes.func.isRequired,onFormatChange:i.PropTypes.func,checkValidity:i.PropTypes.func,size:i.PropTypes.string,label:i.PropTypes.oneOf(["put your labels outside your inputs!"])},getDefaultProps:function(){return{value:null,placeholder:null,format:null,onFormatChange:function(){return null},checkValidity:function(){return!0},useArrowKeys:!1}},getInitialState:function(){return{format:this.props.format}},render:function(){var e=o({"number-input":!0,"invalid-input":!this._checkValidity(this.props.value),mini:"mini"===this.props.size,small:"small"===this.props.size,normal:"normal"===this.props.size});return null!=this.props.className&&(e=e+" "+this.props.className),i.createElement("input",r({},this.props,{className:e,type:"text",ref:"input",onChange:this._handleChange,onFocus:this._handleFocus,onBlur:this._handleBlur,onKeyPress:this._handleBlur,onKeyDown:this._onKeyDown,onTouchStart:l,defaultValue:h(this.props.value,this.state.format),value:void 0}))},componentDidUpdate:function(e){u.equal(this.getValue(),this.props.value)||this._setValue(this.props.value,this.state.format)},getValue:function(){return this.parseInputValue(s.findDOMNode(this.refs.input).value)},getStringValue:function(){return s.findDOMNode(this.refs.input).value.toString()},parseInputValue:function(e){if(""===e){var t=this.props.placeholder;return a.isFinite(t)?+t:null}var n=p(e);return a.isFinite(n)?n:this.props.value},focus:function(){s.findDOMNode(this.refs.input).focus(),this._handleFocus()},blur:function(){s.findDOMNode(this.refs.input).blur(),this._handleBlur()},setSelectionRange:function(e,t){s.findDOMNode(this).setSelectionRange(e,t)},getSelectionStart:function(){return s.findDOMNode(this).selectionStart},getSelectionEnd:function(){return s.findDOMNode(this).selectionEnd},_checkValidity:function(e){if(null==e)return!0;var t=p(e),n=this.props.checkValidity;return a.isFinite(t)&&n(t)},_handleChange:function(e){var t=e.target.value,n=this.parseInputValue(t),r=d(t);this.props.onChange(n),r&&(this.props.onFormatChange(n,r),this.setState({format:r}))},_handleFocus:function(){this.props.onFocus&&this.props.onFocus()},_handleBlur:function(e){e&&"keypress"===e.type&&13!==e.keyCode||(this._setValue(this.props.value,this.state.format),this.props.onBlur&&this.props.onBlur())},_onKeyDown:function(e){if(this.props.onKeyDown&&this.props.onKeyDown(e),this.props.useArrowKeys&&a.contains(["ArrowUp","ArrowDown"],e.key)){var t=this.getValue();t===Math.floor(t)&&("ArrowUp"===e.key?t+=1:"ArrowDown"===e.key&&(t-=1),this._checkValidity(t)&&this.props.onChange(t))}},_setValue:function(e,n){t(s.findDOMNode(this.refs.input)).val(h(e,n))}});e.exports=f}).call(t,n(10))},672:function(e,t,n){function r(e,t,n,r){var o=void 0;return o="start"===t&&"start"===r?Range.START_TO_START:"start"===t&&"end"===r?Range.END_TO_START:"end"===t&&"start"===r?Range.START_TO_END:Range.END_TO_END,e.compareBoundaryPoints(o,n)}function o(e,t){var n=e.cloneRange();return n.setEnd(t.endContainer,t.endOffset),n}function i(e,t){return!(r(e,"end",t,"start")<0||r(t,"end",e,"start")<0)}function s(e,t){return r(e,"start",t,"start")<=0&&r(e,"end",t,"end")>=0}function a(e,t){return i(e,t)?o(r(e,"start",t,"start")>0?e:t,r(e,"end",t,"end")<0?e:t):null}function p(e,t){return i(e,t)?o(r(e,"start",t,"start")<0?e:t,r(e,"end",t,"end")>0?e:t):null}function l(e,t,n,o,i){for(var s=-1,a=o,p=i,l=0;a<=p;){if(++l>2*t.length)throw new Error("Assertion error: Binary search isn't terminating? lower="+a+", upper="+p);var u=Math.floor((a+p)/2);"first"===n?r(t[u],"end",e,"start")<=0?a=u+1:(s=u,p=u-1):r(t[u],"start",e,"end")>=0?p=u-1:(s=u,a=u+1)}return s}function u(e,t){var n=l(e,t,"first",0,t.length-1);if(n<0)return null;var r=l(e,t,"last",n,t.length-1);return r<0?null:[n,r]}n(670).babelPluginFlowReactPropTypes_proptype_DOMRange||n(0).PropTypes.any;e.exports={findFirstAndLastWordIndexes:u,rangesOverlap:i,rangeIncludes:s,intersectRanges:a,unionRanges:p,spanRanges:o}},673:function(e,t,n){(function(t){var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(21),i=n(0),s=n(1),a=n(13).Options,p=n(143),l=n(90),u=l.iconOk,c=l.iconRemove,h=n(91),d=n(32),f=n(690),g=n(24),m=g.gray76,y=g.phoneMargin,v=g.negativePhoneMargin,b=g.tableBackgroundAccent,T=g.kaGreen,P=n(6),x=P.StyleSheet,C=P.css,w=n(22),E=w.linterContextProps,k=w.linterContextDefault,S={ungraded:"ungraded",correct:"correct",incorrect:"incorrect",invalid:"invalid"},M=f.ANSWER_BAR_STATES,I=function(e,t){switch(e){case M.HIDDEN:return t?M.ACTIVE:e;case M.ACTIVE:return t?e:M.INACTIVE;case M.INACTIVE:return t?M.ACTIVE:e;case M.INCORRECT:return t?M.ACTIVE:M.INACTIVE;default:return e}},_=i.createClass({displayName:"GradedGroup",propTypes:r({},p.propTypes,{apiOptions:a.propTypes,content:i.PropTypes.string,hasHint:i.PropTypes.bool,hint:i.PropTypes.object,images:i.PropTypes.object,inGradedGroupSet:i.PropTypes.bool,onBlur:i.PropTypes.func,onFocus:i.PropTypes.func,onNextQuestion:i.PropTypes.func,title:i.PropTypes.string,trackInteraction:i.PropTypes.func.isRequired,widgets:i.PropTypes.object,linterContext:E}),getDefaultProps:function(){return{title:"",content:"",widgets:{},images:{},hint:null,hasHint:!1,linterContext:k}},getInitialState:function(){return{status:S.ungraded,showHint:!1,message:"",answerBarState:M.HIDDEN}},shouldComponentUpdate:function(e,t){return e!==this.props||t!==this.state},change:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return p.change.apply(this,t)},_onInteractWithWidget:function(e){if(this.setState({status:S.ungraded,message:""}),this.refs.renderer){this.change("widgets",this.props.widgets);var t=this.refs.renderer.emptyWidgets(),n=0===t.length,r=this.state.answerBarState;this.setState({answerBarState:I(r,n)})}},_checkAnswer:function(){this.refs.renderer.showRationalesForCurrentlySelectedChoices();var e=this.refs.renderer.score(),t=void 0,n=void 0;"points"===e.type?(t=e.total===e.earned?S.correct:S.incorrect,n=e.message||""):(t=S.invalid,n=e.message?"We couldn't grade your answer. "+e.message:"We couldn't grade your answer. It looks like you left something blank or entered in an invalid answer."),this.setState({status:t,message:n,answerBarState:"correct"===t?M.CORRECT:M.INCORRECT}),this.props.trackInteraction({status:t})},getInputPaths:function(){return this.refs.renderer.getInputPaths()},setInputValue:function(e,t,n){return this.refs.renderer.setInputValue(e,t,n)},getAcceptableFormatsForInputPath:function(e){return this.refs.renderer.getAcceptableFormatsForInputPath(e)},focus:function(){return this.refs.renderer.focus()},focusInputPath:function(e){this.refs.renderer.focusPath(e)},blurInputPath:function(e){this.refs.renderer.blurPath(e)},render:function(){var e,n=this,p=s.extend({},a.defaults,this.props.apiOptions,{onFocusChange:function(e,t){t&&n.props.onBlur(t),e&&n.props.onFocus(e)}}),l=null;this.state.status===S.correct?l=i.createElement(h,r({},u,{style:{color:"#526f03"}})):this.state.status===S.incorrect&&(l=i.createElement(h,r({},c,{style:{color:"#ff5454"}})));var g=C(this.props.inGradedGroupSet?O.gradedGroupInSet:O.gradedGroup),m=o((e={},e[g]=p.isMobile,e["perseus-graded-group"]=!0,e["answer-correct"]=!p.isMobile&&this.state.status===S.correct,e["answer-incorrect"]=!p.isMobile&&this.state.status===S.incorrect,e)),y=this.state.answerBarState,v=y===M.CORRECT,b=p.readOnly||p.isMobile&&v;return i.createElement("div",{className:m},!!this.props.title&&i.createElement("div",{className:C(O.title)},this.props.title),i.createElement(d,r({},this.props,{ref:"renderer",apiOptions:r({},p,{readOnly:b}),onInteractWithWidget:this._onInteractWithWidget,linterContext:this.props.linterContext})),!p.isMobile&&l&&i.createElement("div",{className:"group-icon"},l),!p.isMobile&&i.createElement("p",null,this.state.message),!p.isMobile&&i.createElement("input",{type:"button",value:t._("Check"),className:"simple-button",disabled:this.props.apiOptions.readOnly,onClick:this._checkAnswer}),!p.isMobile&&v&&this.props.onNextQuestion&&i.createElement("input",{type:"button",value:t._("Next question"),className:"simple-button",disabled:this.props.apiOptions.readOnly,onClick:this.props.onNextQuestion,style:{marginLeft:5}}),this.props.hint&&this.props.hint.content&&(this.state.showHint?i.createElement("div",null,i.createElement("div",{className:C(O.explanationTitle),onClick:function(){return n.setState({showHint:!1})}},t._("Hide explanation")),i.createElement(d,r({},this.props.hint,{ref:"hints-renderer",apiOptions:p,linterContext:this.props.linterContext}))):i.createElement("div",{onClick:function(){return n.setState({showHint:!0})},className:C(O.showHintLink)},t._("Explain"))),p.isMobile&&y!==M.HIDDEN&&i.createElement(f,{apiOptions:p,answerBarState:y,onCheckAnswer:this._checkAnswer,onNextQuestion:this.props.onNextQuestion}))}}),R=function(e,t){return s.extend({},e,t(e))};e.exports={name:"graded-group",displayName:"Graded group (articles only)",widget:_,traverseChildWidgets:R,hidden:!1,tracking:"all",isLintable:!0};var O=x.create({gradedGroupInSet:{marginLeft:0,paddingLeft:0},gradedGroup:{borderTop:"1px solid "+m,borderBottom:"1px solid "+m,backgroundColor:b,marginLeft:v,marginRight:v,paddingBottom:y,paddingLeft:y,paddingRight:y,paddingTop:10,width:"auto"},showHintLink:{marginTop:20,color:T,cursor:"pointer"},explanationTitle:{marginTop:20,color:T,marginBottom:10,cursor:"pointer"},title:{fontSize:12,color:m,textTransform:"uppercase",marginBottom:11,letterSpacing:.8}})}).call(t,n(23))},674:function(e,t,n){(function(t){function r(e,t){return Math.floor((e[1]-e[0])/t)}var o=n(0),i=n(8),s=n(1),a=n(19),p=n(144),l=n(24),u=l.interactiveSizes,c=n(92),h={url:null},d={fontStyle:"italic",fontWeight:"bold",fontSize:"32px",width:"100%",height:"100%",textAlign:"center",backgroundColor:"white",position:"absolute",zIndex:1,transition:"opacity .25s ease-in-out","-moz-transition":"opacity .25s ease-in-out","-webkit-transition":"opacity .25s ease-in-out"},f={position:"relative",top:"25%"},g=o.createClass({displayName:"Graph",propTypes:{box:o.PropTypes.array.isRequired,labels:o.PropTypes.arrayOf(o.PropTypes.string),range:o.PropTypes.arrayOf(o.PropTypes.arrayOf(o.PropTypes.number)),step:o.PropTypes.arrayOf(o.PropTypes.number),gridStep:o.PropTypes.arrayOf(o.PropTypes.number),snapStep:o.PropTypes.arrayOf(o.PropTypes.number),markings:o.PropTypes.string,backgroundImage:o.PropTypes.shape({url:o.PropTypes.string}),showProtractor:o.PropTypes.bool,showRuler:o.PropTypes.bool,rulerLabel:o.PropTypes.string,rulerTicks:o.PropTypes.number,onGraphieUpdated:o.PropTypes.func,instructions:o.PropTypes.string,onClick:o.PropTypes.func,setDrawingAreaAvailable:o.PropTypes.func,isMobile:o.PropTypes.bool},getDefaultProps:function(){return{labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],snapStep:[.5,.5],markings:"graph",backgroundImage:h,showProtractor:!1,showRuler:!1,rulerLabel:"",rulerTicks:10,instructions:null,onGraphieUpdated:null,onClick:null,onMouseDown:null,isMobile:!1}},render:function(){var e=void 0,t=this.props.backgroundImage;if(t.url){var n=this.props.box[0]/u.defaultBoxSize;e=o.createElement(c,{src:t.url,width:t.width,height:t.height,scale:n,responsive:!1})}else e=null;return o.createElement("div",{className:"graphie-container above-scratchpad",style:{width:this.props.box[0],height:this.props.box[1]},onMouseOut:this.onMouseOut,onMouseOver:this.onMouseOver,onClick:this.onClick},e,o.createElement("div",{className:"graphie",ref:"graphieDiv"}))},componentDidMount:function(){this._setupGraphie(!0)},componentDidUpdate:function(){this._hasSetupGraphieThisUpdate=!1,this._shouldSetupGraphie&&(this._setupGraphie(!1),this._shouldSetupGraphie=!1)},componentWillReceiveProps:function(e){var t=["labels","range","step","markings","showProtractor","showRuler","rulerLabel","rulerTicks","gridStep","snapStep"],n=this;s.each(t,function(t){s.isEqual(n.props[t],e[t])||(n._shouldSetupGraphie=!0)})},reset:function(){this._setupGraphie(!1)},graphie:function(){return this._graphie},pointsFromNormalized:function(e,t){var n=this;return s.map(e,function(e){return s.map(e,function(e,o){var i=n.props.range[o];if(t)return i[0]+(i[1]-i[0])*e;var s=n.props.step[o],a=r(i,s),p=Math.round(e*a);return i[0]+s*p})})},_setupGraphie:function(e){if(!this._hasSetupGraphieThisUpdate){var n=i.findDOMNode(this.refs.graphieDiv);t(n).empty();var r=this.props.labels,o=this.props.range,a=this._graphie=p.createGraphie(n),l=this._getGridConfig();a.snap=this.props.snapStep,"graph"===this.props.markings?(a.graphInit({range:o,scale:s.pluck(l,"scale"),axisArrows:"<->",labelFormat:function(e){return"\\small{"+e+"}"},gridStep:this.props.gridStep,tickStep:s.pluck(l,"tickStep"),labelStep:1,unityLabels:s.pluck(l,"unityLabel"),isMobile:this.props.isMobile}),a.label([0,o[1][1]],r[1],this.props.isMobile?"below right":"above"),a.label([o[0][1],0],r[0],this.props.isMobile?"above left":"right")):"grid"===this.props.markings?a.graphInit({range:o,scale:s.pluck(l,"scale"),gridStep:this.props.gridStep,axes:!1,ticks:!1,labels:!1,isMobile:this.props.isMobile}):"none"===this.props.markings&&a.init({range:o,scale:s.pluck(l,"scale"),isMobile:this.props.isMobile});var u=void 0;if(this.props.instructions){u=t("<div/>"),s.each(d,function(e,t){u.css(t,e)}),u.css("opacity",.5);var c=t("<span/>",{text:this.props.instructions});s.each(f,function(e,t){c.css(t,e)}),u.append(c),t(n).append(u)}else u=void 0;var h=u||this.props.onMouseDown?s.bind(function(e){u&&(u.remove(),u=null),this.props.onMouseDown(e)},this):null,g=u?function(){u&&u.css("opacity",0)}:null,m=u?function(){u&&u.css("opacity",.5)}:null;a.addMouseLayer({onClick:this.props.onClick,onMouseDown:h,onMouseOver:g,onMouseOut:m,onMouseUp:this.props.onMouseUp,onMouseMove:this.props.onMouseMove,allowScratchpad:!0,setDrawingAreaAvailable:this.props.setDrawingAreaAvailable}),this._updateProtractor(),this._updateRuler(),this._hasSetupGraphieThisUpdate=!0,!e&&this.props.onGraphieUpdated&&this.props.onGraphieUpdated(a)}},_getGridConfig:function(){var e=this;return s.map(e.props.step,function(t,n){return a.gridDimensionConfig(t,e.props.range[n],e.props.box[n],e.props.gridStep[n])})},_updateProtractor:function(){if(this.protractor&&this.protractor.remove(),this.props.showProtractor){var e=this.pointsFromNormalized([[.5,.05]])[0];this.protractor=this._graphie.protractor(e)}},_updateRuler:function(){if(this.ruler&&this.ruler.remove(),this.props.showRuler){var e=this.pointsFromNormalized([[.5,.25]])[0],t=this._graphie.range[0][1]-this._graphie.range[0][0];this.ruler=this._graphie.ruler({center:e,label:this.props.rulerLabel,pixelsPerUnit:this._graphie.scale[0],ticksPerUnit:this.props.rulerTicks,units:Math.round(.8*t)})}},toJSON:function(){return s.pick(this.props,"range","step","markings","labels","backgroundImage","showProtractor","showRuler","rulerLabel","rulerTicks","gridStep","snapStep")}});e.exports=g}).call(t,n(10))},675:function(e,t,n){var r=n(0),o=n(697),i=r.createClass({displayName:"InfoTip",getInitialState:function(){return{didMount:!1}},componentDidMount:function(){this.setState({didMount:!0})},render:function(){return this.state.didMount?r.createElement(o,this.props):r.createElement("div",null)}});e.exports=i},676:function(e,t,n){(function(t){var r=n(0),o=n(8),i=n(6),s=i.StyleSheet,a=i.css,p=n(1),l=n(19),u=n(32),c=n(13).ClassNames,h=n(47),d=n(22),f=d.linterContextProps,g=d.linterContextDefault,m=r.createClass({displayName:"Placeholder",propTypes:{layout:r.PropTypes.oneOf(["horizontal","vertical"]),width:r.PropTypes.number.isRequired,height:r.PropTypes.number.isRequired},render:function(){var e=this.props.layout,t=a(b.card,b.placeholder,"horizontal"===e&&b.horizontalCard),n={width:this.props.width,height:this.props.height};return null!=this.props.margin&&(n.margin=this.props.margin),r.createElement("li",{className:t,style:n})}}),y=r.createClass({displayName:"Draggable",propTypes:{content:r.PropTypes.string.isRequired,endPosition:r.PropTypes.object.isRequired,includePadding:r.PropTypes.bool,layout:r.PropTypes.oneOf(["horizontal","vertical"]),onAnimationEnd:r.PropTypes.func.isRequired,onMouseDown:r.PropTypes.func.isRequired,onMouseMove:r.PropTypes.func.isRequired,onMouseUp:r.PropTypes.func.isRequired,onRender:r.PropTypes.func.isRequired,type:r.PropTypes.oneOf(["static","dragging","animating","disabled"]),linterContext:f},getDefaultProps:function(){return{includePadding:!0,type:"static",linterContext:g}},getInitialState:function(){return{startPosition:{left:0,top:0},startMouse:{left:0,top:0},mouse:{left:0,top:0}}},componentDidMount:function(){this.isMouseMoveUpBound=!1},componentWillUnmount:function(){this.isMouseMoveUpBound&&this.unbindMouseMoveUp()},getCurrentPosition:function(){return{left:this.state.startPosition.left+this.state.mouse.left-this.state.startMouse.left,top:this.state.startPosition.top+this.state.mouse.top-this.state.startMouse.top}},render:function(){var e=this.props,t=e.includePadding,n=e.layout,o=e.type,i=a(b.card,b.draggable,"horizontal"===n&&b.horizontalCard,"vertical"===n&&b.verticalCard,"dragging"===o&&b.dragging,"animating"===o&&b.animating,"disabled"===o&&b.disabled,!t&&b.unpaddedCard)+" "+c.INTERACTIVE+" perseus-sortable-draggable";t||(i+=" perseus-sortable-draggable-unpadded");var s={position:"static"};return"dragging"!==this.props.type&&"animating"!==this.props.type||p.extend(s,{position:"absolute"},this.getCurrentPosition()),this.props.width&&(s.width=this.props.width+1),this.props.height&&(s.height=this.props.height),null!=this.props.margin&&(s.margin=this.props.margin),r.createElement("li",{className:i,style:s,onMouseDown:this.onMouseDown,onTouchStart:this.onMouseDown,onTouchMove:this.onMouseMove,onTouchEnd:this.onMouseUp,onTouchCancel:this.onMouseUp},r.createElement(u,{content:this.props.content,linterContext:h.pushContextStack(this.props.linterContext,"draggable"),onRender:this.props.onRender}))},componentDidUpdate:function(e){if(this.props.type!==e.type)if("animating"===this.props.type){var n=this.getCurrentPosition(),r=15*Math.sqrt(Math.sqrt(Math.pow(this.props.endPosition.left-n.left,2)+Math.pow(this.props.endPosition.top-n.top,2)));t(o.findDOMNode(this)).animate(this.props.endPosition,{duration:Math.max(r,1),complete:this.props.onAnimationEnd})}else"static"===this.props.type&&t(o.findDOMNode(this)).finish()},bindMouseMoveUp:function(){this.isMouseMoveUpBound=!0,t(document).on("mousemove",this.onMouseMove),t(document).on("mouseup",this.onMouseUp)},unbindMouseMoveUp:function(){this.isMouseMoveUpBound=!1,t(document).off("mousemove",this.onMouseMove),t(document).off("mouseup",this.onMouseUp)},onMouseDown:function(e){if("static"===this.props.type&&(0===e.button||null!=e.touches&&1===e.touches.length)){e.preventDefault();var n=l.extractPointerLocation(e);n&&this.setState({startPosition:t(o.findDOMNode(this)).position(),startMouse:n,mouse:n},function(){this.bindMouseMoveUp(),this.props.onMouseDown()})}},onMouseMove:function(e){if("dragging"===this.props.type){e.preventDefault();var t=l.extractPointerLocation(e);t&&this.setState({mouse:t},this.props.onMouseMove)}},onMouseUp:function(e){"dragging"===this.props.type&&(e.preventDefault(),l.extractPointerLocation(e)&&(this.unbindMouseMoveUp(),this.props.onMouseUp()))}}),v=r.createClass({displayName:"Sortable",propTypes:{constraints:r.PropTypes.object,disabled:r.PropTypes.bool,layout:r.PropTypes.oneOf(["horizontal","vertical"]),margin:r.PropTypes.number,onChange:r.PropTypes.func,onMeasure:r.PropTypes.func,options:r.PropTypes.array.isRequired,padding:r.PropTypes.bool,linterContext:f},getDefaultProps:function(){return{layout:"horizontal",padding:!0,disabled:!1,constraints:{},onMeasure:function(){},margin:5,onChange:function(){},linterContext:g}},getInitialState:function(){return{items:this.itemsFromProps(this.props)}},componentWillReceiveProps:function(e){var t=this.props;p.isEqual(e.options,t.options)?e.layout===t.layout&&e.padding===t.padding&&e.disabled===t.disabled&&p.isEqual(e.constraints,t.constraints)||this.setState({items:this.clearItemMeasurements(this.state.items)}):this.setState({items:this.itemsFromProps(e)})},componentDidUpdate:function(e){this.state.items.length&&!this.state.items[0].width&&this.measureItems()},itemsFromProps:function(e){var t=e.disabled?"disabled":"static";return p.map(e.options,function(e,n){return{option:e,key:n,type:t,endPosition:{},width:0,height:0}})},clearItemMeasurements:function(e){return p.map(e,function(e){return p.extend(e,{width:0,height:0})})},measureItems:function(){var e=this,n=p.clone(this.state.items),r=p.map(n,function(e){return t(o.findDOMNode(this.refs[e.key]))},this),i=p.invoke(r,"outerWidth"),s=p.invoke(r,"outerHeight"),a=this.props.constraints,l=this.props.layout,u=void 0;a.width?u=p.max(i.concat(a.width)):"vertical"===l&&(u=p.max(i));var c=void 0;a.height?c=p.max(s.concat(a.height)):"horizontal"===l&&(c=p.max(s)),n=p.map(n,function(e,t){return e.width=u||i[t],e.height=c||s[t],e}),this.setState({items:n},function(){e.props.onMeasure({widths:i,heights:s})})},remeasureItems:p.debounce(function(){this.setState({items:this.clearItemMeasurements(this.state.items)})},20),render:function(){var e=[],t=this.props.layout,n=a(b.sortable)+" perseus-sortable";return p.each(this.state.items,function(n,o,i){var s=o===i.length-1,a="static"===n.type||"disabled"===n.type,p=void 0;"horizontal"===this.props.layout?p="0 "+this.props.margin+"px 0 0":"vertical"===this.props.layout&&(p="0 0 "+this.props.margin+"px 0"),e.push(r.createElement(y,{content:n.option,key:n.key,type:n.type,ref:n.key,width:n.width,height:n.height,layout:t,includePadding:this.props.padding,margin:s&&a?0:p,endPosition:n.endPosition,linterContext:h.pushContextStack(this.props.linterContext,"sortable"),onRender:this.remeasureItems,onMouseDown:this.onMouseDown.bind(this,n.key),onMouseMove:this.onMouseMove.bind(this,n.key),onMouseUp:this.onMouseUp.bind(this,n.key),onTouchMove:this.onMouseMove.bind(this,n.key),onTouchEnd:this.onMouseUp.bind(this,n.key),onTouchCancel:this.onMouseUp.bind(this,n.key),onAnimationEnd:this.onAnimationEnd.bind(this,n.key)})),"dragging"!==n.type&&"animating"!==n.type||e.push(r.createElement(m,{key:"placeholder_"+n.key,ref:"placeholder_"+n.key,width:n.width,height:n.height,layout:t,margin:s?0:p}))},this),r.createElement("ul",{className:n},e)},onMouseDown:function(e){var t=p.map(this.state.items,function(t){return t.key===e&&(t.type="dragging"),t});this.setState({items:t})},onMouseMove:function(e){var n=t(o.findDOMNode(this.refs[e])),r=t(o.findDOMNode(this)),i=p.clone(this.state.items),s=p.findWhere(this.state.items,{key:e}),a=this.props.margin,l=p.indexOf(i,s),u=0;if(i.splice(l,1),"horizontal"===this.props.layout){var c=n.offset().left-r.offset().left,h=0,d=void 0;p.each(i,function(e){d=e.width,c>h+d/2&&(u+=1),h+=d+a})}else{var f=n.offset().top-r.offset().top,g=0,m=void 0;p.each(i,function(e){m=e.height,f>g+m/2&&(u+=1),g+=m+a})}u!==l&&(i.splice(u,0,s),this.setState({items:i}))},onMouseUp:function(e){var n=p.map(this.state.items,function(n){return n.key===e&&(n.type="animating",n.endPosition=t(o.findDOMNode(this.refs["placeholder_"+e])).position()),n},this);this.setState({items:n}),this.props.onChange({})},onAnimationEnd:function(e){var t=p.map(this.state.items,function(t){return t.key===e&&(t.type="static"),t});this.setState({items:t})},getOptions:function(){return p.pluck(this.state.items,"option")}}),b=s.create({sortable:{boxSizing:"border-box",float:"left",padding:0,margin:0},card:{boxSizing:"border-box",background:"#fff",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",minWidth:25,minHeight:44,padding:10,listStyleType:"none",userSelect:"none",touchAction:"none"},placeholder:{background:"#ddd",border:"1px solid #ccc"},draggable:{textAlign:"center"},horizontalCard:{float:"left",cursor:"ew-resize"},verticalCard:{maxWidth:"100%",cursor:"ns-resize"},unpaddedCard:{padding:0},dragging:{background:"#ffedcd",opacity:"0.8"},disabled:{backgroundColor:"inherit",border:"1px solid transparent",cursor:"default"}});e.exports=v}).call(t,n(10))},677:function(e,t,n){var r=n(0),o=n(702),i=n(703),s=i.layout,a=n(704),p=a.parse,l=a.ParseError,u=r.createClass({displayName:"Molecule",propTypes:{id:r.PropTypes.string.isRequired,rotationAngle:r.PropTypes.number,smiles:r.PropTypes.string},getInitialState:function(){return{parsedSmiles:null,error:null}},componentWillMount:function(){this.stateFromSmiles(this.props.smiles)},componentDidMount:function(){this.canvasRender()},componentWillReceiveProps:function(e){this.stateFromSmiles(e.smiles)},componentDidUpdate:function(){this.canvasRender()},stateFromSmiles:function(e){try{this.setState({parsedSmiles:p(e),error:null})}catch(e){if(!(e instanceof l))throw e;this.setState({error:e.message})}},setCanvasBounds:function(e,t){var n=Math.max.apply(Math,t.map(function(e){return e.pos?e.pos[0]:-1/0})),r=Math.max.apply(Math,t.map(function(e){return e.pos?e.pos[1]:-1/0})),o=Math.min.apply(Math,t.map(function(e){return e.pos?e.pos[0]:1/0})),i=Math.min.apply(Math,t.map(function(e){return e.pos?e.pos[1]:1/0})),s=n-o+60,a=r-i+60;return e.width=s,e.height=a,[30-o,30-i]},canvasRender:function(){if(!this.state.error&&this.state.parsedSmiles){var e=s(this.state.parsedSmiles,this.props.rotationAngle),t=this.refs.canvas,n=this.setCanvasBounds(t,e),r=t.getContext("2d");r.clearRect(0,0,t.width,t.height),r.save(),r.translate(n[0],n[1]),o(r,e),r.restore()}},render:function(){var e=r.createElement("canvas",{className:"molecule-canvas",id:this.props.id+"-molecule",ref:"canvas"},"A molecular structure drawing.  SMILES notation:",this.props.smiles,".");return this.state.error&&(e=r.createElement("div",{className:"error"},this.state.error)),r.createElement("div",{className:"molecule-canvas"},e)}}),c=r.createClass({displayName:"MoleculeWidget",propTypes:{rotationAngle:r.PropTypes.number,smiles:r.PropTypes.string,widgetId:r.PropTypes.string},getDefaultProps:function(){return{rotationAngle:0}},simpleValidate:function(){return{type:"points",earned:0,total:0,message:null}},getUserInput:function(){return[]},validate:function(e,t){return{type:"points",earned:0,total:0,message:null}},render:function(){return r.createElement(u,{id:this.props.widgetId,smiles:this.props.smiles,rotationAngle:this.props.rotationAngle})}});e.exports={name:"molecule-renderer",displayName:"Molecule renderer",hidden:!0,widget:c,molecule:u}},678:function(e,t,n){function r(e,t){return{left:e.left-t.left,top:e.top-t.top}}function o(e,t){return p({},r(e,t),{width:e.width,height:e.height})}function i(e){var t=[];return s(e.commonAncestorContainer,e,t),t}function s(e,t,n){var r=new Range;if(r.selectNodeContents(e),e.nodeType===Node.TEXT_NODE){var o=c(t,r);o&&a(e,o,n)}else if(e.nodeType===Node.ELEMENT_NODE){if(!u(t,r))return;for(var i=Array.from(e.childNodes),p=Array.isArray(i),l=0,i=p?i:i[Symbol.iterator]();;){var h;if(p){if(l>=i.length)break;h=i[l++]}else{if(l=i.next(),l.done)break;h=l.value}var d=h;s(d,t,n)}}}function a(e,t,n){var r=e.parentElement,o=window.getComputedStyle(r),i=null;if("string"==typeof o.lineHeight&&o.lineHeight.endsWith("px")){var s=parseFloat(o.lineHeight);isNaN(s)||(i=s)}for(var a=Array.from(t.getClientRects()),p=a,l=Array.isArray(p),u=0,p=l?p:p[Symbol.iterator]();;){var c;if(l){if(u>=p.length)break;c=p[u++]}else{if(u=p.next(),u.done)break;c=u.value}var h=c,d={left:h.left,top:h.top,height:h.height,width:h.width};if(null!==i){var f=i-d.height;d.top-=f,d.height=i}n.push(d)}}var p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=(n(669).babelPluginFlowReactPropTypes_proptype_Rect||n(0).PropTypes.any,n(669).babelPluginFlowReactPropTypes_proptype_Position||n(0).PropTypes.any,n(669).babelPluginFlowReactPropTypes_proptype_DOMRange||n(0).PropTypes.any,n(672)),u=l.rangesOverlap,c=l.intersectRanges;e.exports={getClientRectsForTextInRange:i,getRelativePosition:r,getRelativeRect:o}},679:function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n(0),a=n(6),p=a.StyleSheet,l=a.css,u=n(678),c=u.getRelativePosition,h=(n(669).babelPluginFlowReactPropTypes_proptype_Position||n(0).PropTypes.any,function(e){function t(){return r(this,t),o(this,e.apply(this,arguments))}return i(t,e),t.prototype._getPosition=function(){var e=this.props,t=e.focusNode,n=e.focusOffset,r=e.offsetParent,o=document.createRange();o.setStart(t,n),o.setEnd(t,n);var i=o.getClientRects()[0],s=r.getBoundingClientRect();return c(i,s)},t.prototype.render=function(){var e=this._getPosition();return s.createElement("div",{className:l(d.tooltip),onClick:this.props.onClick,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,style:{left:e.left,top:e.top,zIndex:this.props.zIndex}},s.createElement("div",{className:l(d.label)},this.props.label),s.createElement("div",{className:l(d.arrow)}))},t}(s.PureComponent));h.propTypes={label:n(0).PropTypes.string.isRequired,onClick:n(0).PropTypes.func.isRequired,onMouseEnter:n(0).PropTypes.func,onMouseLeave:n(0).PropTypes.func,focusNode:n(0).PropTypes.any.isRequired,focusOffset:n(0).PropTypes.number.isRequired,offsetParent:n(0).PropTypes.any.isRequired,zIndex:n(0).PropTypes.number.isRequired};var d=p.create({tooltip:{position:"absolute",transform:"translate(-50%, -100%)",cursor:"pointer",userSelect:"none"},label:{background:"#314453",borderRadius:2,boxShadow:"0 1px 4px 0 rgba(97, 101, 105, 0.42)",padding:"8px 11px",color:"white",fontSize:12,lineHeight:1.5,textAlign:"center"},arrow:{height:0,width:0,borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderTop:"6px solid #314453",margin:"0 auto"}});e.exports=h},680:function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n(0),a=(n(669).babelPluginFlowReactPropTypes_proptype_DOMRange||n(0).PropTypes.any,n(669).babelPluginFlowReactPropTypes_proptype_DOMHighlight||n(0).PropTypes.any);Object.defineProperty(e.exports,"babelPluginFlowReactPropTypes_proptype_TrackedSelection",n(0).PropTypes.shape({focusNode:n(0).PropTypes.any.isRequired,focusOffset:n(0).PropTypes.number.isRequired,proposedHighlight:a}));var p=function(e){function t(){var n,i,s;r(this,t);for(var a=arguments.length,p=Array(a),l=0;l<a;l++)p[l]=arguments[l];return n=i=o(this,e.call.apply(e,[this].concat(p))),i.state={mouseState:"up",trackedSelection:null},i._handleSelectionChange=function(){i._updateTrackedSelection(i.props.buildHighlight),"down"===i.state.mouseState&&i.setState({mouseState:"down-and-selecting"})},i._handleMouseDown=function(){i.setState({mouseState:"down"})},i._handleMouseUp=function(){i.setState({mouseState:"up"})},s=n,o(i,s)}return i(t,e),t.prototype.componentDidMount=function(){this._updateListeners(!1,this.props.enabled)},t.prototype.componentWillReceiveProps=function(e){this.props.buildHighlight!==e.buildHighlight&&this._updateTrackedSelection(e.buildHighlight),this._updateListeners(this.props.enabled,e.enabled)},t.prototype.componentWillUnmount=function(){this._updateListeners(this.props.enabled,!1)},t.prototype._updateListeners=function(e,t){!e&&t?(window.addEventListener("mousedown",this._handleMouseDown),window.addEventListener("mouseup",this._handleMouseUp),document.addEventListener("selectionchange",this._handleSelectionChange)):e&&!t&&(window.removeEventListener("mousedown",this._handleMouseDown),window.removeEventListener("mouseup",this._handleMouseUp),document.removeEventListener("selectionchange",this._handleSelectionChange),this.setState({mouseState:"up",trackedSelection:null}))},t.prototype._computeFocusAndRange=function(){var e=document.getSelection();if(!e||0===e.rangeCount)return null;var t=e.getRangeAt(0);return t.collapsed?null:{focusNode:e.focusNode,focusOffset:e.focusOffset,range:t}},t.prototype._computeTrackedSelection=function(e){var t=this._computeFocusAndRange();if(!t)return null;var n=t.focusNode,r=t.focusOffset,o=t.range,i=e(o);return i?{focusNode:n,focusOffset:r,proposedHighlight:i}:null},t.prototype._updateTrackedSelection=function(e){var t=this._computeTrackedSelection(e);this.setState({trackedSelection:t})},t.prototype.render=function(){var e=this.state,t=e.mouseState,n=e.trackedSelection,r="down-and-selecting"===t;return this.props.children&&s.createElement("div",null,this.props.children(n,r))},t}(s.PureComponent);p.propTypes={buildHighlight:n(0).PropTypes.func.isRequired,children:n(0).PropTypes.func,enabled:n(0).PropTypes.bool.isRequired},e.exports=p},681:function(e,t,n){(function(t){var r,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(6),s=i.StyleSheet,a=i.css,p=n(0),l=n(21),u=n(143),c=n(242),h=n(1),d=n(13).ClassNames,f=n(13).Options,g=n(90),m=g.iconCircle,y=g.iconCircleThin,v=n(91),b=n(32),T=n(19),P=n(55),x=n(94),C=n(22),w=C.linterContextProps,E=C.linterContextDefault,k=p.createClass({displayName:"Categorizer",propTypes:o({},u.propTypes,{apiOptions:f.propTypes,categories:p.PropTypes.arrayOf(p.PropTypes.string),items:p.PropTypes.arrayOf(p.PropTypes.string),trackInteraction:p.PropTypes.func.isRequired,values:p.PropTypes.arrayOf(p.PropTypes.number),linterContext:w}),getDefaultProps:function(){return{items:[],categories:[],values:[],linterContext:E}},getInitialState:function(){return{uniqueId:h.uniqueId("perseus_radio_")}},change:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return u.change.apply(this,t)},getUserInput:function(){return c.getUserInput.call(this)},render:function(){var e=this,t=this,n=this.props.apiOptions.isMobile,r=this.props.items.map(function(e,t){return[e,t]});this.props.randomizeItems&&(r=T.shuffle(r,this.props.problemNum));var o=p.createElement("table",{className:"categorizer-table"},p.createElement("thead",null,p.createElement("tr",null,p.createElement("th",null," "),this.props.categories.map(function(t,n){return p.createElement("th",{className:a(S.header),key:n},p.createElement(b,{content:t,linterContext:e.props.linterContext}))}))),p.createElement("tbody",null,r.map(function(r){var o=r[0],i=r[1],s=t.state.uniqueId+"_"+i;return p.createElement("tr",{key:i},p.createElement("td",null,p.createElement(b,{content:o,linterContext:e.props.linterContext})),h.range(t.props.categories.length).map(function(r){var o=t.props.values[i]===r;return p.createElement("td",{className:"category "+a(S.cell,S.responsiveCell),key:r},p.createElement("div",{className:d.INTERACTIVE,onClick:e.onChange.bind(e,i,r)},n&&p.createElement("input",{type:"radio",name:s,className:a(x.responsiveInput,x.responsiveRadioInput),checked:o,onChange:e.onChange.bind(e,i,r),onClick:function(e){return e.stopPropagation()}}),!n&&p.createElement("span",{className:a(S.responsiveSpan,S.radioSpan,o&&S.checkedRadioSpan,e.props.static&&o&&S.staticCheckedRadioSpan)},o?p.createElement(v,m):p.createElement(v,y))))}))}))),i=l({"categorizer-container":!0,"static-mode":this.props.static}),s=this.props.apiOptions.isMobile?[S.fullBleedContainer]:[];return p.createElement("div",{className:i+" "+a.apply(void 0,s)},o)},onChange:function(e,t){var n=h.clone(this.props.values);n[e]=t,this.change("values",n),this.props.trackInteraction()},simpleValidate:function(e){return k.validate(this.getUserInput(),e)}});h.extend(k,{validate:function(e,n){var r=!0,o=!0;return h.each(n.values,function(t,n){null==e.values[n]&&(r=!1),e.values[n]!==t&&(o=!1)}),r?{type:"points",earned:o?1:0,total:1,message:null}:{type:"invalid",message:t._("Make sure you select something for every row.")}}});var S=s.create({fullBleedContainer:(r={},r[P.mdOrSmaller]={marginLeft:-16,marginRight:-16,overflowX:"auto"},r),header:{textAlign:"center",verticalAlign:"bottom"},cell:{textAlign:"center",padding:0,color:"#ccc",verticalAlign:"middle"},radioSpan:{fontSize:30,paddingRight:3,":hover":{color:"#999"}},checkedRadioSpan:{color:"#333"},staticCheckedRadioSpan:{color:"#888"}});e.exports={name:"categorizer",displayName:"Categorizer",widget:k,transform:function(e){return h.pick(e,"items","categories","randomizeItems")},staticTransform:function(e){return h.pick(e,"items","categories","values","randomizeItems")},isLintable:!0}}).call(t,n(23))},682:function(e,t,n){(function(t){function r(e){var t=u.replace("{programID}",e),n=document.location.hostname,r="www.khanacademy.org";return l.test(n)&&(r=n),t.replace("{hostname}",r)}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(0),s=n(1),a=n(143),p=n(19).updateQueryString,l=/khanacademy\.org/,u="https://{hostname}/computer-programming/program/{programID}/embedded?embed=yes&author=no",c=i.createClass({displayName:"CSProgram",propTypes:o({},a.propTypes,{programID:i.PropTypes.string,width:i.PropTypes.number,height:i.PropTypes.number,settings:i.PropTypes.array,showEditor:i.PropTypes.bool,showButtons:i.PropTypes.bool,status:i.PropTypes.oneOf(["incomplete","incorrect","correct"]),message:i.PropTypes.string}),getDefaultProps:function(){return{showEditor:!1,showButtons:!1,status:"incomplete",message:null}},handleMessageEvent:function(e){var t={};try{t=JSON.parse(e.originalEvent.data)}catch(e){return}if(!s.isUndefined(t.testsPassed)){var n=t.testsPassed?"correct":"incorrect";this.change({status:n,message:t.message})}},componentDidMount:function(){t(window).on("message",this.handleMessageEvent)},componentWillUnmount:function(){t(window).off("message",this.handleMessageEvent)},change:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.change.apply(this,t)},render:function(){if(!this.props.programID)return i.createElement("div",null);var e,t=r(this.props.programID),n={height:this.props.height};if(this.props.showEditor?(t+="&editor=yes",n.width="100%",e="perseus-scratchpad-editor"):(t+="&editor=no",n.width=this.props.width+2,e="perseus-scratchpad"),this.props.showButtons?(t+="&buttons=yes",n.height+=50):t+="&buttons=no",this.props.settings){var o={};s.each(this.props.settings,function(e){e.name&&e.value&&(o[e.name]=e.value)}),t=p(t,"settings",JSON.stringify(o))}return i.createElement("iframe",{sandbox:"allow-popups allow-same-origin allow-scripts",src:t,style:n,className:e,allowFullScreen:!0})},simpleValidate:function(e){return c.validate({status:this.props.status,message:this.props.message},e)},statics:{validate:function(e,t){return"correct"===e.status?{type:"points",earned:1,total:1,message:e.message||null}:"incorrect"===e.status?{type:"points",earned:0,total:1,message:e.message||null}:{type:"invalid",message:"Keep going, you're not there yet!"}}}});e.exports={name:"cs-program",displayName:"CS Program",supportedAlignments:["block","full-width"],widget:c,hidden:!0}}).call(t,n(10))},683:function(e,t,n){var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(6),i=o.StyleSheet,s=o.css,a=n(21),p=n(0),l=n(8),u=n(1),c=n(13).ClassNames,h=n(13).Options,d=n(91),f=n(24),g=n(90),m=g.iconDropdownArrow,y=n(19).captureScratchpadTouchStart,v=p.createClass({displayName:"Dropdown",propTypes:{apiOptions:h.propTypes,choices:p.PropTypes.arrayOf(p.PropTypes.string),onChange:p.PropTypes.func.isRequired,placeholder:p.PropTypes.string,selected:p.PropTypes.number,trackInteraction:p.PropTypes.func.isRequired},getDefaultProps:function(){return{choices:[],selected:0,placeholder:"",apiOptions:h.defaults}},render:function(){var e=this.props.choices.slice(),t=a({"perseus-widget-dropdown":!0});return p.createElement("div",null,p.createElement("select",{onChange:this._handleChangeEvent,onTouchStart:y,className:t+" "+s(T.dropdown)+" "+c.INTERACTIVE,disabled:this.props.apiOptions.readOnly,value:this.props.selected},p.createElement("option",{value:0,disabled:!0},this.props.placeholder),e.map(function(e,t){return p.createElement("option",{key:""+(t+1),value:t+1},e)})),p.createElement(d,r({},m,{style:{marginLeft:"-24px",height:24,width:24}})))},focus:function(){return l.findDOMNode(this).focus(),!0},_handleChangeEvent:function(e){this._handleChange(parseInt(e.target.value))},_handleChange:function(e){this.props.trackInteraction(),this.props.onChange({selected:e})},getUserInput:function(){return{value:this.props.selected}},simpleValidate:function(e){return v.validate(this.getUserInput(),e)}});u.extend(v,{validate:function(e,t){var n=e.value;return 0===n?{type:"invalid",message:null}:{type:"points",earned:t.choices[n-1].correct?1:0,total:1,message:null}}});var b=function(e){return{placeholder:e.placeholder,choices:u.map(e.choices,function(e){return e.content})}},T=i.create({dropdown:{appearance:"none",backgroundColor:"transparent",border:"1px solid "+f.gray76,borderRadius:4,boxShadow:"none",fontFamily:f.baseFontFamily,padding:"9px 25px 9px 9px",":focus":{outline:"none",border:"2px solid "+f.kaGreen,padding:"8px 24px 8px 8px"},":focus + svg":{color:""+f.kaGreen},":disabled":{color:f.gray68},":disabled + svg":{color:f.gray68}}});e.exports={name:"dropdown",displayName:"Drop down",defaultAlignment:"inline-block",accessible:!0,widget:v,transform:b}},684:function(e,t,n){var r,o,i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=n(6),a=s.StyleSheet,p=s.css,l=n(0),u=n(1),c=n(143),h=n(13),d=n(32),f=n(55),g=n(24),m=n(22),y=m.linterContextProps,v=m.linterContextDefault,b={showPrompt:"Explain",hidePrompt:"Hide explanation",explanation:"explanation goes here\n\nmore explanation",widgets:{},linterContext:v},T=l.createClass({displayName:"Explanation",propTypes:i({},c.propTypes,{apiOptions:h.Options.propTypes,explanation:l.PropTypes.string,hidePrompt:l.PropTypes.string,showPrompt:l.PropTypes.string,trackInteraction:l.PropTypes.func.isRequired,widgets:l.PropTypes.object,linterContext:y}),getDefaultProps:function(){return b},getInitialState:function(){return{expanded:!1}},change:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return c.change.apply(this,t)},_onClick:function(){this.setState({expanded:!this.state.expanded}),this.props.trackInteraction()},render:function(){var e=this.props.apiOptions.baseElements.Link,t=this.props.apiOptions,n=t.readOnly,r=t.isMobile,o=this.state.expanded?this.props.hidePrompt:this.props.showPrompt,i=void 0,s=n?null:"javascript:void(0)",a=n?null:this._onClick;i=r?l.createElement("div",{className:p(w.linkContainer)},l.createElement("a",{className:p(w.mobileExplanationLink),href:s,onClick:a},o),this.state.expanded&&l.createElement("svg",{className:p(w.disclosureArrow)},l.createElement("polygon",{style:{fill:C},points:"0,"+x+" "+P+","+x+" "+P/2+",0"}))):l.createElement("div",{className:p(w.linkContainer)},l.createElement(e,{className:p(w.explanationLink),href:s,onClick:a},"["+o+"]"));var u=r?w.contentExpandedMobile:w.contentExpanded;return l.createElement("div",{className:p(w.container)},i,l.createElement("div",{className:p(w.content,r&&w.contentMobile,this.state.expanded&&u),style:{height:this.state.expanded?"auto":0,overflow:this.state.expanded?"visible":"hidden"},ref:"content"},l.createElement(d,{apiOptions:this.props.apiOptions,content:this.props.explanation,widgets:this.props.widgets,linterContext:this.props.linterContext})))},getUserInput:function(){return{}},simpleValidate:function(e){return T.validate(this.getUserInput(),e)}}),P=30,x=14,C=g.gray95,w=a.create({container:{display:"inline",position:"relative"},linkContainer:{display:"inline-block"},explanationLink:(r={fontStyle:"italic",color:"#007d96"},r[f.xl]={fontSize:20,lineHeight:1.1},r[f.lgOrSmaller]={fontSize:17,lineHeight:1.4},r[f.smOrSmaller]={fontSize:14,lineHeight:1.3},r),mobileExplanationLink:(o={color:g.kaGreen,borderBottom:"dashed 1px "+g.kaGreen,textDecoration:"none"},o[f.xl]={fontSize:22,lineHeight:1.4},o[f.lgOrSmaller]={fontSize:20,lineHeight:1.5},o[f.smOrSmaller]={fontSize:18,lineHeight:1.2},o),content:{position:"relative",transition:"margin-top 0.1s"},contentExpanded:{borderLeft:"5px solid #ccc",marginLeft:-23,paddingLeft:23,paddingBottom:10,marginBottom:x,marginTop:x},contentExpandedMobile:{boxSizing:"content-box",paddingTop:32,paddingBottom:32,marginTop:x},contentMobile:{background:C,marginLeft:g.negativePhoneMargin,marginRight:g.negativePhoneMargin,paddingLeft:g.phoneMargin,paddingRight:g.phoneMargin},disclosureArrow:{bottom:-(x+5),height:x,left:"50%",marginLeft:-P/2,position:"absolute",width:P}});u.extend(T,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),e.exports={name:"explanation",displayName:"Explanation",defaultAlignment:"inline",widget:T,transform:u.identity,isLintable:!0}},685:function(e,t,n){var r,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(6),s=i.StyleSheet,a=i.css,p=n(0),l=n(1),u=n(143),c=n(13),h=n(32),d=n(55),f=n(24),g=p.createClass({displayName:"Definition",propTypes:o({},u.propTypes,{apiOptions:c.Options.propTypes,definition:p.PropTypes.string,togglePrompt:p.PropTypes.string,trackInteraction:p.PropTypes.func.isRequired}),getDefaultProps:function(){return{togglePrompt:"define me",definition:"definition goes here"}},getInitialState:function(){return{expanded:!1,belowScreen:!1,contentOffsetLeft:0,contentOffsetLeftMobile:0,contentWidth:0,contentWidthMobile:0,contentMarginTop:P}},componentDidMount:function(){document.addEventListener("click",this.handleClick)},componentWillUnmount:function(){document.removeEventListener("click",this.handleClick)},handleClick:function(e){for(var t=e.target,n=!0;t;){if(t===this.content||t===this.container){n=!1;break}t=t.parentNode}n&&this.close()},change:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return u.change.apply(this,t)},close:function(){this.setState({expanded:!1})},getUserInput:function(){return{}},simpleValidate:function(e){return g.validate(this.getUserInput(),e)},_definitionBelowScreen:function(){var e=window.innerHeight;return this.container.getBoundingClientRect().bottom>e-this.content.offsetHeight},_checkDefinitionPosition:function(){var e=this;setTimeout(function(){e._positionContentHorizontally(),e._definitionBelowScreen()?e.setState({belowScreen:!0},e._positionContentVertically):e.setState({belowScreen:!1},e._positionContentVertically)},0)},_positionContentVertically:function(){if(this.state.belowScreen){var e=this.content.offsetHeight,t=-e-2*P-4;this.setState({contentMarginTop:t})}else this.setState({contentMarginTop:P})},_onClick:function(){if(!this.state.expanded)for(var e=this.props.findWidgets("definition"),t=e,n=Array.isArray(t),r=0,t=n?t:t[Symbol.iterator]();;){var o;if(n){if(r>=t.length)break;o=t[r++]}else{if(r=t.next(),r.done)break;o=r.value}var i=o;i!==this&&i.close()}this.setState({expanded:!this.state.expanded},this._checkDefinitionPosition),this.props.trackInteraction()},_onMouseOver:function(){this.setState({expanded:!0},this._checkDefinitionPosition),this.props.trackInteraction()},_onMouseOut:function(){this.setState({expanded:!1}),this.props.trackInteraction()},_positionContentHorizontally:function(){var e=document.body.clientWidth,t=this.container.parentElement.parentElement.offsetLeft,n=e-2*t,r=e-t,o=this.container.offsetLeft-t,i=this.container.offsetLeft;this.setState({contentWidth:n,contentWidthMobile:r,contentOffsetLeft:-o,contentOffsetLeftMobile:-i})},render:function(){var e=this,t=this.props.apiOptions,n=t.readOnly,r=t.isMobile,o=this.props.togglePrompt,i=void 0,s=n?null:"javascript:void(0)",l=n?null:this._onClick,u=this._onMouseOver,c=this._onMouseOut;i=r?p.createElement("a",{className:a(C.mobileDefinitionLink),href:s,onClick:l},o):p.createElement("a",{className:a(C.definitionLink),href:s,onMouseOver:u,onMouseOut:c},o);var d=r?C.contentExpandedMobile:C.contentExpanded,f=this.state.belowScreen?"scale(1, -1)":"scale(1, 1)";return p.createElement("div",{className:a(C.container),ref:function(t){return e.container=t}},p.createElement("div",{className:a(C.linkContainer)},i,this.state.expanded&&p.createElement("svg",{className:a(C.disclosureArrow),ref:function(t){return e.arrow=t},transform:f,style:{bottom:this.state.expanded&&this.state.belowScreen?"18px":"-18px"}},p.createElement("filter",{id:"definition-widget-dropshadow",height:"150%"},p.createElement("feOffset",{dx:m,dy:y,result:"offsetblur"}),p.createElement("feGaussianBlur",{in:"SourceAlpha",stdDeviation:b/2}),p.createElement("feComponentTransfer",null,p.createElement("feFuncA",{type:"linear",slope:v})),p.createElement("feMerge",null,p.createElement("feMergeNode",null),p.createElement("feMergeNode",{in:"SourceGraphic"}))),p.createElement("polyline",{fill:"white",filter:"url(#definition-widget-dropshadow)",points:"0,"+P+" "+T+","+P+" "+T/2+",0"}))),p.createElement("div",{className:a(C.content,r&&C.contentMobile,this.state.expanded&&d),style:{height:this.state.expanded?"auto":0,overflow:this.state.expanded?"visible":"hidden",left:r?this.state.contentOffsetLeftMobile:this.state.contentOffsetLeft,width:r?this.state.contentWidthMobile:this.state.contentWidth,marginTop:this.state.contentMarginTop},ref:function(t){return e.content=t}},p.createElement(h,{apiOptions:this.props.apiOptions,content:this.props.definition,widgets:this.props.widgets})))}}),m=0,y=1,v=.35,b=4,T=20,P=14,x=f.white,C=s.create({container:{display:"inline",position:"relative"},linkContainer:{display:"inline-block"},definitionLink:{color:f.blue,borderBottom:"dashed 1px "+f.blue,textDecoration:"none"},mobileDefinitionLink:(r={color:f.kaGreen,borderBottom:"dashed 1px "+f.kaGreen,textDecoration:"none"},r[d.xl]={fontSize:22,lineHeight:1.4},r[d.lgOrSmaller]={fontSize:20,lineHeight:1.5},r[d.smOrSmaller]={fontSize:18,lineHeight:1.2},r),content:{background:x,opacity:.95,borderRadius:1,position:"absolute",transition:"margin-top 0.1s",paddingLeft:f.phoneMargin,paddingRight:f.phoneMargin,zIndex:2},contentExpanded:{boxShadow:"0px 0px 4px "+f.gray85,border:"solid 0.5px "+f.gray85},contentExpandedMobile:{paddingTop:32,paddingBottom:32,boxShadow:"0px 0px 4px "+f.gray85,border:"solid 0.5px "+f.gray85},disclosureArrow:{height:P,left:"50%",marginLeft:-T/2,position:"absolute",width:T,zIndex:4}});l.extend(g,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),e.exports={name:"definition",displayName:"Definition",defaultAlignment:"inline",widget:g,transform:l.identity}},686:function(e,t,n){(function(t){function r(e,t,n){var r=function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1])};return r(n[0],n[1],t)>0!=r(n[0],n[1],e)>0}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(0),s=n(1),a=n(243),p=n(92),l=n(19),u=n(687),c=n(241),h=c.MovablePoint,d=c.MovableLine,f=n(93),g=n(9).number,m=n(9).vector,y=n(9).point,v=n(42),b=n(244),T=b.containerSizeClassPropType,P=n(24),x=P.interactiveSizes,C=n(244),w=C.getInteractiveBoxFromSizeClass,E=n(143),k=n(689),S=k.GrapherUtil,M=k.typeToButton,I=k.functionForType,_=k.DEFAULT_GRAPHER_PROPS,R={padding:"5px 5px"},O=i.createClass({displayName:"FunctionGrapher",_coords:function(e){e=e||this.props;var t=e.graph,n=e.model&&S.maybePointsFromNormalized(e.model.defaultCoords,t.range,t.step,t.snapStep);return e.coords||n||null},_asymptote:function(e){return e=e||this.props,e.asymptote},propTypes:o({},E.propTypes,{flexibleType:i.PropTypes.bool,graph:i.PropTypes.any,hideHairlines:i.PropTypes.func,isMobile:i.PropTypes.bool,model:i.PropTypes.any,onChange:i.PropTypes.func,setDrawingAreaAvailable:i.PropTypes.func,showHairlines:i.PropTypes.func,showTooltips:i.PropTypes.bool,static:i.PropTypes.bool}),getDefaultProps:function(){return{graph:{range:[[-10,10],[-10,10]],step:[1,1]},coords:null,asymptote:null,isMobile:!1}},change:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return E.change.apply(this,t)},render:function(){var e=this,t=function(t,n){return i.createElement(h,{key:n,coord:t,static:e.props.static,constraints:[a.MovablePoint.constraints.bound(),a.MovablePoint.constraints.snap(),function(t){var r=s.all(e._coords(),function(e,r){return n===r||!e||!g.equal(t[0],e[0])});if(!r)return!1;if(e.props.model&&e.props.model.extraCoordConstraint){var o=e.props.model.extraCoordConstraint,i=s.clone(e._coords()),a=s.clone(i[n]);return i[n]=t,o(t,a,i,e._asymptote(),e.props.graph)}return r}],onMove:function(t,o){var i,a=e._asymptote();i=a&&e.props.model.allowReflectOverAsymptote&&r(t,o,a)?s.map(e._coords(),function(e){return y.reflectOverLine(e,a)}):s.clone(e._coords()),i[n]=t,e.props.onChange({coords:i})},showHairlines:e.props.showHairlines,hideHairlines:e.props.hideHairlines,showTooltips:e.props.showTooltips,isMobile:e.props.isMobile})},n=s.map(this._coords(),t),l=this.props.graph.box,u=this.props.graph.backgroundImage,d=null;if(u.url){var f=l[0]/x.defaultBoxSize;d=i.createElement(p,{src:u.url,width:u.width,height:u.height,scale:f})}return i.createElement("div",{className:"perseus-widget perseus-widget-grapher",style:{width:l[0],height:this.props.flexibleType?"auto":l[1],boxSizing:"initial"}},i.createElement("div",{className:"graphie-container above-scratchpad",style:{width:l[0],height:l[1]}},d,i.createElement(c,o({},this.props.graph,{setDrawingAreaAvailable:this.props.setDrawingAreaAvailable}),this.props.model&&this.renderPlot(),this.props.model&&this.renderAsymptote(),this.props.model&&n)))},renderPlot:function(){var e=this.props.model,t=this.props.graph.range[0],n=o({stroke:this.props.isMobile?v.BLUE_C:v.DYNAMIC},this.props.isMobile?{"stroke-width":3}:{}),r=e.getCoefficients(this._coords(),this._asymptote());if(r){var s=e.getPropsForCoeffs(r,t);return i.createElement(e.Movable,o({},s,{key:this.props.model.url,range:t,style:n}))}},renderAsymptote:function(){var e=this,t=this.props.model,n=this.props.graph,r=this._asymptote(),o={strokeDasharray:"- "};return r&&i.createElement(d,{onMove:function(t,n){var r=m.subtract(t,n),o=s.map(e._asymptote(),function(e){return m.add(e,r)});e.props.onChange({asymptote:o})},constraints:[a.MovableLine.constraints.bound(),a.MovableLine.constraints.snap(),function(r,o){var i=m.subtract(r,o),a=s.map(e._asymptote(),function(e){return m.add(e,i)});return!t.extraAsymptoteConstraint||t.extraAsymptoteConstraint(r,o,e._coords(),a,n)}],normalStyle:o,highlightStyle:o},s.map(r,function(t,n){return i.createElement(h,{key:"asymptoteCoord-"+n,coord:t,static:!0,draw:null,extendLine:!0,showHairlines:e.props.showHairlines,hideHairlines:e.props.hideHairlines,showTooltips:e.props.showTooltips,isMobile:e.props.isMobile})}))}}),N=i.createClass({displayName:"Grapher",propTypes:{apiOptions:i.PropTypes.any,availableTypes:i.PropTypes.arrayOf(i.PropTypes.any),containerSizeClass:T.isRequired,graph:i.PropTypes.any,markings:i.PropTypes.string,onChange:i.PropTypes.func,plot:i.PropTypes.any,static:i.PropTypes.bool,trackInteraction:i.PropTypes.func.isRequired},getDefaultProps:function(){return _},render:function(){var e=this.props.plot.type,t=this.props.plot.coords,n=this.props.plot.asymptote,r=i.createElement("div",{style:R,className:"above-scratchpad"},i.createElement(u,{value:e,allowEmpty:!0,buttons:s.map(this.props.availableTypes,M),onChange:this.handleActiveTypeChange})),a=w(this.props.containerSizeClass),p=o({},this.props.graph,S.getGridAndSnapSteps(this.props.graph,a[0]),{gridConfig:this._getGridConfig(o({},this.props.graph,{box:a},S.getGridAndSnapSteps(this.props.graph,a[0])))}),l={graph:{box:a,range:p.range,step:p.step,snapStep:p.snapStep,backgroundImage:p.backgroundImage,options:p,setup:this._setupGraphie},onChange:this.handlePlotChanges,model:e&&I(e),coords:t,asymptote:n,static:this.props.static,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable,isMobile:this.props.apiOptions.isMobile,showTooltips:this.props.graph.showTooltips,showHairlines:this.showHairlines,hideHairlines:this.hideHairlines};return i.createElement("div",null,i.createElement(O,l),this.props.availableTypes.length>1&&r)},handlePlotChanges:function(e){var t=s.extend({},this.props.plot,e);this.props.onChange({plot:t}),this.props.trackInteraction()},handleActiveTypeChange:function(e){var t=this.props.graph,n=s.extend({},this.props.plot,S.defaultPlotProps(e,t));this.props.onChange({plot:n})},_getGridConfig:function(e){return s.map(e.step,function(t,n){return l.gridDimensionConfig(t,e.range[n],e.box[n],e.gridStep[n])})},_calculateMobileTickStep:function(e,t,n){var r=l.constrainedTickStepsFromTickSteps(t,n);return r[0]=r[0]/e[0],r[1]=r[1]/e[1],r},_setupGraphie:function(e,t){var n=this.props.apiOptions.isMobile;if("graph"===t.markings?(e.graphInit({range:t.range,scale:s.pluck(t.gridConfig,"scale"),axisArrows:"<->",labelFormat:function(e){return"\\small{"+e+"}"},gridStep:t.gridStep,snapStep:t.snapStep,tickStep:n?this._calculateMobileTickStep(t.gridStep,t.step,t.range):s.pluck(t.gridConfig,"tickStep"),labelStep:1,unityLabels:s.pluck(t.gridConfig,"unityLabel"),isMobile:n}),e.label([0,t.range[1][1]],t.labels[1],n?"below right":"above"),e.label([t.range[0][1],0],t.labels[0],n?"above left":"right")):"grid"===t.markings?e.graphInit({range:t.range,scale:s.pluck(t.gridConfig,"scale"),gridStep:t.gridStep,axes:!1,ticks:!1,labels:!1,isMobile:n}):"none"===t.markings&&e.init({range:t.range,scale:s.pluck(t.gridConfig,"scale")}),this.props.apiOptions.isMobile){var r={normalStyle:{strokeWidth:1}};this.horizHairline=new f(e,[0,0],[0,0],r),this.horizHairline.attr({stroke:v.INTERACTIVE}),this.horizHairline.hide(),this.vertHairline=new f(e,[0,0],[0,0],r),this.vertHairline.attr({stroke:v.INTERACTIVE}),this.vertHairline.hide()}},showHairlines:function(e){this.props.apiOptions.isMobile&&"none"!==this.props.markings&&(this.horizHairline.moveTo([this.props.graph.range[0][0],e[1]],[this.props.graph.range[0][1],e[1]]),this.horizHairline.show(),this.vertHairline.moveTo([e[0],this.props.graph.range[1][0]],[e[0],this.props.graph.range[1][1]]),this.vertHairline.show())},hideHairlines:function(){this.props.apiOptions.isMobile&&(this.horizHairline.hide(),this.vertHairline.hide())},simpleValidate:function(e){return S.validate(this.getUserInput(),e)},getUserInput:function(){return this.props.plot},focus:t.noop}),A=function(e){var t={availableTypes:e.availableTypes,graph:e.graph};if(1===t.availableTypes.length){var n=t.graph,r=S.chooseType(t.availableTypes);t.plot=S.defaultPlotProps(r,n)}return t},D=function(e){return s.extend({},A(e),{availableTypes:[e.correct.type],plot:e.correct})};e.exports={name:"grapher",displayName:"Grapher",widget:N,transform:A,staticTransform:D}}).call(t,n(10))},687:function(e,t,n){var r=n(0),o=n(8),i=n(688),s=n(6).css,a=r.createClass({displayName:"ButtonGroup",propTypes:{value:r.PropTypes.any,buttons:r.PropTypes.arrayOf(r.PropTypes.shape({value:r.PropTypes.any.isRequired,content:r.PropTypes.node,title:r.PropTypes.string})).isRequired,onChange:r.PropTypes.func.isRequired,allowEmpty:r.PropTypes.bool},getDefaultProps:function(){return{value:null,allowEmpty:!0}},focus:function(){return o.findDOMNode(this).focus(),!0},toggleSelect:function(e){var t=this.props.value;this.props.allowEmpty?this.props.onChange(t!==e?e:null):this.props.onChange(e)},render:function(){var e=this,t=this.props.value,n=this.props.buttons.map(function(n,o){return r.createElement("button",{title:n.title,type:"button",id:""+o,ref:"button"+o,key:""+o,className:s(i.button.buttonStyle,n.value===t&&i.button.selectedStyle),onClick:e.toggleSelect.bind(e,n.value)},n.content||""+n.value)}),o={display:"inline-block"};return r.createElement("div",{style:o},n)}});e.exports=a},688:function(e,t,n){const r=n(6).StyleSheet,o=r.create({buttonStyle:{backgroundColor:"white",border:"1px solid #ccc",borderLeft:"0",cursor:"pointer",margin:"0",padding:"5px 10px",position:"relative",":first-child":{borderLeft:"1px solid #ccc",borderTopLeftRadius:"3px",borderBottomLeftRadius:"3px"},":last-child":{borderRight:"1px solid #ccc",borderTopRightRadius:"3px",borderBottomRightRadius:"3px"},":hover":{backgroundColor:"#ccc"},":focus":{zIndex:"2"}},selectedStyle:{backgroundColor:"#ddd"}});e.exports={button:o}},689:function(e,t,n){(function(t){function r(e){var t=e[0],n=e[1],r=e[2],o=e[3];t<0&&(t*=-1,n*=-1,r*=-1);var i=2*Math.PI;for(n<0&&(n*=-1,r*=-1,r+=i/2);r>0;)r-=i;for(;r<0;)r+=i;return[t,n,r,o]}function o(e){var t=e[0],n=e[1],r=e[2],o=e[3];t<0&&(t*=-1,n*=-1,r*=-1);var i=Math.PI;for(n<0&&(n*=-1,r*=-1,r+=i/2);r>0;)r-=i;for(;r<0;)r+=i;return[t,n,r,o]}function i(e){return P[e]}function s(e){var n=e.charAt(0).toUpperCase()+e.substring(1);return{value:e,title:n,content:t.createElement("img",{src:i(e).url,alt:n})}}var a=n(1),p=n(19),l=n(241),u=l.Plot,c=n(9).point,h={url:null},d={areEqual:function(e,t){return p.deepEq(e,t)},Movable:u,getPropsForCoeffs:function(e){return{fn:a.partial(this.getFunctionForCoeffs,e)}}},f=a.extend({},d,{url:"https://ka-perseus-graphie.s3.amazonaws.com/67aaf581e6d9ef9038c10558a1f70ac21c11c9f8.png",defaultCoords:[[.25,.75],[.75,.75]],getCoefficients:function(e){var t=e[0],n=e[1],r=n[0]-t[0],o=n[1]-t[1];if(0!==r){var i=o/r;return[i,n[1]-i*n[0]]}},getFunctionForCoeffs:function(e,t){return e[0]*t+e[1]},getEquationString:function(e){var t=this.getCoefficients(e),n=t[0],r=t[1];return"y = "+n.toFixed(3)+"x + "+r.toFixed(3)}}),g=a.extend({},d,{url:"https://ka-perseus-graphie.s3.amazonaws.com/e23d36e6fc29ee37174e92c9daba2a66677128ab.png",defaultCoords:[[.5,.5],[.75,.75]],Movable:l.Parabola,getCoefficients:function(e){var t=e[0],n=e[1],r=t[0],o=t[1],i=(n[1]-o)/((n[0]-r)*(n[0]-r));return[i,-2*r*i,i*r*r+o]},getFunctionForCoeffs:function(e,t){return(e[0]*t+e[1])*t+e[2]},getPropsForCoeffs:function(e){return{a:e[0],b:e[1],c:e[2]}},getEquationString:function(e){var t=this.getCoefficients(e),n=t[0],r=t[1],o=t[2];return"y = "+n.toFixed(3)+"x^2 + "+r.toFixed(3)+"x + "+o.toFixed(3)}}),m=a.extend({},d,{url:"https://ka-perseus-graphie.s3.amazonaws.com/3d68e7718498475f53b206c2ab285626baf8857e.png",defaultCoords:[[.5,.5],[.6,.6]],Movable:l.Sinusoid,getCoefficients:function(e){var t=e[0],n=e[1],r=n[1]-t[1],o=Math.PI/(2*(n[0]-t[0]));return[r,o,t[0]*o,t[1]]},getFunctionForCoeffs:function(e,t){var n=e[0],r=e[1],o=e[2],i=e[3];return n*Math.sin(r*t-o)+i},getPropsForCoeffs:function(e){return{a:e[0],b:e[1],c:e[2],d:e[3]}},getEquationString:function(e){var t=this.getCoefficients(e),n=t[0],r=t[1],o=t[2],i=t[3];return"y = "+n.toFixed(3)+" sin("+r.toFixed(3)+"x - "+o.toFixed(3)+") + "+i.toFixed(3)},areEqual:function(e,t){return p.deepEq(r(e),r(t))}}),y=a.extend({},d,{url:"https://ka-perseus-graphie.s3.amazonaws.com/7db80d23c35214f98659fe1cf0765811c1bbfbba.png",defaultCoords:[[.5,.5],[.75,.75]],getCoefficients:function(e){var t=e[0],n=e[1],r=n[1]-t[1],o=Math.PI/(4*(n[0]-t[0]));return[r,o,t[0]*o,t[1]]},getFunctionForCoeffs:function(e,t){var n=e[0],r=e[1],o=e[2],i=e[3];return n*Math.tan(r*t-o)+i},getEquationString:function(e){var t=this.getCoefficients(e),n=t[0],r=t[1],o=t[2],i=t[3];return"y = "+n.toFixed(3)+" sin("+r.toFixed(3)+"x - "+o.toFixed(3)+") + "+i.toFixed(3)},areEqual:function(e,t){return p.deepEq(o(e),o(t))}}),v=a.extend({},d,{url:"https://ka-perseus-graphie.s3.amazonaws.com/9cbfad55525e3ce755a31a631b074670a5dad611.png",defaultCoords:[[.5,.55],[.75,.75]],defaultAsymptote:[[0,.5],[1,.5]],extraCoordConstraint:function(e,t,n,r,o){var i=a.head(r)[1];return a.all(n,function(e){return e[1]!==i})},extraAsymptoteConstraint:function(e,t,n,r,o){var i=e[1];if(a.all(n,function(e){return e[1]>i})||a.all(n,function(e){return e[1]<i}))return[t[0],i];var s=t[1];if(a.all(n,function(e){return e[1]>s})){var p=a.min(a.map(n,function(e){return e[1]}));return[t[0],p-o.snapStep[1]]}var l=a.max(a.map(n,function(e){return e[1]}));return[t[0],l+o.snapStep[1]]},allowReflectOverAsymptote:!0,getCoefficients:function(e,t){var n=e[0],r=e[1],o=a.head(t)[1],i=Math.log((n[1]-o)/(r[1]-o))/(n[0]-r[0]);return[(n[1]-o)/Math.exp(i*n[0]),i,o]},getFunctionForCoeffs:function(e,t){var n=e[0],r=e[1],o=e[2];return n*Math.exp(r*t)+o},getEquationString:function(e,t){if(!t)return null;var n=this.getCoefficients(e,t),r=n[0],o=n[1],i=n[2];return"y = "+r.toFixed(3)+"e^("+o.toFixed(3)+"x) + "+i.toFixed(3)}}),b=a.extend({},d,{url:"https://ka-perseus-graphie.s3.amazonaws.com/f6491e99d34af34d924bfe0231728ad912068dc3.png",defaultCoords:[[.55,.5],[.75,.75]],defaultAsymptote:[[.5,0],[.5,1]],extraCoordConstraint:function(e,t,n,r,o){var i=a.head(r)[0];return a.all(n,function(e){return e[0]!==i})&&n[0][1]!==n[1][1]},extraAsymptoteConstraint:function(e,t,n,r,o){var i=e[0];if(a.all(n,function(e){return e[0]>i})||a.all(n,function(e){return e[0]<i}))return[i,t[1]];var s=t[0];return a.all(n,function(e){return e[0]>s})?[a.min(a.map(n,function(e){return e[0]}))-o.snapStep[0],t[1]]:[a.max(a.map(n,function(e){return e[0]}))+o.snapStep[0],t[1]]},allowReflectOverAsymptote:!0,getCoefficients:function(e,t){var n=function(e){return[e[1],e[0]]},r=v.getCoefficients(a.map(e,n),a.map(t,n)),o=-r[2]/r[0],i=1/r[0];return[1/r[1],i,o]},getFunctionForCoeffs:function(e,t,n){var r=e[0],o=e[1],i=e[2];return r*Math.log(o*t+i)},getEquationString:function(e,t){if(!t)return null;var n=this.getCoefficients(e,t),r=n[0],o=n[1],i=n[2];return"y = ln("+r.toFixed(3)+"x + "+o.toFixed(3)+") + "+i.toFixed(3)}}),T=a.extend({},d,{url:"https://ka-perseus-graphie.s3.amazonaws.com/8256a630175a0cb1d11de223d6de0266daf98721.png",defaultCoords:[[.5,.5],[.75,.75]],getCoefficients:function(e){var t=e[0],n=e[1],r=n[0]-t[0],o=n[1]-t[1];if(0!==r){var i=Math.abs(o/r);return n[1]<t[1]&&(i*=-1),[i,t[0],t[1]]}},getFunctionForCoeffs:function(e,t){var n=e[0],r=e[1],o=e[2];return n*Math.abs(t-r)+o},getEquationString:function(e){var t=this.getCoefficients(e),n=t[0],r=t[1],o=t[2];return"y = "+n.toFixed(3)+"| x - "+r.toFixed(3)+"| + "+o.toFixed(3)}}),P={linear:f,quadratic:g,sinusoid:m,tangent:y,exponential:v,logarithm:b,absolute_value:T},x=a.keys(P),C={validate:function(e,t){if(e.type!==t.correct.type)return{type:"points",earned:0,total:1,message:null};if(null==e.coords)return{type:"invalid",message:null};var n=i(e.type),r=n.getCoefficients(e.coords,e.asymptote),o=n.getCoefficients(t.correct.coords,t.correct.asymptote);return null==r||null==o?{type:"invalid",message:null}:n.areEqual(r,o)?{type:"points",earned:1,total:1,message:null}:{type:"points",earned:0,total:1,message:null}},getEquationString:function(e){var t=e.plot;return t.type&&t.coords?i(t.type).getEquationString(t.coords,t.asymptote)||"":""},pointsFromNormalized:function(e,t,n,r){var o=function(e,t){return Math.floor((e[1]-e[0])/t)};return a.map(e,function(e){var i=a.map(e,function(e,r){var i=t[r],s=n[r],a=o(i,s),p=Math.round(e*a);return i[0]+s*p});return c.roundTo(i,r)})},maybePointsFromNormalized:function(e,t,n,r){return e?this.pointsFromNormalized(e,t,n,r):e},defaultPlotProps:function(e,t){var n=i(e),r=[1,1],o=p.snapStepFromGridStep(r);return{type:e,asymptote:this.maybePointsFromNormalized(n.defaultAsymptote,t.range,t.step,o),coords:null}},chooseType:a.first,getGridAndSnapSteps:function(e,t){var n=e.gridStep||p.getGridStep(e.range,e.step,t);return{gridStep:n,snapStep:e.snapStep||p.snapStepFromGridStep(n)}}},w={};w.graph={labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],backgroundImage:h,markings:"graph",rulerLabel:"",rulerTicks:10,valid:!0,showTooltips:!1},w.plot=C.defaultPlotProps("linear",w.graph),w.availableTypes=[w.plot.type],e.exports={GrapherUtil:C,allTypes:x,typeToButton:s,functionForType:i,DEFAULT_GRAPHER_PROPS:w,DEFAULT_BACKGROUND_IMAGE:h}}).call(t,n(0))},690:function(e,t,n){(function(t){var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(0),i=n(13).Options,s=n(91),a=n(90),p=a.iconStar,l=a.iconTryAgain,u=n(24),c=u.boldFontFamily,h=u.gray68,d=u.gray76,f=u.gray85,g=u.gray95,m=u.kaGreen,y=u.phoneMargin,v=u.negativePhoneMargin,b={HIDDEN:Symbol("HIDDEN"),ACTIVE:Symbol("ACTIVE"),INACTIVE:Symbol("INACTIVE"),INCORRECT:Symbol("INCORRECT"),CORRECT:Symbol("CORRECT")},T=o.createClass({displayName:"GradedGroupAnswerBar",propTypes:{answerBarState:o.PropTypes.any.isRequired,apiOptions:i.propTypes,onCheckAnswer:o.PropTypes.func.isRequired,onNextQuestion:o.PropTypes.func},render:function(){var e=this.props,n=e.apiOptions,i=e.answerBarState,a=e.onCheckAnswer,u=e.onNextQuestion,c=r({},P.answerBar,{backgroundColor:i===b.CORRECT?g:"white",justifyContent:i!==b.CORRECT||u?"space-between":"center"}),d=r({},P.button,{backgroundColor:i===b.ACTIVE||i===b.CORRECT?m:f}),y=r({},P.text,{color:i===b.CORRECT?m:h}),v=i===b.INCORRECT?o.createElement("span",{style:y},o.createElement("span",{style:P.tryAgainIcon},o.createElement(s,l)),o.createElement("span",{style:{marginLeft:8}},t._("Keep trying"))):o.createElement("span",null);if(i!==b.CORRECT){var T=i===b.INCORRECT?t._("Try again"):t._("Check");return o.createElement("div",{style:c},v,o.createElement("button",{style:d,disabled:n.readOnly||i!==b.ACTIVE,onClick:a},T))}return o.createElement("div",{style:c},o.createElement("span",{style:y},o.createElement("span",{style:{fontSize:28,color:"#FFB300"}},o.createElement(s,r({},p,{style:{marginBottom:5}}))),o.createElement("span",{style:{marginLeft:8}},t._("Correct!"))),u&&o.createElement("button",{style:d,onClick:u},t._("Next question")))}}),P={answerBar:{display:"flex",alignItems:"center",height:68,marginLeft:v,marginRight:v,marginBottom:v,marginTop:y,paddingLeft:y,paddingRight:10,borderTop:"1px solid "+d},button:{height:48,width:143,borderRadius:4,color:"white",fontFamily:c,fontSize:17,border:"none"},tryAgainIcon:{fontSize:28,color:"#63D9EA",transform:"scale(-1,1) rotate(-268deg)"},text:{display:"flex",flexDirection:"row",alignItems:"center",fontFamily:c,fontSize:17}};T.ANSWER_BAR_STATES=b,e.exports=T}).call(t,n(23))},691:function(e,t,n){var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(0),i=(n(1),n(6)),s=i.StyleSheet,a=i.css,p=n(13).Options,l=n(143),u=n(673).widget,c=n(24),h=c.grayLight,d=c.gray76,f=c.tableBackgroundAccent,g=c.kaGreen,m=c.phoneMargin,y=c.negativePhoneMargin,v=n(22),b=v.linterContextProps,T=v.linterContextDefault,P=o.createClass({displayName:"Indicators",propTypes:{currentGroup:o.PropTypes.number.isRequired,numGroups:o.PropTypes.number.isRequired,onChangeCurrentGroup:o.PropTypes.func.isRequired},render:function(){for(var e=this,t=[],n=0;n<this.props.numGroups;n++)!function(n){t.push(o.createElement("div",{key:n,className:a(w.indicator,n===e.props.currentGroup&&w.selectedIndicator),onClick:function(){return e.props.onChangeCurrentGroup(n)}}))}(n);return o.createElement("div",{className:a(w.indicatorContainer)},t)}}),x=o.createClass({displayName:"GradedGroupSet",propTypes:r({},l.propTypes,{apiOptions:p.propTypes,gradedGroups:o.PropTypes.array,trackInteraction:o.PropTypes.func.isRequired,linterContext:b}),getDefaultProps:function(){return{gradedGroups:[],linterContext:T}},getInitialState:function(){return{currentGroup:0}},shouldComponentUpdate:function(e,t){return e!==this.props||t!==this.state},change:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return l.change.apply(this,t)},getInputPaths:function(){return this._childGroup.getInputPaths()},setInputValue:function(e,t,n){return this._childGroup.setInputValue(e,t,n)},getAcceptableFormatsForInputPath:function(e){return this._childGroup.getAcceptableFormatsForInputPath(e)},focus:function(){return this._childGroup.focus()},focusInputPath:function(e){this._childGroup.focusInputPath(e)},blurInputPath:function(e){this._childGroup.blurInputPath(e)},handleNextQuestion:function(){var e=this.state.currentGroup;e<this.props.gradedGroups.length-1&&this.setState({currentGroup:e+1})},render:function(){var e=this,t=this.props.gradedGroups[this.state.currentGroup];if(!t)return o.createElement("span",null,"No current group...");var n=this.props.gradedGroups.length,i=this.state.currentGroup<n-1?this.handleNextQuestion:null;return o.createElement("div",{className:a(w.container)},o.createElement("div",{className:a(w.top)},o.createElement("div",{className:a(w.title)},t.title),o.createElement("div",{className:a(w.spacer)}),o.createElement(P,{numGroups:n,currentGroup:this.state.currentGroup,onChangeCurrentGroup:function(t){return e.setState({currentGroup:t})}})),o.createElement(u,r({key:this.state.currentGroup,ref:function(t){return e._childGroup=t}},this.props,t,{inGradedGroupSet:!0,title:null,onNextQuestion:i,linterContext:this.props.linterContext})))}}),C=function(e,t){return{groups:e.gradedGroups.map(t)}};e.exports={name:"graded-group-set",displayName:"Graded group set (articles only)",widget:x,traverseChildWidgets:C,hidden:!1,tracking:"all",isLintable:!0};var w=s.create({top:{display:"flex",flexDirection:"row"},spacer:{flex:1},title:{fontSize:12,color:d,textTransform:"uppercase",marginBottom:11,letterSpacing:.8},indicatorContainer:{display:"flex",flexDirection:"row"},indicator:{width:10,height:10,borderRadius:5,backgroundColor:h,marginLeft:5,cursor:"pointer"},selectedIndicator:{backgroundColor:g},container:{borderTop:"1px solid "+d,borderBottom:"1px solid "+d,backgroundColor:f,marginLeft:y,marginRight:y,paddingBottom:m,paddingLeft:m,paddingRight:m,paddingTop:10,width:"auto"}})},692:function(e,t,n){var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(21),i=n(0),s=n(1),a=n(13).Options,p=n(143),l=n(32),u=n(22),c=u.linterContextProps,h=u.linterContextDefault,d=i.createClass({displayName:"Group",propTypes:r({},p.propTypes,{content:i.PropTypes.string,widgets:i.PropTypes.object,images:i.PropTypes.object,icon:i.PropTypes.object,reviewModeRubric:i.PropTypes.object,linterContext:c}),getDefaultProps:function(){return{content:"",widgets:{},images:{},icon:null,linterContext:h}},componentDidMount:function(){this.forceUpdate()},render:function(){var e=this,t=s.extend({},a.defaults,this.props.apiOptions,{onFocusChange:function(t,n){n&&e.props.onBlur(n),t&&e.props.onFocus(t)}}),n=s.indexOf(this.props.findWidgets("group"),this),p=this.props.apiOptions.groupAnnotator(n,this.props.widgetId),u=function(t){e.refs.renderer&&e.change("widgets",e.refs.renderer.props.widgets)},c=this.refs.renderer&&this.refs.renderer.score(),h=c&&"invalid"!==c.type,d=c&&"invalid"===c.type;return i.createElement("div",{className:o({"perseus-group":!0,"perseus-group-valid-answer":h,"perseus-group-invalid-answer":d})},p,i.createElement(l,r({},this.props,{ref:"renderer",apiOptions:t,findExternalWidgets:this.props.findWidgets,reviewMode:!!this.props.reviewModeRubric,onInteractWithWidget:u,linterContext:this.props.linterContext})),this.props.icon&&i.createElement("div",{className:"group-icon"},this.props.icon))},change:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return p.change.apply(this,t)},getUserInput:function(){return this.refs.renderer.getUserInput()},getSerializedState:function(){return this.refs.renderer.getSerializedState()},restoreSerializedState:function(e,t){return this.refs.renderer.restoreSerializedState(e,t),null},simpleValidate:function(e){return this.refs.renderer.score()},getInputPaths:function(){return this.refs.renderer.getInputPaths()},setInputValue:function(e,t,n){return this.refs.renderer.setInputValue(e,t,n)},getAcceptableFormatsForInputPath:function(e){return this.refs.renderer.getAcceptableFormatsForInputPath(e)},getRenderer:function(){return this.refs.renderer},focus:function(){return this.refs.renderer.focus()},focusInputPath:function(e){this.refs.renderer.focusPath(e)},blurInputPath:function(e){this.refs.renderer.blurPath(e)},showRationalesForCurrentlySelectedChoices:function(){this.refs.renderer.showRationalesForCurrentlySelectedChoices()}}),f=function(e,t){return s.extend({},e,t(e))};e.exports={name:"group",displayName:"Group (SAT only)",widget:d,traverseChildWidgets:f,hidden:!1,isLintable:!0}},693:function(e,t,n){(function(t){var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(0),i=n(1),s=n(143),a=n(242),p=n(19).updateQueryString,l=o.createClass({displayName:"Iframe",propTypes:r({},s.propTypes,{width:o.PropTypes.string,height:o.PropTypes.string,url:o.PropTypes.string,settings:o.PropTypes.array,status:o.PropTypes.oneOf(["incomplete","incorrect","correct"]),message:o.PropTypes.string,allowFullScreen:o.PropTypes.bool}),getDefaultProps:function(){return{status:"incomplete",message:null,allowFullScreen:!1}},getUserInput:function(){return a.getUserInput.call(this)},handleMessageEvent:function(e){var t={};try{t=JSON.parse(e.originalEvent.data)}catch(e){return}if(!i.isUndefined(t.testsPassed)){var n=t.testsPassed?"correct":"incorrect";this.change({status:n,message:t.message})}},componentDidMount:function(){t(window).on("message",this.handleMessageEvent)},componentWillUnmount:function(){t(window).off("message",this.handleMessageEvent)},render:function(){var e={width:this.props.width,height:this.props.height},t=this.props.url;if(t&&t.length&&0!==t.indexOf("http")&&(t="https://www.khanacademy.org/computer-programming/program/"+t+"/embedded?buttons=no&embed=yes&editor=no&author=no",t=p(t,"width",this.props.width),t=p(t,"height",this.props.height),t=p(t,"origin",window.location.origin)),"undefined"!=typeof KA&&KA.isZeroRated&&(t.match(/https?:\/\/[^\/]*khanacademy.org/)?t.match(/zero.khanacademy.org/)||(t=t.replace("khanacademy.org","zero.khanacademy.org")):t="/zero/external-link?context=iframe&url="+encodeURIComponent(t)),this.props.settings){var n={};i.each(this.props.settings,function(e){e.name&&e.value&&(n[e.name]=e.value)}),t=p(t,"settings",JSON.stringify(n))}return o.createElement("iframe",{sandbox:"allow-same-origin allow-scripts",style:e,src:t,allowFullScreen:this.props.allowFullScreen})},change:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.change.apply(this,t)},simpleValidate:function(e){return l.validate(this.getUserInput(),e)}});i.extend(l,{validate:function(e,t){return"correct"===e.status?{type:"points",earned:1,total:1,message:e.message||null}:"incorrect"===e.status?{type:"points",earned:0,total:1,message:e.message||null}:{type:"invalid",message:"Keep going, you're not there yet!"}}}),e.exports={name:"iframe",displayName:"Iframe",widget:l,hidden:!0}}).call(t,n(10))},694:function(e,t,n){(function(t){var r,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(21),s=n(6),a=s.StyleSheet,p=s.css,l=n(0),u=n(1),c=n(13).Options,h=n(24),d=h.baseUnitPx,f=n(143),g=n(55),m=n(32),y=n(92),v=n(22),b=v.linterContextProps,T=v.linterContextDefault,P=[0,10],x={url:null,width:0,height:0},C=["block","float-left","float-right","full-width"],w=["block","full-width"],E=l.createClass({displayName:"ImageWidget",propTypes:o({},f.propTypes,{alignment:l.PropTypes.oneOf(C),alt:l.PropTypes.string,apiOptions:c.propTypes,backgroundImage:l.PropTypes.shape({url:l.PropTypes.string,width:l.PropTypes.number,height:l.PropTypes.number}),box:l.PropTypes.arrayOf(l.PropTypes.number),caption:l.PropTypes.string,labels:l.PropTypes.arrayOf(l.PropTypes.shape({content:l.PropTypes.string,coordinates:l.PropTypes.arrayOf(l.PropTypes.number),alignment:l.PropTypes.string})),range:l.PropTypes.arrayOf(l.PropTypes.arrayOf(l.PropTypes.number)),title:l.PropTypes.string,trackInteraction:l.PropTypes.func.isRequired,linterContext:b}),statics:{styles:a.create({caption:(r={display:"inline-block",marginTop:d,maxWidth:640},r[g.lgOrSmaller]={maxWidth:540},r[g.smOrSmaller]={maxWidth:450},r)})},getDefaultProps:function(){return{alignment:"block",title:"",range:[P,P],box:[400,400],backgroundImage:x,labels:[],alt:"",caption:"",linterContext:T}},render:function(){var e,t,n=this.props.apiOptions,r=this.props.backgroundImage;if(r.url&&(e=l.createElement(y,{src:r.url,alt:this.props.alt?"":void 0,width:r.width,height:r.height,preloader:n.imagePreloader,extraGraphie:{box:this.props.box,range:this.props.range,labels:this.props.labels},trackInteraction:this.props.trackInteraction,zoomToFullSizeOnMobile:n.isMobile,constrainHeight:n.isMobile,allowFullBleed:n.isMobile})),this.props.alt&&(t=l.createElement("span",{className:"perseus-sr-only"},l.createElement(m,{content:this.props.alt,apiOptions:n,linterContext:this.props.linterContext}))),n.isMobile){var o;if(this.props.title||this.props.caption){var s=this.props.title;s&&(this.props.caption&&!/[.?!"']\s*$/.test(s)&&(s+="."),s="**"+s+"** ");var a=i({"perseus-image-caption":!0,"has-title":!!s}),u=this.props.alignment,c="block"===u||"full-width"===u,h=c?null:"0 !important";o=l.createElement("div",{className:a},l.createElement("div",{className:p(E.styles.caption),style:{minWidth:h}},l.createElement(m,{content:s+this.props.caption,apiOptions:n,linterContext:this.props.linterContext})))}return l.createElement("div",{className:"perseus-image-widget"},e,t,o)}var d,f;return this.props.title&&(d=l.createElement("div",{className:"perseus-image-title"},l.createElement(m,{content:this.props.title,apiOptions:n,linterContext:this.props.linterContext}))),this.props.caption&&(f=l.createElement("div",{className:"perseus-image-caption"},l.createElement(m,{content:this.props.caption,apiOptions:n,linterContext:this.props.linterContext}))),l.createElement("div",{className:"perseus-image-widget"},d,e,t,f)},change:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return f.change.apply(this,t)},getUserInput:function(){return null},simpleValidate:function(e){return E.validate(this.getUserInput(),e)},focus:t.noop});u.extend(E,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),e.exports={name:"image",accessible:function(e){var t=e.backgroundImage;return!(t&&t.url&&!e.alt)},defaultAlignment:"block",supportedAlignments:w,displayName:"Image",widget:E,isLintable:!0}}).call(t,n(10))},695:function(e,t,n){(function(t){var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(0),i=n(1),s=n(143),a=n(241),p=a.Label,l=a.Line,u=a.MovablePoint,c=a.MovableLine,h=a.Plot,d=a.PlotParametric,f=a.Point,g=a.Rect,m=n(9).vector,y=function(e,t){t=t||{};for(var n=e+"||"+t.decimal_separatpr+"||",r=t.functions,o=r?r.length:0,i=0;i<o;i++)n+=r[i]+"|";return n},v=Object.create(null),b=function(e,n){var r=y(e,n),o=v[r];return o||(o=t.parse(e,n),v[r]=o,o)},T=Object.create(null),P=function(e,n){var r=y(e,n),o=T[r];if(o)return o;var i=t.parse(e,n).expr;return o=i?i.compile():function(){return 0},T[r]=o,o},x={graph:{box:[400,400],labels:["x","y"],range:[[-10,10],[-10,10]],tickStep:[1,1],gridStep:[1,1],markings:"graph"},elements:[]},C=o.createClass({displayName:"Interaction",propTypes:r({},s.propTypes,{graph:o.PropTypes.object,elements:o.PropTypes.arrayOf(o.PropTypes.object)}),getDefaultProps:function(){return x},getInitialState:function(){return{variables:this._getInitialVariables(this.props.elements),functions:this._getInitialFunctions(this.props.elements)}},_getInitialVariables:function(e){var t={};return i.each(i.where(e,{type:"movable-point"}),function(e){var n=e.options.varSubscript,r=b(e.options.startX||"0").expr,o=b(e.options.startY||"0").expr,i=0,s=0;r&&(i=r.eval({})||0),o&&(s=o.eval({})||0),t["x_"+n]=i,t["y_"+n]=s},this),i.each(i.where(e,{type:"movable-line"}),function(e){var n=e.options.startSubscript,r=e.options.endSubscript,o=b(e.options.startX||"0").expr,i=b(e.options.startY||"0").expr,s=b(e.options.endX||"0").expr,a=b(e.options.endY||"0").expr,p=0,l=0,u=0,c=0;o&&(p=o.eval({})||0),i&&(l=i.eval({})||0),s&&(u=s.eval({})||0),a&&(c=a.eval({})||0),t["x_"+n]=p,t["y_"+n]=l,t["x_"+r]=u,t["y_"+r]=c},this),i.each(i.where(e,{type:"function"}),function(e){t[e.options.funcName]=e.options.value}),t},_getInitialFunctions:function(e){return i.map(i.where(e,{type:"function"}),function(e){return e.options.funcName})},componentWillReceiveProps:function(e){this.setState({variables:this._getInitialVariables(e.elements),functions:this._getInitialFunctions(e.elements)})},_setupGraphie:function(e,t){if(e.graphInit(i.extend({},t,{grid:i.contains(["graph","grid"],this.props.graph.markings),axes:i.contains(["graph"],this.props.graph.markings),ticks:i.contains(["graph"],this.props.graph.markings),labels:i.contains(["graph"],this.props.graph.markings),labelFormat:function(e){return"\\small{"+e+"}"},axisArrows:"<->",unityLabels:!1})),"graph"===this.props.graph.markings){var n=this.props.graph.labels,r=this.props.graph.range;e.label([0,r[1][1]],n[1],"above"),e.label([r[0][1],0],n[0],"right")}},_updatePointLocation:function(e,t){var n=i.clone(this.state.variables);n["x_"+e]=t[0],n["y_"+e]=t[1],this.setState({variables:n}),this.props.trackInteraction()},_updateLineLocation:function(e,t){var n=this._eval("("+e.endX+")-("+e.startX+")"),r=this._eval("("+e.endY+")-("+e.startY+")"),o=m.add(t,[n,r]),s=i.clone(this.state.variables);s["x_"+e.startSubscript]=t[0],s["y_"+e.startSubscript]=t[1],s["x_"+e.endSubscript]=o[0],s["y_"+e.endSubscript]=o[1],this.setState({variables:s}),this.props.trackInteraction()},_eval:function(e,t){var n=this,r=P(e,{functions:this.state.functions}),o=i.extend({},this.state.variables,t);return i.each(i.keys(o),function(e){if(i.isString(o[e])){var t=P(o[e],{functions:n.state.functions});o[e]=function(e){return t(i.extend({},o,{x:e}))}}}),r(o)||0},_extractVars:function(e){if(null==e)return[];var t=[];return i.each(e.args(),function(e){e&&"Expr"===e.constructor.name&&(t=t.concat(this._extractVars(e)))},this),"Var"===e.name()&&t.push(e.prettyPrint()),t},change:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.change.apply(this,t)},render:function(){return o.createElement(a,{box:this.props.graph.box,range:this.props.graph.range,options:this.props.graph,setup:this._setupGraphie,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable},i.map(this.props.elements,function(e,t){var n=this;if("point"===e.type)return o.createElement(f,{key:e.key,coord:[this._eval(e.options.coordX),this._eval(e.options.coordY)],color:e.options.color});if("line"===e.type){var r=[this._eval(e.options.startX),this._eval(e.options.startY)],s=[this._eval(e.options.endX),this._eval(e.options.endY)];return o.createElement(l,{key:e.key,start:r,end:s,style:{stroke:e.options.color,strokeWidth:e.options.strokeWidth,strokeDasharray:e.options.strokeDasharray,arrows:e.options.arrows}})}if("movable-point"===e.type){var a=[function(t){return[Math.max(n._eval(e.options.constraintXMin),Math.min(n._eval(e.options.constraintXMax),t[0])),Math.max(n._eval(e.options.constraintYMin),Math.min(n._eval(e.options.constraintYMax),t[1]))]}];return"snap"===e.options.constraint?a.push(u.constraints.snap(e.options.snap)):"x"===e.options.constraint?a.push(function(t){return[n._eval(e.options.constraintFn,{y:t[1]}),t[1]]}):"y"===e.options.constraint&&a.push(function(t){return[t[0],n._eval(e.options.constraintFn,{x:t[0]})]}),o.createElement(u,{key:e.key,coord:[this.state.variables["x_"+e.options.varSubscript],this.state.variables["y_"+e.options.varSubscript]],constraints:a,foo_x:e.options.constraint,foo_y:e.options.constraintFn,foo_z:e.options.snap,onMove:i.partial(this._updatePointLocation,e.options.varSubscript)})}if("movable-line"===e.type){var a=[function(t){return[Math.max(n._eval(e.options.constraintXMin),Math.min(n._eval(e.options.constraintXMax),t[0])),Math.max(n._eval(e.options.constraintYMin),Math.min(n._eval(e.options.constraintYMax),t[1]))]}];"snap"===e.options.constraint?a.push(u.constraints.snap(e.options.snap)):"x"===e.options.constraint?a.push(function(t){return[n._eval(e.options.constraintFn,{y:t[1]}),t[1]]}):"y"===e.options.constraint&&a.push(function(t){return[t[0],n._eval(e.options.constraintFn,{x:t[0]})]});var r=[this.state.variables["x_"+e.options.startSubscript],this.state.variables["y_"+e.options.startSubscript]],s=[this.state.variables["x_"+e.options.endSubscript],this.state.variables["y_"+e.options.endSubscript]];return o.createElement(c,{key:e.key,constraints:a,onMove:i.bind(this._updateLineLocation,this,e.options),foo_x:e.options.constraint,foo_y:e.options.constraintFn,foo_z:e.options.snap},o.createElement(u,{coord:r,static:!0,normalStyle:{stroke:"none",fill:"none"}}),o.createElement(u,{coord:s,static:!0,normalStyle:{stroke:"none",fill:"none"}}))}if("function"===e.type){var m=function(t){return n._eval(e.options.value,{x:t})},y=i.without(this._extractVars(b(e.options.value).expr),"x"),v=i.object(y,i.map(y,function(e){return n.state.variables[e]})),T=[this._eval(e.options.rangeMin,this.state.variables),this._eval(e.options.rangeMax,this.state.variables)];return o.createElement(h,{key:e.key,fn:m,foo_fn:e.options.value,foo_varvalues:v,range:T,style:{stroke:e.options.color,strokeWidth:e.options.strokeWidth,strokeDasharray:e.options.strokeDasharray,plotPoints:100}})}if("parametric"===e.type){var m=function(t){return[n._eval(e.options.x,{t:t}),n._eval(e.options.y,{t:t})]},y=i.without(this._extractVars(b(e.options.x).expr).concat(this._extractVars(b(e.options.y).expr)),"t"),v=i.object(y,i.map(y,function(e){return n.state.variables[e]})),T=[this._eval(e.options.rangeMin,this.state.variables),this._eval(e.options.rangeMax,this.state.variables)];return o.createElement(d,{key:e.key,fn:m,foo_fnx:e.options.x,foo_fny:e.options.y,foo_varvalues:v,range:T,style:{stroke:e.options.color,strokeWidth:e.options.strokeWidth,strokeDasharray:e.options.strokeDasharray,plotPoints:100}})}if("label"===e.type){var P=[this._eval(e.options.coordX),this._eval(e.options.coordY)];return o.createElement(p,{key:t+1,coord:P,text:e.options.label,style:{color:e.options.color}})}return"rectangle"===e.type?o.createElement(g,{key:t+1,x:this._eval(e.options.coordX),y:this._eval(e.options.coordY),width:i.max([this._eval(e.options.width),0]),height:i.max([this._eval(e.options.height),0]),style:{stroke:"none",fill:e.options.color}}):void 0},this))},getUserInput:function(){return{}},simpleValidate:function(e){return C.validate(this.getUserInput(),e)}});i.extend(C,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),e.exports={name:"interaction",displayName:"Interaction",widget:C,transform:i.identity,hidden:!0}}).call(t,n(146))},696:function(e,t,n){(function(t,r){function o(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1])}function i(e,t,n){return B(o(e,t,n),0)}function s(e){return B(e,0)?0:e>0?1:-1}function a(e,t){return null==e?t:e}function p(e,t,n){return n[0]<=Math.max(e[0],t[0])&&n[0]>=Math.min(e[0],t[0])&&n[1]<=Math.max(e[1],t[1])&&n[1]>=Math.min(e[1],t[1])}function l(e,t){var n=[[e[0],e[1],t[0]],[e[0],e[1],t[1]],[t[0],t[1],e[0]],[t[0],t[1],e[1]]],r=k.map(n,function(e){return s(o.apply(null,e))});if(r[0]!==r[1]&&r[2]!==r[3])return!0;for(var i=0;i<4;i++)if(0===r[i]&&p.apply(null,n[i]))return!0;return!1}function u(e,t){return k.map(k.zip(e,t),function(e){return e[0]-e[1]})}function c(e){return Math.sqrt(k.reduce(e,function(e,t){return e+Math.pow(t,2)},0))}function h(e,t){return k.reduce(k.zip(e,t),function(e,t){return e+t[0]*t[1]},0)}function d(e){var t=k.zip(e,b(e));return k.map(t,function(e){return c(u.apply(null,e))})}function f(e){var t=k.zip(b(e,-1),e,b(e,1)),n=k.map(t,function(e){var t=u(e[1],e[0]),n=u(e[2],e[1]),r=Math.acos(h(t,n)/(c(t)*c(n)));return s(o.apply(null,e))>0?r:-r}),r=k.reduce(n,function(e,t){return e+t},0);return k.map(n,function(e){return r>0?Math.PI-e:Math.PI+e})}function g(e,t,n){if(e.length!==t.length)return!1;for(var r=e.length,o=f(e),i=f(t),s=d(e),a=d(t),p=0;p<2*r;p++){var l=i.slice(),u=a.slice();if(p>=r&&(l.reverse(),u.reverse(),u=b(u,1)),l=b(l,p),u=b(u,p),V(o,l)){var c=k.zip(s,u),h=k.map(c,function(e){return e[0]/e[1]}),g=k.all(h,function(e){return B(h[0],e)}),m=k.all(c,function(e){return O.equal(e[0],e[1],n)});if(g&&m)return!0}}return!1}function m(e,t){return e<t||B(e,t)}function y(e,t,n){return 180*Math.acos((e*e+t*t-n*n)/(2*e*t))/Math.PI}function v(e){var t=e[0],n=e[1],r=e[2],o=e[3];t<0&&(t*=-1,n*=-1,r*=-1);var i=2*Math.PI;for(n<0&&(n*=-1,r*=-1,r+=i/2);r>0;)r-=i;for(;r<0;)r+=i;return[t,n,r,o]}function b(e,t){return t=void 0===t?1:t%e.length,e.slice(t).concat(e.slice(0,t))}function T(e){return e.replace(/(?:^|-)(.)/g,function(e,t){return t.toUpperCase()})}function P(e,t){if(B(e[0],t[0]))return"x = "+e[0].toFixed(3);var n=(t[1]-e[1])/(t[0]-e[0]),r=e[1]-n*e[0];return"y = "+n.toFixed(3)+"x + "+r.toFixed(3)}function x(e,t){var n=e[0][0],r=e[0][1],o=e[1][0],i=e[1][1],s=t[0][0],a=t[0][1],p=t[1][0],l=t[1][1],u=(n-o)*(a-l)-(r-i)*(s-p);if(Math.abs(u)<1e-9)return"Lines are parallel";var c=((n*i-r*o)*(s-p)-(n-o)*(s*l-a*p))/u,h=((n*i-r*o)*(a-l)-(r-i)*(s*l-a*p))/u;return"Intersection: ("+c.toFixed(3)+", "+h.toFixed(3)+")"}function C(e,t){return Math.floor((e[1]-e[0])/t)}var w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},E=n(0),k=n(1),S=n(674),M=n(675),I=n(243),_=n(671),R=n(19),O=n(9).number,N=n(9).point,A=n(42),D=n(144),F=n(24),L=(F.interactiveSizes,n(244)),H=L.containerSizeClassPropType,U=L.getInteractiveBoxFromSizeClass,z=n(93),q=R.DeprecationMixin,G={url:null},B=R.eq,V=R.deepEq,W={showGraph:function(e){return{markings:e.showGraph?"graph":"none"}}},j=E.createClass({displayName:"InteractiveGraph",propTypes:{containerSizeClass:H.isRequired,trackInteraction:E.PropTypes.func.isRequired},getInitialState:function(){return{shouldShowInstructions:this._getShouldShowInstructions()}},getDefaultProps:function(){return{labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],backgroundImage:G,markings:"graph",showTooltips:!1,showProtractor:!1,showRuler:!1,rulerLabel:"",rulerTicks:10,graph:{type:"linear"}}},deprecatedProps:W,componentWillMount:function(){q.componentWillMount.call(this)},_getShouldShowInstructions:function(e){return e=e||this.props,this.isClickToAddPoints(e)&&(null==e.graph.coords||0===e.graph.coords.length)},componentDidUpdate:function(e,t){var n=e.graph.type,r=this.props.graph.type;n===r&&e.graph.allowReflexAngles===this.props.graph.allowReflexAngles&&e.graph.angleOffsetDeg===this.props.graph.angleOffsetDeg&&e.graph.numPoints===this.props.graph.numPoints&&e.graph.numSides===this.props.graph.numSides&&e.graph.numSegments===this.props.graph.numSegments&&e.graph.showAngles===this.props.graph.showAngles&&e.graph.showSides===this.props.graph.showSides&&e.graph.snapTo===this.props.graph.snapTo&&e.graph.snapDegrees===this.props.graph.snapDegrees||(this["remove"+T(n)+"Controls"](),this["add"+T(r)+"Controls"]()),this.shouldResetGraphie&&this.resetGraphie()},render:function(){var e,n,r=this;if(this.props.flexibleType)if(e=E.createElement("select",{value:this.props.graph.type,onChange:function(e){var t=e.target.value;r.onChange({graph:{type:t}})}},E.createElement("option",{value:"linear"},"Linear function"),E.createElement("option",{value:"quadratic"},"Quadratic function"),E.createElement("option",{value:"sinusoid"},"Sinusoid function"),E.createElement("option",{value:"circle"},"Circle"),E.createElement("option",{value:"point"},"Point(s)"),E.createElement("option",{value:"linear-system"},"Linear System"),E.createElement("option",{value:"polygon"},"Polygon"),E.createElement("option",{value:"segment"},"Line Segment(s)"),E.createElement("option",{value:"ray"},"Ray"),E.createElement("option",{value:"angle"},"Angle")),"point"===this.props.graph.type)n=E.createElement("select",{key:"point-select",value:this.props.graph.numPoints||1,onChange:function(e){var t=+e.target.value||e.target.value;r.onChange({graph:{type:"point",numPoints:t,coords:null}})}},k.map(k.range(1,7),function(e){return E.createElement("option",{value:e},e," point",e>1&&"s")}),E.createElement("option",{value:"unlimited"},"unlimited"));else if("polygon"===this.props.graph.type)n=E.createElement("div",null,E.createElement("div",null,E.createElement("select",{key:"polygon-select",value:this.props.graph.numSides||3,onChange:function(e){var t=+e.target.value||e.target.value,n=k.extend({},r.props.graph,{numSides:t,coords:null,snapTo:"grid"});r.onChange({graph:n})}},k.map(k.range(3,13),function(e){return E.createElement("option",{value:e},e," sides")}),E.createElement("option",{value:"unlimited"},"unlimited sides"))),E.createElement("div",null,E.createElement("label",null," Snap to"," ",E.createElement("select",{key:"polygon-snap",value:this.props.graph.snapTo,onChange:function(e){var t=k.extend({},r.props.graph,{snapTo:e.target.value,coords:null});r.onChange({graph:t})}},E.createElement("option",{value:"grid"},"grid"),"unlimited"!==this.props.graph.numSides&&[E.createElement("option",{value:"angles"}," ","interior angles"," "),E.createElement("option",{value:"sides"}," ","side measures"," ")])),E.createElement(M,null,E.createElement("p",null,"These options affect the movement of the vertex points. The grid option will guide the points to the nearest half step along the grid."),E.createElement("p",null,"The interior angle and side measure options guide the points to the nearest whole angle or side")," measure respectively."," ")),E.createElement("div",null,E.createElement("label",null,"Show angle measures:"," ",E.createElement("input",{type:"checkbox",checked:this.props.graph.showAngles,onChange:this.toggleShowAngles})),E.createElement(M,null,E.createElement("p",null,"Displays the interior angle measures."))),E.createElement("div",null,E.createElement("label",null,"Show side measures:"," ",E.createElement("input",{type:"checkbox",checked:this.props.graph.showSides,onChange:this.toggleShowSides})),E.createElement(M,null,E.createElement("p",null,"Displays the side lengths."))));else if("segment"===this.props.graph.type)n=E.createElement("select",{key:"segment-select",value:this.props.graph.numSegments||1,onChange:function(e){var t=+e.target.value;r.onChange({graph:{type:"segment",numSegments:t,coords:null}})}},k.map(k.range(1,7),function(e){return E.createElement("option",{value:e},e," segment",e>1&&"s")}));else if("angle"===this.props.graph.type){var o=a(this.props.graph.allowReflexAngles,!0);n=E.createElement("div",null,E.createElement("div",null,E.createElement("label",null,"Show angle measure:"," ",E.createElement("input",{type:"checkbox",checked:this.props.graph.showAngles,onChange:this.toggleShowAngles}))),E.createElement("div",null,E.createElement("label",null,"Allow reflex angles:"," ",E.createElement("input",{type:"checkbox",checked:o,onChange:function(e){r.onChange({graph:k.extend({},r.props.graph,{allowReflexAngles:!o,coords:null})})}})),E.createElement(M,null,E.createElement("p",null,"Reflex angles are angles with a measure greater than 180 degrees."),E.createElement("p",null,"By default, these should remain enabled."))),E.createElement("div",null,E.createElement("label",null,"Snap to increments of"," ",E.createElement(_,{key:"degree-snap",placeholder:1,value:this.props.graph.snapDegrees,onChange:function(e){r.onChange({graph:k.extend({},r.props.graph,{snapDegrees:Math.abs(e),coords:null})})}})," ","degrees"," ")),E.createElement("div",null,E.createElement("label",null," ","With an offset of"," ",E.createElement(_,{key:"angle-offset",placeholder:0,value:this.props.graph.angleOffsetDeg,onChange:function(e){r.onChange({graph:k.extend({},r.props.graph,{angleOffsetDeg:e,coords:null})})}})," ","degrees"," ")))}var i,s=U(this.props.containerSizeClass);this.isClickToAddPoints()&&this.state.shouldShowInstructions?"point"===this.props.graph.type?i=t._("Click to add points"):"polygon"===this.props.graph.type&&(i=t._("Click to add vertices")):i=void 0;var p=this.isClickToAddPoints()?this.handleAddPointsMouseDown:null,l=this.props.gridStep||R.getGridStep(this.props.range,this.props.step,s[0]),u=this.props.snapStep||R.snapStepFromGridStep(l),c=this.props.apiOptions.isMobile;return E.createElement("div",{className:"perseus-widget perseus-widget-interactive-graph",style:{width:s[0],height:this.props.flexibleType?"auto":s[1]}},E.createElement(S,{instructions:i,ref:"graph",box:s,labels:this.props.labels,range:this.props.range,step:c?R.constrainedTickStepsFromTickSteps(this.props.step,this.props.range):this.props.step,gridStep:l,snapStep:u,markings:this.props.markings,backgroundImage:this.props.backgroundImage,showProtractor:this.props.showProtractor,showRuler:this.props.showRuler,rulerLabel:this.props.rulerLabel,rulerTicks:this.props.rulerTicks,onMouseDown:p,onGraphieUpdated:this.setGraphie,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable,isMobile:c}),e,n)},componentDidMount:function(){this.setGraphie(this.refs.graph.graphie())},setGraphie:function(e){this.graphie=e,this.setupGraphie()},handleAddPointsMouseDown:function(e){if(!this.isClickToAddPoints())throw new Error("handleAddPointsClick should not be registeredwhen isClickToAddPoints() is false");if(!this.isCoordInTrash(e)){var t;if("point"===this.props.graph.type){if(t=this.createPointForPointsType(e,this.points.length),!t.constrain())return void t.remove();this.points.push(t);var n=this.points.length-1;this.points[n].grab(e),this.updateCoordsFromPoints()}else if("polygon"===this.props.graph.type){if(this.polygon.closed())return;t=this.createPointForPolygonType(e,this.points.length),this.points.push(t);var n=this.points.length-1;this.points[n].grab(e),this.updatePolygon()}this.setState({shouldShowInstructions:!1})}},resetGraphie:function(){this.shouldResetGraphie=!1,this.parabola=null,this.sinusoid=null,this.refs.graph.reset()},setupGraphie:function(){this.setTrashCanVisibility(0),this.isClickToAddPoints()&&this.setTrashCanVisibility(.5),this.props.apiOptions.isMobile&&(this.horizHairline=new z(this.graphie,[0,0],[0,0],{normalStyle:{strokeWidth:1}}),this.horizHairline.attr({stroke:A.INTERACTIVE}),this.horizHairline.hide(),this.vertHairline=new z(this.graphie,[0,0],[0,0],{normalStyle:{strokeWidth:1}}),this.vertHairline.attr({stroke:A.INTERACTIVE}),this.vertHairline.hide()),this["add"+T(this.props.graph.type)+"Controls"]()},showHairlines:function(e){this.props.apiOptions.isMobile&&"none"!==this.props.markings&&(this.horizHairline.moveTo([this.props.range[0][0],e[1]],[this.props.range[0][1],e[1]]),this.horizHairline.show(),this.vertHairline.moveTo([e[0],this.props.range[1][0]],[e[0],this.props.range[1][1]]),this.vertHairline.show())},hideHairlines:function(){this.props.apiOptions.isMobile&&(this.horizHairline.hide(),this.vertHairline.hide())},setTrashCanVisibility:function(e){var t=this.graphie;O.equal(e,0)?this.trashCan&&(this.trashCan.remove(),this.trashCan=null):this.props.apiOptions.isMobile||(this.trashCan||(this.trashCan=t.raphael.image("https://ka-perseus-graphie.s3.amazonaws.com/b1452c0d79fd0f7ff4c3af9488474a0a0decb361.png",t.xpixels-40,t.ypixels-40,40,40)),this.trashCan.attr({opacity:e}))},componentWillReceiveProps:function(e){this.isClickToAddPoints()!==this.isClickToAddPoints(e)&&(this.shouldResetGraphie=!0,this.setState({shouldShowInstructions:this._getShouldShowInstructions(e)})),this.props.backgroundImage.url===e.backgroundImage.url&&this.props.backgroundImage===e.backgroundImage&&this.props.containerSizeClass===e.containerSizeClass||(this.shouldResetGraphie=!0)},isClickToAddPoints:function(e){return e=e||this.props,"point"===e.graph.type&&"unlimited"===e.graph.numPoints||"polygon"===e.graph.type&&"unlimited"===e.graph.numSides},_lineStroke:function(){return this.props.isMobile?{"stroke-width":3}:{}},addLine:function(e){var t=this,n=this,r=n.graphie,o=j.getLineCoords(n.props.graph,n.props),i=n.points=k.map(o,function(e){return I.addMaybeMobileMovablePoint(t,{coord:e,constraints:[I.MovablePoint.constraints.bound(),I.MovablePoint.constraints.snap()],onMove:function(){var e=k.extend({},n.props.graph,{coords:k.invoke(i,"coord")});n.onChange({graph:e})}})}),s={points:i,static:!0,normalStyle:w({stroke:this.props.apiOptions.isMobile?A.BLUE_C:A.INTERACTIVE},this._lineStroke())};"line"===e?s.extendLine=!0:"ray"===e&&(s.extendRay=!0);n.line=I.addMovableLine(r,s);i[0].listen("constraints","isLine",function(e){return!N.equal(e,i[1].coord())}),i[1].listen("constraints","isLine",function(e){return!N.equal(e,i[0].coord())})},removeLine:function(){k.invoke(this.points,"remove"),this.line.remove()},addLinearControls:function(){this.addLine("line")},removeLinearControls:function(){this.removeLine()},addQuadraticControls:function(){var e=this,t=(this.graphie,this.props.graph.coords);t||(t=j.defaultQuadraticCoords(this.props));var n,r,o,i=function(){var t=k.extend({},e.props.graph,{coords:[n.coord(),r.coord(),o.coord()]});e.onChange({graph:t}),e.updateQuadratic()};n=this.pointA=I.addMaybeMobileMovablePoint(this,{coord:t[0],constraints:[I.MovablePoint.constraints.bound(),I.MovablePoint.constraints.snap(),function(e){return!n||e[0]!==r.coord()[0]&&e[0]!==o.coord()[0]}],onMove:i}),r=this.pointB=I.addMaybeMobileMovablePoint(this,{coord:t[1],constraints:[I.MovablePoint.constraints.bound(),I.MovablePoint.constraints.snap(),function(e){return!r||e[0]!==n.coord()[0]&&e[0]!==o.coord()[0]}],onMove:i}),o=this.pointC=I.addMaybeMobileMovablePoint(this,{coord:t[2],constraints:[I.MovablePoint.constraints.bound(),I.MovablePoint.constraints.snap(),function(e){return!o||e[0]!==n.coord()[0]&&e[0]!==r.coord()[0]}],onMove:i}),this.updateQuadratic()},updateQuadratic:function(){var e=j.getCurrentQuadraticCoefficients(this.props);if(e){var t=e[0],n=e[1],r=e[2];if(this.parabola){var o=this.graphie.svgParabolaPath(t,n,r);this.parabola.attr({path:o})}else this.parabola=this.graphie.parabola(t,n,r),this.parabola.attr(w({stroke:this.props.apiOptions.isMobile?A.BLUE_C:A.DYNAMIC},this._lineStroke())),this.parabola.toBack()}},removeQuadraticControls:function(){this.pointA.remove(),this.pointB.remove(),this.pointC.remove(),this.parabola&&(this.parabola.remove(),this.parabola=null)},addSinusoidControls:function(){var e=this,t=(this.graphie,this.props.graph.coords);t||(t=j.defaultSinusoidCoords(this.props));var n,r,o=function(){var t=k.extend({},e.props.graph,{coords:[n.coord(),r.coord()]});e.onChange({graph:t}),e.updateSinusoid()};n=this.pointA=I.addMaybeMobileMovablePoint(this,{coord:t[0],constraints:[I.MovablePoint.constraints.bound(),I.MovablePoint.constraints.snap(),function(e){return!n||e[0]!==r.coord()[0]}],onMove:o}),r=this.pointB=I.addMaybeMobileMovablePoint(this,{coord:t[1],constraints:[I.MovablePoint.constraints.bound(),I.MovablePoint.constraints.snap(),function(e){return!n||e[0]!==n.coord()[0]}],onMove:o}),this.updateSinusoid()},updateSinusoid:function(){var e=j.getCurrentSinusoidCoefficients(this.props);if(e){var t=e[0],n=e[1],r=e[2],o=e[3];if(this.sinusoid){var i=this.graphie.svgSinusoidPath(t,n,r,o);this.sinusoid.attr({path:i})}else this.sinusoid=this.graphie.sinusoid(t,n,r,o),this.sinusoid.attr(w({stroke:this.props.apiOptions.isMobile?A.BLUE_C:A.DYNAMIC},this._lineStroke())),this.sinusoid.toBack()}},removeSinusoidControls:function(){this.pointA.remove(),this.pointB.remove(),this.sinusoid&&(this.sinusoid.remove(),this.sinusoid=null)},addCircleControls:function(){var e=this,t=this.graphie,n=k.min(t.snap),o=this.circle=t.addCircleGraph({center:this.props.graph.center||[0,0],radius:this.props.graph.radius||k.min(this.props.step),snapX:t.snap[0],snapY:t.snap[1],minRadius:n,snapRadius:n});r(o).on("move",function(){var t=k.extend({},e.props.graph,{center:o.center,radius:o.radius});e.onChange({graph:t})})},removeCircleControls:function(){this.circle.remove()},addLinearSystemControls:function(){var e=this,t=this.graphie,n=j.getLinearSystemCoords(this.props.graph,this.props),r=[A.INTERACTIVE,A.GREEN],o=this.points=k.map(n,function(t,n){var o=k.map(t,function(t,i){return I.addMaybeMobileMovablePoint(e,{coord:t,constraints:[I.MovablePoint.constraints.bound(),I.MovablePoint.constraints.snap(),function(e){if(o)return!N.equal(e,o[1-i].coord())}],onMove:function(){var t=k.extend({},e.props.graph,{coords:k.map(e.points,function(e){return k.invoke(e,"coord")})});e.onChange({graph:t})},normalStyle:{fill:r[n]},highlightStyle:{fill:r[n]}})});return o});this.lines=k.map(o,function(e,n){return I.addMovableLine(t,{points:e,static:!0,extendLine:!0,normalStyle:{stroke:r[n]}})})},removeLinearSystemControls:function(){k.invoke(this.lines,"remove"),k.map(this.points,function(e){return k.invoke(e,"remove")})},isCoordInTrash:function(e){if(this.props.apiOptions.isMobile)return!1;var t=this.graphie,n=t.scalePoint(e);return n[0]>=t.xpixels-40&&n[1]>=t.ypixels-40},createPointForPointsType:function(e,t){var n=this,r=(n.graphie,function(){n.points=k.filter(n.points,function(e){return e!==o}),n.updateCoordsFromPoints(),setTimeout(o.remove.bind(o),0)}),o=I.addMaybeMobileMovablePoint(this,w({coord:e,constraints:[I.MovablePoint.constraints.bound(),I.MovablePoint.constraints.snap(),function(e){return k.all(n.points,function(t){return o===t||!N.equal(e,t.coord())})}],onMoveStart:function(){n.isClickToAddPoints()&&n.setTrashCanVisibility(1)},onMove:n.updateCoordsFromPoints,onMoveEnd:function(e){n.isClickToAddPoints()&&(n.isCoordInTrash(e)&&r(),n.setTrashCanVisibility(.5))}},this.props.apiOptions.isMobile&&n.isClickToAddPoints()?{onRemove:r}:{}));return o},removePoint:function(e){var t=null;return this.points=k.filter(this.points,function(n,r){return n!==e||(t=r,!1)}),t},createPointForPolygonType:function(e,t){var n=this,r=(this.graphie,!k.contains(["angles","sides"],this.props.graph.snapTo)),a=function(e){return(t+e+n.points.length)%n.points.length},p=function(){var e=n.removePoint(g);n.polygon.closed()&&(n.points=b(n.points,e),n.polygon.update({closed:!1})),n.updatePolygon(),n.clearCoords(),setTimeout(g.remove.bind(g),0)},h=function(e){if(n.isClickToAddPoints()){if(n.isCoordInTrash(e))p();else if(n.points.length>1&&(g===n.points[0]&&N.equal(e,k.last(n.points).coord())||g===k.last(n.points)&&N.equal(e,n.points[0].coord()))){var t=n.points.pop();n.points.length>2?(n.polygon.update({closed:!0}),n.updateCoordsFromPoints()):(n.polygon.update({closed:!1}),n.clearCoords()),n.updatePolygon(),setTimeout(t.remove.bind(t),0)}else{var r=k.any(n.points,function(t){return t!==g&&N.equal(t.coord(),e)});r?(n.removePoint(g),n.points.length<3?(n.polygon.update({closed:!1}),n.clearCoords()):n.polygon.closed()&&n.updateCoordsFromPoints(),n.updatePolygon(),setTimeout(g.remove.bind(g),0)):g!==n.points[0]&&g!==k.last(n.points)||g.hasMoved()||g.state.isInitialMove||n.polygon.closed()||!(n.points.length>2)||(n.polygon.update({closed:!0}),n.updatePolygon(),n.updateCoordsFromPoints())}n.setTrashCanVisibility(.5)}g.state.isInitialMove=!1},d=function(e){if(null==n.points||0===n.points.length)return!0;var r=k.invoke(n.points,"coord");if(r[t]=e,!n.isClickToAddPoints()){if(i(r[a(-2)],r[a(-1)],r[t])||i(r[a(-1)],r[t],r[a(1)])||i(r[t],r[a(1)],r[a(2)]))return!1;var p=k.zip(r,b(r));if(n.points.length>3)for(var h=-1;h<=0;h++)for(var d=p[a(h)],g=k.without(p,d,p[a(h-1)],p[a(h+1)]),v=0;v<g.length;v++){var T=g[v];if(l(d,T))return!1}}if("angles"===n.props.graph.snapTo&&n.points.length>2){var P=k.map(f(r),function(e){return 180*e/Math.PI});k.each([-1,1],function(e){P[a(e)]=Math.round(P[a(e)])});var x=function(e,t,n){return(D.findAngle(r[a(e)],r[a(n)],r[a(t)])+360)%360},C=[P[a(-1)]-x(-2,-1,1),P[a(1)]-x(-1,1,2)];if(C[2]=180-(C[0]+C[1]),k.any(C,function(e){return m(e,1)}))return!1;var w=c(u(r[a(-1)],r[a(1)])),E=1===s(o(r[a(-1)],r[a(1)],r[t])),S=Math.sin(C[1]*Math.PI/180)/Math.sin(C[2]*Math.PI/180)*w,M=D.findAngle(r[a(1)],r[a(-1)]),I=n.graphie.polar(S,M+(E?1:-1)*C[0]);return n.graphie.addPoints(r[a(-1)],I)}if("sides"===n.props.graph.snapTo&&n.points.length>1){var _=k.map([[r[a(-1)],r[t]],[r[t],r[a(1)]],[r[a(-1)],r[a(1)]]],function(e){return c(u.apply(null,e))});if(k.each([0,1],function(e){_[e]=Math.round(_[e])}),m(_[1]+_[2],_[0])||m(_[0]+_[2],_[1])||m(_[0]+_[1],_[2]))return!1;var R=y(_[0],_[2],_[1]),M=D.findAngle(r[a(1)],r[a(-1)]),E=1===s(o(r[a(-1)],r[a(1)],r[t])),I=n.graphie.polar(_[0],M+(E?1:-1)*R);return n.graphie.addPoints(r[a(-1)],I)}return!0},g=I.addMaybeMobileMovablePoint(this,w({coord:e,constraints:[I.MovablePoint.constraints.bound(),r?I.MovablePoint.constraints.snap():null,d],onMoveStart:function(){n.isClickToAddPoints()&&n.setTrashCanVisibility(1)},onMove:function(){n.polygon.closed()&&n.updateCoordsFromPoints()},onMoveEnd:h},this.props.apiOptions.isMobile&&this.isClickToAddPoints()?{onRemove:p}:{}));return g.state.isInitialMove=!0,g},updateCoordsFromPoints:function(){var e=k.extend({},this.props.graph,{coords:k.map(this.points,function(e){return k.result(e,"coord")})});this.onChange({graph:e})},clearCoords:function(){var e=k.extend({},this.props.graph,{coords:null});this.onChange({graph:e})},onChange:function(e){this.props.onChange(e),this.props.trackInteraction()},addPointControls:function(){var e=j.getPointCoords(this.props.graph,this.props);this.points=[],this.points=k.map(e,this.createPointForPointsType,this)},removePointControls:function(){k.invoke(this.points,"remove")},addSegmentControls:function(){var e=this,t=this,n=this.graphie,r=j.getSegmentCoords(this.props.graph,this.props),o=function(t){return I.addMaybeMobileMovablePoint(e,t)};this.points=[],this.lines=k.map(r,function(e,r){var i=function(){var e=k.extend({},t.props.graph,{coords:k.invoke(t.lines,"coords")});t.onChange({graph:e})},s=k.map(e,function(e,t){return o({coord:e,constraints:[I.MovablePoint.constraints.bound(),I.MovablePoint.constraints.snap(),function(e){if(s)return!N.equal(e,s[1-t].coord())}],onMove:i})});t.points=t.points.concat(s);var a=I.addMovableLine(n,{points:s,static:!1,constraints:[I.MovableLine.constraints.bound(),I.MovableLine.constraints.snap()],onMove:[I.MovableLine.onMove.updatePoints,i],normalStyle:w({stroke:this.props.apiOptions.isMobile?A.BLUE_C:A.INTERACTIVE},this._lineStroke()),highlightStyle:w({stroke:this.props.apiOptions.isMobile?A.BLUE_C:A.INTERACTING},this._lineStroke())});return k.invoke(s,"toFront"),a},this)},removeSegmentControls:function(){k.invoke(this.points,"remove"),k.invoke(this.lines,"remove")},addRayControls:function(){this.addLine("ray")},removeRayControls:function(){this.removeLine()},addPolygonControls:function(){this.polygon=null;var e=j.getPolygonCoords(this.props.graph,this.props);this.points=[],this.points=k.map(e,this.createPointForPolygonType,this),this.updatePolygon()},updatePolygon:function(){var e;e=this.polygon?this.polygon.closed():this.points.length>=3;var t=this.graphie,n=this.points.length,r=!k.contains(["angles","sides"],this.props.graph.snapTo),o=k.times(n,function(t){return this.props.graph.showAngles&&(e||0!==t&&t!==n-1)?"angles"===this.props.graph.snapTo?"$deg0":"$deg1":""},this),i=k.times(n,function(t){return e||0!==t&&t!==n-1},this),s=k.times(n,function(t){return this.props.graph.showAngles&&(e||0!==t&&t!==n-1)?1:0},this),a=k.times(n,function(t){return!this.props.graph.showSides||!e&&t===n-1?"":"sides"===this.props.graph.snapTo?"$len0":"$len1"},this);if(null==this.polygon){var p=this;p.polygon=I.addMovablePolygon(t,{constraints:[I.MovablePolygon.constraints.bound(),r?I.MovablePolygon.constraints.snap():null],closed:e,points:p.points,angleLabels:o,showRightAngleMarkers:i,numArcs:s,sideLabels:a,onMove:[I.MovablePolygon.onMove.updatePoints,function(){this.closed()&&p.updateCoordsFromPoints()}],normalStyle:w({stroke:this.props.apiOptions.isMobile?A.BLUE_C:A.INTERACTIVE},this._lineStroke())})}else this.polygon.update({closed:e,points:this.points,angleLabels:o,showRightAngleMarkers:i,numArcs:s,sideLabels:a})},removePolygonControls:function(){k.invoke(this.points,"remove"),this.polygon.remove()},addAngleControls:function(){var e=this,t=this.graphie,n=j.getAngleCoords(this.props.graph,this.props);this.points=k.map(n,function(e,n){return t.addMovablePoint(k.extend({coord:e,normalStyle:{stroke:A.INTERACTIVE,fill:A.INTERACTIVE}},1===n?{snapX:t.snap[0],snapY:t.snap[1]}:{}))}),this.angle=t.addMovableAngle({points:this.points,snapDegrees:this.props.graph.snapDegrees||1,snapOffsetDeg:this.props.graph.angleOffsetDeg||0,angleLabel:this.props.graph.showAngles?"$deg0":"",pushOut:2,allowReflex:a(this.props.graph.allowReflexAngles,!0)}),r(this.angle).on("move",function(){var t=k.extend({},e.props.graph,{coords:e.angle.getClockwiseCoords()});e.onChange({graph:t})})},removeAngleControls:function(){k.invoke(this.points,"remove"),this.angle.remove()},toggleShowAngles:function(){var e=k.extend({},this.props.graph,{showAngles:!this.props.graph.showAngles});this.onChange({graph:e})},toggleShowSides:function(){var e=k.extend({},this.props.graph,{showSides:!this.props.graph.showSides});this.onChange({graph:e})},getUserInput:function(){return this.props.graph},simpleValidate:function(e){return j.validate(this.getUserInput(),e,this)},focus:r.noop});k.extend(j,{getQuadraticCoefficients:function(e){var t=e[0],n=e[1],r=e[2],o=(t[0]-n[0])*(t[0]-r[0])*(n[0]-r[0]);if(0!==o)return[(r[0]*(n[1]-t[1])+n[0]*(t[1]-r[1])+t[0]*(r[1]-n[1]))/o,(r[0]*r[0]*(t[1]-n[1])+n[0]*n[0]*(r[1]-t[1])+t[0]*t[0]*(n[1]-r[1]))/o,(n[0]*r[0]*(n[0]-r[0])*t[1]+r[0]*t[0]*(r[0]-t[0])*n[1]+t[0]*n[0]*(t[0]-n[0])*r[1])/o]},getSinusoidCoefficients:function(e){var t=e[0],n=e[1],r=n[1]-t[1],o=Math.PI/(2*(n[0]-t[0]));return[r,o,t[0]*o,t[1]]},getLineCoords:function(e,t){return e.coords||j.pointsFromNormalized(t,[[.25,.75],[.75,.75]])},getPointCoords:function(e,t){var n=e.numPoints||1,r=e.coords;if(r)return r;switch(n){case 1:r=[e.coord||[0,0]];break;case 2:r=[[-5,0],[5,0]];break;case 3:r=[[-5,0],[0,0],[5,0]];break;case 4:r=[[-6,0],[-2,0],[2,0],[6,0]];break;case 5:r=[[-6,0],[-3,0],[0,0],[3,0],[6,0]];break;case 6:r=[[-5,0],[-3,0],[-1,0],[1,0],[3,0],[5,0]];break;case"unlimited":r=[]}var o=[[-10,10],[-10,10]];r=j.normalizeCoords(r,o);var r=j.pointsFromNormalized(t,r);return r},getLinearSystemCoords:function(e,t){return e.coords||k.map([[[.25,.75],[.75,.75]],[[.25,.25],[.75,.25]]],function(e){return j.pointsFromNormalized(t,e)})},getPolygonCoords:function(e,t){var n=e.coords;if(n)return n;var r=e.numSides||3;if("unlimited"===r)n=[];else{var o=2*Math.PI/r,i=(1/r-.5)*Math.PI,s="sides"===e.snapTo?Math.sqrt(3)/3*7:4;n=k.times(r,function(e){return[s*Math.cos(e*o+i),s*Math.sin(e*o+i)]})}var a=[[-10,10],[-10,10]];n=j.normalizeCoords(n,a);var p=!k.contains(["angles","sides"],e.snapTo);return n=j.pointsFromNormalized(t,n,!p)},getSegmentCoords:function(e,t){var n=e.coords;if(n)return n;var r=e.numSegments||1,o={1:[5],2:[5,-5],3:[5,0,-5],4:[6,2,-2,-6],5:[6,3,0,-3,-6],6:[5,3,1,-1,-3,-5]}[r],i=[[-10,10],[-10,10]];return k.map(o,function(e){var n=[[-5,e],[5,e]];return n=j.normalizeCoords(n,i),n=j.pointsFromNormalized(t,n)})},getAngleCoords:function(e,t){var n=e.coords;if(n)return n;for(var r=e.snapDegrees||1,o=r;o<20;)o+=r;o=o*Math.PI/180;var i=(e.angleOffsetDeg||0)*Math.PI/180;n=j.pointsFromNormalized(t,[[.85,.5],[.5,.5]]);var s=c(u.apply(null,n));return n[0]=[n[1][0]+s*Math.cos(i),n[1][1]+s*Math.sin(i)],n[2]=[n[1][0]+s*Math.cos(o+i),n[1][1]+s*Math.sin(o+i)],n},normalizeCoords:function(e,t){return k.map(e,function(e){return k.map(e,function(e,n){var r=t[n][1]-t[n][0];return(e+t[n][1])/r})})},getEquationString:function(e){var t=e.graph.type,n="get"+T(t)+"EquationString";return j[n](e)},pointsFromNormalized:function(e,t,n){return k.map(t,function(t){return k.map(t,function(t,r){var o=e.range[r];if(n)return o[0]+(o[1]-o[0])*t;var i=e.step[r],s=C(o,i),a=Math.round(t*s);return o[0]+i*a})})},getLinearEquationString:function(e){var t=j.getLineCoords(e.graph,e);if(B(t[0][0],t[1][0]))return"x = "+t[0][0].toFixed(3);var n=(t[1][1]-t[0][1])/(t[1][0]-t[0][0]),r=t[0][1]-n*t[0][0];return B(n,0)?"y = "+r.toFixed(3):"y = "+n.toFixed(3)+"x + "+r.toFixed(3)},getCurrentQuadraticCoefficients:function(e){var t=e.graph.coords||j.defaultQuadraticCoords(e);return j.getQuadraticCoefficients(t)},defaultQuadraticCoords:function(e){var t=[[.25,.75],[.5,.25],[.75,.75]];return j.pointsFromNormalized(e,t)},getQuadraticEquationString:function(e){var t=j.getCurrentQuadraticCoefficients(e);return"y = "+t[0].toFixed(3)+"x^2 + "+t[1].toFixed(3)+"x + "+t[2].toFixed(3)},getCurrentSinusoidCoefficients:function(e){var t=e.graph.coords||j.defaultSinusoidCoords(e);return j.getSinusoidCoefficients(t)},defaultSinusoidCoords:function(e){var t=[[.5,.5],[.65,.6]];return j.pointsFromNormalized(e,t)},getSinusoidEquationString:function(e){var t=j.getCurrentSinusoidCoefficients(e);return"y = "+t[0].toFixed(3)+"sin("+t[1].toFixed(3)+"x - "+t[2].toFixed(3)+") + "+t[3].toFixed(3)},getCircleEquationString:function(e){var t=e.graph,n=t.center||[0,0];return"center ("+n[0]+", "+n[1]+"), radius "+(t.radius||2)},getLinearSystemEquationString:function(e){var t=j.getLinearSystemCoords(e.graph,e);return"\n"+P(t[0][0],t[0][1])+"\n"+P(t[1][0],t[1][1])+"\n"+x(t[0],t[1])},getPointEquationString:function(e){return j.getPointCoords(e.graph,e).map(function(e){return"("+e[0]+", "+e[1]+")"}).join(", ")},getSegmentEquationString:function(e){var t=j.getSegmentCoords(e.graph,e);return k.map(t,function(e){return"["+k.map(e,function(e){return"("+e.join(", ")+")"}).join(" ")+"]"}).join(" ")},getRayEquationString:function(e){var t=j.getLineCoords(e.graph,e),n=t[0],r=t[1],o=j.getLinearEquationString(e);return n[0]>r[0]?o+=" (for x <= "+n[0].toFixed(3)+")":n[0]<r[0]?o+=" (for x >= "+n[0].toFixed(3)+")":n[1]>r[1]?o+=" (for y <= "+n[1].toFixed(3)+")":o+=" (for y >= "+n[1].toFixed(3)+")",o},getPolygonEquationString:function(e){var t=j.getPolygonCoords(e.graph,e);return k.map(t,function(e){return"("+e.join(", ")+")"}).join(" ")},getAngleEquationString:function(e){var t=j.getAngleCoords(e.graph,e);return D.findAngle(t[2],t[0],t[1]).toFixed(0)+"° angle at ("+t[1].join(", ")+")"},validate:function(e,t,n){var r=!!(e.coords||e.center&&e.radius);if(e.type===t.correct.type&&r)if("linear"===e.type){var o=e.coords,s=t.correct.coords;if(i(s[0],s[1],o[0])&&i(s[0],s[1],o[1]))return{type:"points",earned:1,total:1,message:null}}else if("linear-system"===e.type){var o=e.coords,s=t.correct.coords;if(i(s[0][0],s[0][1],o[0][0])&&i(s[0][0],s[0][1],o[0][1])&&i(s[1][0],s[1][1],o[1][0])&&i(s[1][0],s[1][1],o[1][1])||i(s[0][0],s[0][1],o[1][0])&&i(s[0][0],s[0][1],o[1][1])&&i(s[1][0],s[1][1],o[0][0])&&i(s[1][0],s[1][1],o[0][1]))return{type:"points",earned:1,total:1,message:null}}else if("quadratic"===e.type){var a=this.getQuadraticCoefficients(e.coords),p=this.getQuadraticCoefficients(t.correct.coords);if(V(a,p))return{type:"points",earned:1,total:1,message:null}}else if("sinusoid"===e.type){var a=this.getSinusoidCoefficients(e.coords),p=this.getSinusoidCoefficients(t.correct.coords),l=v(a),u=v(p);if(V(l,u))return{type:"points",earned:1,total:1,message:null}}else if("circle"===e.type){if(V(e.center,t.correct.center)&&B(e.radius,t.correct.radius))return{type:"points",earned:1,total:1,message:null}}else if("point"===e.type){var o=e.coords,s=j.getPointCoords(t.correct,n);if(o=o.slice(),s=s.slice(),o.sort(),s.sort(),V(o,s))return{type:"points",earned:1,total:1,message:null}}else if("polygon"===e.type){var c,o=e.coords.slice(),s=t.correct.coords.slice();if("similar"===t.correct.match?c=g(o,s,Number.POSITIVE_INFINITY):"congruent"===t.correct.match?c=g(o,s,O.DEFAULT_TOLERANCE):"approx"===t.correct.match?c=g(o,s,.1):(o.sort(),s.sort(),c=V(o,s)),c)return{type:"points",earned:1,total:1,message:null}}else if("segment"===e.type){var o=e.coords.slice(),s=t.correct.coords.slice();if(o=k.invoke(o,"sort").sort(),s=k.invoke(s,"sort").sort(),V(o,s))return{type:"points",earned:1,total:1,message:null}}else if("ray"===e.type){var o=e.coords,s=t.correct.coords;if(V(o[0],s[0])&&i(s[0],s[1],o[1]))return{type:"points",earned:1,total:1,message:null}}else if("angle"===e.type){var c,o=e.coords,s=t.correct.coords;if("congruent"===t.correct.match){var h=k.map([o,s],function(e){return(D.findAngle(e[2],e[0],e[1])+360)%360});c=B.apply(null,h)}else c=V(o[1],s[1])&&i(s[1],s[0],o[0])&&i(s[1],s[2],o[2]);if(c)return{type:"points",earned:1,total:1,message:null}}return!r||k.isEqual(e,t.graph)?{type:"invalid",message:null}:{type:"points",earned:0,total:1,message:null}}}),e.exports={name:"interactive-graph",displayName:"Interactive graph",widget:j}}).call(t,n(23),n(10))},697:function(e,t,n){var r=n(6),o=r.StyleSheet,i=r.css,s=n(0),a={grayLight:"#aaa",basicBorderColor:"#ccc",white:"#fff"},p={borderBottom:"9px solid transparent",borderTop:"9px solid transparent",content:'" "',height:"0",position:"absolute",top:"0",width:"0"},l=o.create({infoTip:{display:"inline-block",marginLeft:"5px",position:"relative"},infoTipContainer:{position:"absolute",top:"-12px",left:"22px",zIndex:"1000"},infoTipTriangle:{height:"10px",left:"0",position:"absolute",top:"8px",width:"0",zIndex:"1",":before":Object.assign({},p,{borderRight:"9px solid #bbb",right:"0"}),":after":Object.assign({},p,{borderRight:"9px solid "+a.white,right:"-1px"})},verticalShadow:{border:"1px solid "+a.basicBorderColor,boxShadow:"0 1px 3px "+a.basicBorderColor,borderBottom:"1px solid "+a.grayLight},infoTipContentContainer:{background:a.white,padding:"5px 10px",width:"240px"}}),u=s.createClass({displayName:"InfoTip",propTypes:{children:s.PropTypes.node},getInitialState:function(){return{hover:!1}},handleMouseEnter:function(){this.setState({hover:!0})},handleMouseLeave:function(){this.setState({hover:!1})},render:function(){return s.createElement("div",{className:i(l.infoTip)},s.createElement("img",{width:10,height:10,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3NpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo2N2M3NTAxYS04YmVlLTQ0M2MtYmRiNS04OGM2N2IxN2NhYzEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUJCRTk4Qjc4NjAwMTFFMzg3QUJDNEI4Mzk2QTRGQkQiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUJCRTk4QjY4NjAwMTFFMzg3QUJDNEI4Mzk2QTRGQkQiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NGE5ZDI0OTMtODk1NC00OGFkLTlhMTgtZDAwM2MwYWNjNDJlIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjY3Yzc1MDFhLThiZWUtNDQzYy1iZGI1LTg4YzY3YjE3Y2FjMSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pqm89uYAAADMSURBVHjaXJA9DoJAEIUH1M4TUHIFsCMGen9OwCGw1YRGW2ntKel0exsojHIBC0ouQAyUviFDstmXfNmZeS+zm7XSNCXRFiRgJf0bXIHixpbhGdxBBJYC1w/xaA424MhNEATkui71fU9KqfEU78UbD9PdbJRlOdae55GmhIP+1NV1TcMwkOM41DSNHvRtMhTHMRVFQW3b6mOLgx99kue5GRp/gIOZuZGvNpTNwjD8oliANU+qqqKu6/TQBdymN57AHjzBT+B6Jx79BRgAvc49kQA4yxgAAAAASUVORK5CYII=",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave}),s.createElement("div",{className:i(l.infoTipContainer),style:{display:this.state.hover?"block":"none"}},s.createElement("div",{className:i(l.infoTipTriangle)}),s.createElement("div",{className:i(l.verticalShadow,l.infoTipContentContainer)},this.props.children)))}});e.exports=u},698:function(e,t,n){(function(t){var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(0),i=n(1),s=n(143),a=n(242),p={display:"table",tableLayout:"fixed"},l={display:"table-row"},u={display:"table-cell",padding:5},c={borderRadius:10,cursor:"pointer"},h={padding:5,display:"inline-block"},d={float:"right",paddingRight:5},f={plus:function(){return[[!1,!0,!1],[!0,!0,!0],[!1,!0,!1]]},x:function(){return[[!0,!1,!0],[!1,!0,!1],[!0,!1,!0]]},"plus/x":function(e){return e%2?f.x():f.plus()}},g=o.createClass({displayName:"Tile",propTypes:{value:o.PropTypes.bool.isRequired,size:o.PropTypes.number.isRequired},render:function(){var e=this.props.value?"#55dd55":"#115511",t=i.extend({},c,{width:this.props.size,height:this.props.size,backgroundColor:e});return o.createElement("div",{style:t,onClick:this._flip})},_flip:function(){this.props.onChange(!this.props.value)}}),m=o.createClass({displayName:"TileGrid",propTypes:{cells:o.PropTypes.arrayOf(o.PropTypes.arrayOf(o.PropTypes.bool)).isRequired,size:o.PropTypes.number.isRequired},render:function(){var e=this;return o.createElement("div",{style:p,className:"no-select"},i.map(this.props.cells,function(t,n){return o.createElement("div",{key:n,style:l},i.map(t,function(t,r){return o.createElement("div",{key:r,style:u},o.createElement(g,{value:t,size:e.props.size,onChange:i.partial(e.props.onChange,n,r)}))}))}))}}),y=function(e,t){return i.map(e,function(e,n){return i.map(e,function(e,r){return t(n,r)?!e:e})})},v=function(e,t,n,r){return y(e,function(e,o){var i=e-t,s=o-n;return Math.abs(i)<=1&&Math.abs(s)<=1&&r[i+1][s+1]})},b=o.createClass({displayName:"LightsPuzzle",propTypes:r({},s.propTypes,{cells:o.PropTypes.arrayOf(o.PropTypes.arrayOf(o.PropTypes.bool)),startCells:o.PropTypes.arrayOf(o.PropTypes.arrayOf(o.PropTypes.bool)),flipPattern:o.PropTypes.string.isRequired,moveCount:o.PropTypes.number.isRequired}),getDefaultProps:function(){return{cells:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],startCells:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],flipPattern:"plus",moveCount:0}},getUserInput:function(){return a.getUserInput.call(this)},render:function(){var e=this._width(),t=60*e;return o.createElement("div",null,o.createElement(m,{cells:this.props.cells,size:50,onChange:this._flipTile}),o.createElement("div",{style:{width:t}},o.createElement("div",{style:h},"Moves: ",this.props.moveCount),o.createElement("div",{style:d},o.createElement("input",{type:"button",value:"Reset",onClick:this._reset,className:"simple-button"}))),o.createElement("div",{className:"clearfix"}))},change:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.change.apply(this,t)},_width:function(){return 0!==this.props.cells.length?this.props.cells[0].length:0},componentDidMount:function(){this._initNextPatterns()},componentDidUpdate:function(e){e.flipPattern!==this.props.flipPattern&&this._initNextPatterns()},_initNextPatterns:function(){this._currPattern=f[this.props.flipPattern](0),this._nextPattern=f[this.props.flipPattern](1),this._patternIndex=2},_shiftPatterns:function(){this._currPattern=this._nextPattern,this._nextPattern=f[this.props.flipPattern](this._patternIndex),this._patternIndex++},_flipTile:function(e,t){var n=v(this.props.cells,e,t,this._currPattern);this._shiftPatterns(),this.change({cells:n,moveCount:this.props.moveCount+1})},_reset:function(){this.change({cells:this.props.startCells,moveCount:0})},simpleValidate:function(e){return T(e,this.getUserInput())}}),T=function(e,n){return i.all(n.cells,function(t,n){return i.all(t,function(t,r){return t===e.startCells[n][r]})})?{type:"invalid",message:t._("Click on the tiles to change the lights.")}:i.all(n.cells,function(e){return i.all(e,function(e){return e})})?{type:"points",earned:1,total:1,message:null}:e.gradeIncompleteAsWrong?{type:"points",earned:0,total:1,message:null}:{type:"invalid",message:t._("You must turn on all of the lights to continue.")}},P=function(e){return{cells:e.startCells,startCells:e.startCells,flipPattern:e.flipPattern}};e.exports={name:"lights-puzzle",displayName:"Lights Puzzle",hidden:!0,widget:b,transform:P}}).call(t,n(23))},699:function(e,t,n){(function(t){var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(21),i=n(0),s=n(8),a=n(1),p=n(671),l=n(32),u=n(248),c=n(240),h=n(145),d=n(13).Options,f=n(67),g=n(27).propTypes.keypadElementPropType,m=n(33).assert,y=n(19).stringArrayOfSize,v=n(22),b=v.linterContextProps,T=v.linterContextDefault,P={INPUT_MARGIN:4,INPUT_HEIGHT:38,INPUT_WIDTH:82},x={INPUT_MARGIN:3,INPUT_HEIGHT:30,INPUT_WIDTH:40},C={INPUT_MARGIN:4,INPUT_HEIGHT:36,INPUT_WIDTH:64},w=function(e,t){return[""+e,""+t]},E=function(){return w(0,0)},k=function(e){return m(a.isArray(e)&&2===e.length),+e[0]},S=function(e){return m(a.isArray(e)&&2===e.length),+e[1]},M=function(e){return"answer"+k(e)+","+S(e)},I=function(e){var t=[1,1];return a(e).each(function(e,n){var r=0;a(e).each(function(e,t){null!=e&&e.toString().length&&(r=t+1)}),t[1]=Math.max(t[1],r),r>0&&(t[0]=Math.max(t[0],n+1))}),t},_=i.createClass({displayName:"Matrix",propTypes:{answers:i.PropTypes.arrayOf(i.PropTypes.arrayOf(i.PropTypes.oneOfType([i.PropTypes.string,i.PropTypes.number]))),apiOptions:d.propTypes,cursorPosition:i.PropTypes.arrayOf(i.PropTypes.number),keypadElement:g,matrixBoardSize:i.PropTypes.arrayOf(i.PropTypes.number).isRequired,prefix:i.PropTypes.string,suffix:i.PropTypes.string,trackInteraction:i.PropTypes.func.isRequired,linterContext:b},getDefaultProps:function(){return{matrixBoardSize:[3,3],answers:[[]],prefix:"",suffix:"",cursorPosition:[0,0],apiOptions:d.defaults,linterContext:T}},getInitialState:function(){return{enterTheMatrix:0}},componentDidMount:function(){this.cursorPosition=[0,0]},render:function(){var e=this,t=void 0;t=this.props.apiOptions.customKeypad?C:this.props.apiOptions.staticRender?P:x;var n=t,s=n.INPUT_MARGIN,d=n.INPUT_HEIGHT,f=n.INPUT_WIDTH,g=I(this.props.answers),m=this.props.matrixBoardSize[0],y=this.props.matrixBoardSize[1],v=this.props.cursorPosition[0],b=this.props.cursorPosition[1],T=Math.max(v,g[0]-1),E=Math.max(b,g[1]-1),k=(T+1)*(d+2*s),S=(E+1)*(f+2*s),_=o({"perseus-matrix":!0,"static-mode":this.props.static,"the-matrix":this.state.enterTheMatrix>=5});return i.createElement("div",{className:_},this.props.prefix&&i.createElement("div",{className:"matrix-prefix"},i.createElement(l,{content:this.props.prefix,linterContext:this.props.linterContext})),i.createElement("div",{className:"matrix-input"},i.createElement("div",{className:"matrix-bracket bracket-left",style:{height:k}}),i.createElement("div",{className:"matrix-bracket bracket-right",style:{height:k,left:S}}),a(m).times(function(t){var n=e.props.answers[t];return i.createElement("div",{className:"matrix-row",key:t},a(y).times(function(o){var a=t>T||o>E,l={className:a?"outside":"inside",ref:M(w(t,o)),value:n?n[o]:null,style:{height:d,width:f,margin:s},disabled:e.props.apiOptions.readOnly,onFocus:function(){e.cursorPosition=[t,o],e.props.onChange({cursorPosition:[t,o]},function(){return!1}),e._handleFocus(t,o)},onBlur:function(){t===e.cursorPosition[0]&&o===e.cursorPosition[1]&&e.props.onChange({cursorPosition:[0,0]},function(){return!1}),e._handleBlur(t,o)},onKeyDown:function(n){e.handleKeyDown(t,o,n)},onChange:function(n,r){e.onValueChange(t,o,n,r)}},g=void 0;if(e.props.apiOptions.customKeypad){var m={margin:s,minWidth:f,minHeight:d,boxSizing:"border-box",backgroundColor:a?"#f3f3f3":"#fff"};g=i.createElement(h,r({},l,{style:m,scrollable:!0,keypadElement:e.props.keypadElement}))}else g=e.props.apiOptions.staticRender?i.createElement(c,l):e.props.numericInput?i.createElement(p,l):i.createElement(u,l);return i.createElement("span",{key:o,className:"matrix-input-field"},g)}))})),this.props.suffix&&i.createElement("div",{className:"matrix-suffix"},i.createElement(l,{content:this.props.suffix,linterContext:this.props.linterContext})))},getInputPaths:function(){var e=[],t=this.props.matrixBoardSize[0],n=this.props.matrixBoardSize[1];return a(t).times(function(t){a(n).times(function(n){var r=w(t,n);e.push(r)})}),e},getGrammarTypeForPath:function(e){return"number"},_handleFocus:function(e,t){this.props.onFocus(w(e,t))},_handleBlur:function(e,t){this.props.onBlur(w(e,t))},focus:function(){return this.focusInputPath(E()),!0},focusInputPath:function(e){var t=M(e);this.refs[t].focus()},blurInputPath:function(e){0===e.length&&(e=E());var t=M(e);this.refs[t].blur()},getDOMNodeForPath:function(e){var t=M(e);return s.findDOMNode(this.refs[t])},setInputValue:function(e,t,n){var r=k(e),o=S(e);this.onValueChange(r,o,t,n)},handleKeyDown:function(e,t,n){var r=this.props.matrixBoardSize[0],o=this.props.matrixBoardSize[1],i=null,s=this.refs[M(w(e,t))],a=s.getStringValue(),p=s.getSelectionStart(),l=s.getSelectionEnd(),u=null;if("ArrowUp"===n.key&&e>0?u=w(e-1,t):"ArrowDown"===n.key&&e+1<r?u=w(e+1,t):"ArrowLeft"===n.key&&t>0?0===p&&0===l&&(u=w(e,t-1)):"ArrowRight"===n.key&&t+1<o?p===a.length&&(u=w(e,t+1)):"Enter"===n.key?i=this.state.enterTheMatrix+1:"Escape"===n.key&&(i=0),u){n.preventDefault();var c=this.refs[M(u)],h=c.getStringValue(),d=2*h.length;c.focus(),"ArrowRight"===n.key?c.setSelectionRange(0,0):c.setSelectionRange(d,d)}null!=i&&this.setState({enterTheMatrix:i})},onValueChange:function(e,t,n,r){var o=a.map(this.props.answers,a.clone);o[e]||(o[e]=[]),o[e][t]=n,this.props.onChange({answers:o},r),this.props.trackInteraction()},getUserInput:function(){return{answers:this.props.answers}},simpleValidate:function(e){return _.validate(this.getUserInput(),e)}});a.extend(_,{validate:function(e,n){var r=n.answers,o=e.answers,i=I(r),s=I(o),p=i[0]!==s[0]||i[1]!==s[1],l=f.number.createValidatorFunctional,u=null,c=!1,h=!1;return a(s[0]).times(function(e){a(s[1]).times(function(t){null!=o[e][t]&&0!==o[e][t].toString().length||(c=!0);var n=l(r[e][t],{simplify:!0}),i=n(o[e][t]);i.message&&(u=i.message),i.correct||(h=!0)})}),c?{type:"invalid",message:t._("Make sure you fill in all cells in the matrix.")}:p?{type:"points",earned:0,total:1,message:null}:{type:"points",earned:h?0:1,total:1,message:u}}});var R=function(e){var t=a(e.matrixBoardSize[0]).times(function(){return y(e.matrixBoardSize[1])});return e=a.pick(e,"matrixBoardSize","prefix","suffix"),a.extend(e,{answers:t})},O=function(e){var t=a.pick(e,"matrixBoardSize","prefix","suffix");return t.answers=a.map(e.answers,function(e){return a.map(e,function(e){return null!=e?String(e):""})}),t};e.exports={name:"matrix",displayName:"Matrix",widget:_,transform:R,staticTransform:O,isLintable:!0}}).call(t,n(23))},700:function(e,t,n){var r=n(0),o=n(6),i=o.StyleSheet,s=o.css,a=n(1),p=n(32),l=n(676),u=n(13).Options,c=n(19).shuffle,h=n(19).seededRNG,d=n(22),f=d.linterContextProps,g=d.linterContextDefault,m=r.createClass({displayName:"Matcher",propTypes:{apiOptions:u.propTypes,labels:r.PropTypes.array,left:r.PropTypes.array,onChange:r.PropTypes.func,orderMatters:r.PropTypes.bool,padding:r.PropTypes.bool,problemNum:r.PropTypes.number,right:r.PropTypes.array,trackInteraction:r.PropTypes.func.isRequired,linterContext:f},getDefaultProps:function(){return{left:[],right:[],labels:["",""],orderMatters:!1,padding:!0,problemNum:0,onChange:function(){},linterContext:g}},getInitialState:function(){return{leftHeight:0,rightHeight:0}},render:function(){var e,t=h(this.props.problemNum);e=this.props.orderMatters?c(this.props.left,t,!0):this.props.left;var n=c(this.props.right,t,!0),o=a.any(this.props.labels),i={height:a.max([this.state.leftHeight,this.state.rightHeight])},u=this.props.apiOptions.isMobile?8:5;return r.createElement("table",{className:s(y.widget)+" perseus-widget-matcher"},r.createElement("tbody",null,o&&r.createElement("tr",{className:s(y.row)},r.createElement("th",{className:s(y.column,y.columnLabel)},r.createElement(p,{content:this.props.labels[0]||"...",linterContext:this.props.linterContext})),r.createElement("th",{className:s(y.column,y.columnRight,y.columnLabel)},r.createElement(p,{content:this.props.labels[1]||"...",linterContext:this.props.linterContext}))),r.createElement("tr",{className:s(y.row)},r.createElement("td",{className:s(y.column)},r.createElement(l,{options:e,layout:"vertical",padding:this.props.padding,disabled:!this.props.orderMatters,constraints:i,onMeasure:this.onMeasureLeft,onChange:this.changeAndTrack,margin:u,linterContext:this.props.linterContext,ref:"left"})),r.createElement("td",{className:s(y.column,y.columnRight)},r.createElement(l,{options:n,layout:"vertical",padding:this.props.padding,constraints:i,onMeasure:this.onMeasureRight,onChange:this.changeAndTrack,margin:u,linterContext:this.props.linterContext,ref:"right"})))))},changeAndTrack:function(e){this.props.onChange(e),this.props.trackInteraction()},onMeasureLeft:function(e){var t=a.max(e.heights);this.setState({leftHeight:t})},onMeasureRight:function(e){var t=a.max(e.heights);this.setState({rightHeight:t})},getUserInput:function(){return{left:this.refs.left.getOptions(),right:this.refs.right.getOptions()}},simpleValidate:function(e){return m.validate(this.getUserInput(),e)}});a.extend(m,{validate:function(e,t){return{type:"points",earned:a.isEqual(e.left,t.left)&&a.isEqual(e.right,t.right)?1:0,total:1,message:null}}});var y=i.create({widget:{paddingTop:5,maxWidth:"100%",minWidth:"auto"},row:{border:0},column:{padding:0,border:0},columnRight:{borderLeft:"1px solid #444"},columnLabel:{fontWeight:"inherit",borderBottom:"1px solid #444",padding:"0 5px 5px 5px",textAlign:"center"}});e.exports={name:"matcher",displayName:"Two column matcher",widget:m,isLintable:!0}},701:function(e,t,n){(function(t){var r=n(0),o=n(8),i=n(1),s=n(13).Options,a=n(144),p={url:null,top:0,left:0},l=r.createClass({displayName:"Measurer",propTypes:{apiOptions:s.propTypes,box:r.PropTypes.arrayOf(r.PropTypes.number),image:r.PropTypes.shape({url:r.PropTypes.string,top:r.PropTypes.number,left:r.PropTypes.number}),showProtractor:r.PropTypes.bool,protractorX:r.PropTypes.number,protractorY:r.PropTypes.number,showRuler:r.PropTypes.bool,rulerLabel:r.PropTypes.string,rulerTicks:r.PropTypes.number,rulerPixels:r.PropTypes.number,rulerLength:r.PropTypes.number},getDefaultProps:function(){return{box:[480,480],image:{},showProtractor:!0,protractorX:7.5,protractorY:.5,showRuler:!1,rulerLabel:"",rulerTicks:10,rulerPixels:40,rulerLength:10}},getInitialState:function(){return{}},render:function(){var e=i.extend({},p,this.props.image);return r.createElement("div",{className:"perseus-widget perseus-widget-measurer graphie-container above-scratchpad",style:{width:this.props.box[0],height:this.props.box[1]}},e.url&&r.createElement("img",{src:e.url,style:{top:e.top,left:e.left}}),r.createElement("div",{className:"graphie",ref:"graphieDiv"}))},componentDidMount:function(){this.setupGraphie()},componentDidUpdate:function(e){i.any(["box","showProtractor","showRuler","rulerLabel","rulerTicks","rulerPixels","rulerLength"],function(t){return e[t]!==this.props[t]},this)&&this.setupGraphie()},setupGraphie:function(){var e=o.findDOMNode(this.refs.graphieDiv);t(e).empty();var n=this.graphie=a.createGraphie(e),r=[40,40],i=[[0,this.props.box[0]/r[0]],[0,this.props.box[1]/r[1]]];n.init({range:i,scale:r}),n.addMouseLayer({allowScratchpad:!0,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable}),this.protractor&&this.protractor.remove(),this.props.showProtractor&&(this.protractor=n.protractor([this.props.protractorX,this.props.protractorY])),this.ruler&&this.ruler.remove(),this.props.showRuler&&(this.ruler=n.ruler({center:[(i[0][0]+i[0][1])/2,(i[1][0]+i[1][1])/2],label:this.props.rulerLabel,pixelsPerUnit:this.props.rulerPixels,ticksPerUnit:this.props.rulerTicks,units:this.props.rulerLength}))},getUserInput:function(){return{}},simpleValidate:function(e){return l.validate(this.getUserInput(),e)},focus:t.noop});i.extend(l,{validate:function(e,t){return{type:"points",earned:1,total:1,message:null}}});var u={1:function(e){return i(e).chain().omit("imageUrl","imageTop","imageLeft").extend({image:{url:e.imageUrl,top:e.imageTop,left:e.imageLeft}}).value()}};e.exports={name:"measurer",displayName:"Measurer",widget:l,version:{major:1,minor:0},propUpgrades:u}}).call(t,n(10))},702:function(e,t){function n(e,t){null!==t.value&&(e.fillStyle=c.fgColor,e.font=c.font,e.fillText(t.value,t.pos[0]-c.fontSizePx/2+1,t.pos[1]+c.fontSizePx/2))}function r(e,t){var n=new Path2D;e.lineWidth=5*c.lineWidth,e.strokeStyle=c.fgColor,n.moveTo(t.startPos[0],t.startPos[1]),n.lineTo(t.endPos[0],t.endPos[1]),e.stroke(n),n=new Path2D,e.lineWidth=3*c.lineWidth,e.strokeStyle=c.bgColor,n.moveTo(t.startPos[0],t.startPos[1]),n.lineTo(t.endPos[0],t.endPos[1]),e.stroke(n)}function o(e,t){var n=new Path2D;e.lineWidth=7*c.lineWidth,e.strokeStyle=c.fgColor,n.moveTo(t.startPos[0],t.startPos[1]),n.lineTo(t.endPos[0],t.endPos[1]),e.stroke(n),n=new Path2D,e.lineWidth=5*c.lineWidth,e.strokeStyle=c.bgColor,n.moveTo(t.startPos[0],t.startPos[1]),n.lineTo(t.endPos[0],t.endPos[1]),e.stroke(n),i(e,t)}function i(e,t){var n=new Path2D;e.lineWidth=c.lineWidth,e.strokeStyle=c.fgColor,n.moveTo(t.startPos[0],t.startPos[1]),n.lineTo(t.endPos[0],t.endPos[1]),e.stroke(n)}function s(e){return function(t){l[t.type](e,t)}}function a(e,t){return u[e.type]-u[t.type]}function p(e,t){t.sort(a).forEach(s(e))}var l={text:n,"line:single":i,"line:double":r,"line:triple":o},u={"line:single":0,"line:double":0,"line:triple":0,text:1},c={bgColor:"rgb(255, 255, 255)",fgColor:"rgb(0, 0, 0)",fontSizePx:12,lineWidth:1};c.font=c.fontSizePx+"px sans",e.exports=p},703:function(e,t){function n(e,t,n){var r=e[0],o=e[1];return[r+Math.cos(2*t*Math.PI/360)*n,o+-1*Math.sin(2*t*Math.PI/360)*n]}function r(e,t,r,o){var i=e.symbol;if("C"===i&&1!==Object.keys(t).length&&(i=null),"1,0"===e.idx){var s=[0,0];return e.pos=s,e.baseAngle=-30+o,{type:"text",value:i,pos:s,idx:e.idx}}var a=t[e.connections.find(function(e){return t[e].pos})],p=a.connections.indexOf(e.idx),l=60,u=120;4===a.connections.length?(u=90,l=90):(r.find(function(t){return"triple"===t.bondType&&t.to===e.idx})||r.find(function(e){return"triple"===e.bondType&&e.to===a.idx}))&&(u=0,l=0);var h=0,d=a.idx.split(":"),f=d[d.length-1].split(",")[0];h=parseInt(f)%2!=0?a.baseAngle-(l-u*p):a.baseAngle+(l-u*p);var g=n(a.pos,h,c);return e.pos=g,e.baseAngle=h,{type:"text",value:i,pos:g,idx:e.idx}}function o(e,t){var n=[e.pos[0],e.pos[1]],r=[t.pos[0],t.pos[1]];return"C"!==e.symbol&&(n=[t.pos[0]-.75*(t.pos[0]-e.pos[0]),t.pos[1]-.75*(t.pos[1]-e.pos[1])]),"C"!==t.symbol&&(r=[e.pos[0]-.75*(e.pos[0]-t.pos[0]),e.pos[1]-.75*(e.pos[1]-t.pos[1])]),[n,r]}function i(e,t){var n=t[e.from],r=t[e.to],i=o(n,r);return{type:"line:"+e.bondType,startPos:i[0],endPos:i[1]}}function s(e){return e.join(":")}function a(e,t,n){if(null===n)return[e,t];if("atom"===n.type){var r=s(n.idx);e[r]={idx:r,symbol:n.symbol,connections:[]},n.bonds&&n.bonds.forEach(function(n){var o=s(n.to.idx);e[r].connections.push(o),t.push({from:r,to:o,bondType:n.bondType}),a(e,t,n.to),e[o].connections.push(r)})}return[e,t]}function p(e,t,n,o,i){if(0===t.length)return e;var s=t.shift(),a=n[s];return a.connections.forEach(function(e){n[e].pos||t.push(e)}),p(e.concat(r(a,n,o,i)),t,n,o,i)}function l(e,t,n){return 0===n.length?e:l(e.concat(i(n[0],t)),t,n.slice(1))}function u(e,t){var n=a({},[],e),r=n[0],o=n[1];return l(p([],["1,0"],r,o,t),r,o)}var c=30;e.exports={layout:u,_atomLayout:r,_bondLayout:i,_bondLength:c,_convertTree:a}},704:function(e,t){function n(e){this.message=e}function r(e,t,n){var o=t[0],i=t.slice(1),s=void 0;s=Array.isArray(e)?[].concat(e):f({},e||{});var a=n;return i.length>0&&(a=r(s[o],i,n)),s[o]=a,s}function o(e,t){return r(e,t,t.reduce(function(e,t){return e[t]},e)+1)}function i(e){return g.test(e)}function s(e,t){var o=e[0],i=e.slice(1);if("="===o)return d(i,r(t,["bond","bondType"],"double"));if("#"===o)return d(i,r(t,["bond","bondType"],"triple"));throw new n("Invalid character: "+o)}function a(e,t){if(0===t.length)return e;if(""===e)throw new n("Mismatched parentheses");var r=e[0],o=e.slice(1);return"("===r?a(o,t.concat(r)):")"===r?a(o,t.slice(1)):a(o,t)}function p(e,t){var r=e[0],i=e.slice(1);if("("===r){var s=f({},t,{parens:t.parens+"("});s=o(t,["idx",t.idx.length-1,1]);var p=-1;return t.idx[t.idx.length-1][0]%2==0&&(p=0),[d(i,f({},s,{idx:s.idx.concat([[p,0]]),parens:s.parens.concat("(")}))].concat(d(a(i,["("]),s))}if(")"===r){if("("!==t.parens[t.parens.length-1])throw new n("Mismatched parentheses");return null}throw new n("Invalid bare character: "+r)}function l(e,t){var n=null,r=null;if("["===e[0]){var o=e.indexOf("]");if(-1===o)return["",e];n=e.slice(1,o),r=e.slice(o+1)}else n=m.exec(e)[1],r=e.slice(n.length);return[n,r]}function u(e,t){var n=l(e,t),o=n[0];if(""===o)return["error","Unable to parse bracketed atom."];var i=n[1],s=r(t,["idx",t.idx.length-1],[1+t.idx[t.idx.length-1][0],0]),a=d(i,r(s,["bond","bondType"],"single"));Array.isArray(a)||!a||(a=[a]);var p={type:"atom",symbol:o,bonds:a,idx:s.idx};return t.bond?{type:"bond",bondType:t.bond.bondType,to:p}:p}function c(e){return m.test(e)}function h(e){return"="===e||"#"===e}function d(e,t){if(!i(e))throw new n("Invalid input.");return e&&0!==e.length?c(e)?u(e,t||{idx:[[0,0]],parens:[],stack:[],bondModifiers:[]}):h(e[0])?s(e,t):p(e,t):null}var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},g=new RegExp("^[A-Za-z\\[\\]()=#+-]*$"),m=new RegExp("^(Cl|Br|[CONPSFBI]|\\[)");e.exports={parse:d,ParseError:n}},705:function(e,t,n){(function(t,r){function o(e,t){return 1===t?""+e:"\\dfrac{"+e+"}{"+t+"}"}function i(e,t){if(e<0)return"-"+i(-e,t);var n=Math.floor(e/t);return 0===n?o(e,t):e-n*t==0?""+n:n+o(e-n*t,t)}function s(e,t,n){return o(e*Math.floor(n/t),n)}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p=n(0),l=n(8),u=n(1),c=n(143),h=n(671),d=n(240),f=n(145),g=n(13).Options,m=n(27).propTypes.keypadElementPropType,y=n(241),v=y.MovablePoint,b=y.Line,T=n(9).number,P=n(43),x=n(42),C=function(e,t,n){return Math.min(Math.max(e,t),n)},w=n(33).assert,E={ge:"le",gt:"lt",le:"ge",lt:"gt"},k={ge:"gt",gt:"ge",le:"lt",lt:"le"},S=function(e,t,n,r,a){if(r=r||n,"decimal"===t||"decimal ticks"===t)return e.label([n,-.53],Math.round(100*r)/100,"center");if("improper"===t){var p=P.toFraction(r);return e.label([n,-.17],o(p[0],p[1]),"below")}if("mixed"===t){var l=P.toFraction(r);return e.label([n,-.17],i(l[0],l[1]),"below")}if("non-reduced"===t){var u=P.toFraction(r);return e.label([n,-.17],s(u[0],u[1],a),"below")}},M=y.createSimpleClass(function(e,t){if(!u.isFinite(t.tickStep)||t.tickStep<=0)return[];var n,r=[],o=t.range,i=t.labelRange,s=null==i[0]?o[0]:i[0],a=null==i[1]?o[1]:i[1];if("non-reduced"===t.labelStyle){for(var p=[s,a],l=0;l<=t.numDivisions;l++){var c=o[0]+l*t.tickStep;p.push(c)}var h=function(e){return T.toFraction(e)[1]},d=u.map(p,h);n=u.reduce(d,function(e,t){return P.getLCM(e,t)})}else n=void 0;for(var f=0;f<=t.numDivisions;f++){var g=o[0]+f*t.tickStep;r.push(e.line([g,-.2],[g,.2])),(t.labelTicks||"decimal ticks"===t.labelStyle)&&r.push(S(e,t.labelStyle,g,g,n))}return r.push(e.style(t.isMobile?{color:x.BLUE_D}:{},function(){return S(e,t.labelStyle,s,s,n)})),r.push(e.style(t.isMobile?{color:x.BLUE_D}:{},function(){return S(e,t.labelStyle,a,a,n)})),e.style({stroke:t.isMobile?x.BLUE_D:x.DYNAMIC,strokeWidth:3.5},function(){r.push(e.line([s,-.2],[s,.2])),r.push(e.line([a,-.2],[a,.2]))}),r}),I=p.createClass({displayName:"NumberLine",propTypes:a({},c.propTypes,{range:p.PropTypes.arrayOf(p.PropTypes.number).isRequired,labelRange:p.PropTypes.arrayOf(p.PropTypes.number).isRequired,labelStyle:p.PropTypes.string.isRequired,labelTicks:p.PropTypes.bool.isRequired,divisionRange:p.PropTypes.arrayOf(p.PropTypes.number).isRequired,numDivisions:p.PropTypes.number.isRequired,snapDivisions:p.PropTypes.number.isRequired,isTickCtrl:p.PropTypes.bool.isRequired,isInequality:p.PropTypes.bool.isRequired,numLinePosition:p.PropTypes.number.isRequired,rel:p.PropTypes.oneOf(["lt","gt","le","ge"]),onFocus:p.PropTypes.func.isRequired,onBlur:p.PropTypes.func.isRequired,onChange:p.PropTypes.func.isRequired,apiOptions:g.propTypes,keypadElement:m,static:p.PropTypes.bool,showTooltips:p.PropTypes.bool,trackInteraction:p.PropTypes.func.isRequired}),getDefaultProps:function(){return{range:[0,10],labelStyle:"decimal",labelRange:[null,null],divisionRange:[1,12],labelTicks:!0,isTickCtrl:!1,isInequality:!1,numLinePosition:0,snapDivisions:2,showTooltips:!1,rel:"ge",apiOptions:g.defaults}},getInitialState:function(){return{numDivisionsEmpty:!1}},change:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return c.change.apply(this,t)},isValid:function(){var e=this.props.range,t=this.props.numLinePosition,n=this.props.divisionRange;return t=null==t?e[0]:t,e[0]<e[1]&&T.sign(t-e[0])>=0&&T.sign(t-e[1])<=0&&n[0]<n[1]&&0<this.props.numDivisions&&0<this.props.snapDivisions},onNumDivisionsChange:function(e,t){var n=this,r=this.props.divisionRange.slice(),o=this.props.range[1]-this.props.range[0];if(e=Math.round(e),e=e<0?-1*e:e){var i=u.extend({},this.props,{tickStep:o/e}),s=this.snapNumLinePosition(i,this.props.numLinePosition);this.setState({numDivisionsEmpty:!1},function(){n.props.onChange({divisionRange:r,numDivisions:e,numLinePosition:s},t)})}else this.setState({numDivisionsEmpty:!0},t)},_handleTickCtrlFocus:function(){this.props.onFocus(["tick-ctrl"])},_handleTickCtrlBlur:function(){this.props.onBlur(["tick-ctrl"])},focus:function(){if(this.props.isTickCtrl)return this.refs["tick-ctrl"].focus(),!0},focusInputPath:function(e){1===e.length&&this.refs[e[0]].focus()},blurInputPath:function(e){1===e.length&&this.refs[e[0]].blur()},getInputPaths:function(){return this.props.isTickCtrl?[["tick-ctrl"]]:[]},getDOMNodeForPath:function(e){if(1===e.length)return l.findDOMNode(this.refs[e[0]])},getGrammarTypeForPath:function(e){if(1===e.length&&"tick-ctrl"===e[0])return"number"},setInputValue:function(e,t,n){1===e.length&&"tick-ctrl"===e[0]&&this.onNumDivisionsChange(t,n)},_renderGraphie:function(){var e=this,t=this.props.range,n=t[1]-t[0],r=u.pick(this.props,["range","isTickCtrl"]),o=u.extend({},this.props,{tickStep:n/this.props.numDivisions});return p.createElement(y,{ref:"graphie",key:this.props.labelStyle,box:[this.props.apiOptions.isMobile?288:460,80],options:r,onMouseDown:function(t){e.refs.graphie.movables.numberLinePoint.grab(t)},setup:this._setupGraphie,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable,isMobile:this.props.apiOptions.isMobile},p.createElement(M,a({},u.pick(o,["range","numDivisions","labelTicks","labelStyle","labelRange","tickStep"]),{isMobile:this.props.apiOptions.isMobile})),this._renderInequality(o),this._renderNumberLinePoint(o))},snapNumLinePosition:function(e,t){var n=e.range[0],r=e.range[1],o=e.tickStep/e.snapDivisions,i=C(t,n,r);return i=n+T.roundTo(i-n,o),w(u.isFinite(i)),i},_renderNumberLinePoint:function(e){var t,n=this,r=u(["lt","gt"]).contains(e.rel);t=r?x._BACKGROUND:e.static?x.DYNAMIC:x.INTERACTIVE;var o={fill:t,stroke:e.static?x.DYNAMIC:x.INTERACTIVE,"stroke-width":r?3:1},i={fill:r?x._BACKGROUND:x.INTERACTING,"stroke-width":r?3:1},s=e.isInequality?{stroke:x.INTERACTIVE,"fill-opacity":r?0:1}:{};return p.createElement(v,{ref:"numberLinePoint",pointSize:6,coord:[e.numLinePosition,0],constraints:[function(e,t){return[e[0],t[1]]},function(t,r){return[n.snapNumLinePosition(e,t[0]),t[1]]}],normalStyle:o,highlightStyle:i,onMove:function(e){n.change({numLinePosition:e[0]}),n.props.trackInteraction()},isMobile:this.props.apiOptions.isMobile,mobileStyleOverride:s,showTooltips:this.props.showTooltips,xOnlyTooltip:!0})},handleReverse:function(){var e=E[this.props.rel];this.props.onChange({rel:e})},handleToggleStrict:function(){var e=k[this.props.rel];this.props.onChange({rel:e})},_getInequalityEndpoint:function(e){var t=u(["ge","gt"]).contains(e.rel),n=e.range,r=(n[1]-n[0])/400,o=30*r,i=n[0]-o,s=n[1]+o;return t?[s,0]:[i,0]},_renderInequality:function(e){if(e.isInequality){var t=this._getInequalityEndpoint(e),n={arrows:"->",stroke:this.props.apiOptions.isMobile?x.INTERACTIVE:x.DYNAMIC,strokeWidth:3.5},r=["ge","gt"].includes(e.rel);return p.createElement(b,{start:[(r?.4:-.4)+e.numLinePosition,0],end:t,style:n})}return null},_setupGraphie:function(e,t){if(this.isValid()){var n=this.props.apiOptions.isMobile?228:400,r=t.range,o=(r[1]-r[0])/n,i=30*o,s=r[0]-i,a=r[1]+i,p="improper"===this.props.labelStyle||"mixed"===this.props.labelStyle||"non-reduced"===this.props.labelStyle,l=p?-1.5:-1;e.init({range:[[s,a],[l,1]],scale:[1/o,40],isMobile:this.props.apiOptions.isMobile});var u=(r[0]+r[1])/2;e.line([u,0],[a,0],{arrows:"->"}),e.line([u,0],[s,0],{arrows:"->"})}},getUserInput:function(){return{numLinePosition:this.props.numLinePosition,rel:this.props.isInequality?this.props.rel:"eq",numDivisions:this.props.numDivisions,divisionRange:this.props.divisionRange}},simpleValidate:function(e){return I.validate(this.getUserInput(),e)},render:function(){var e,n=this.props.divisionRange,o=n[0]+"–"+n[1],i=this.props.numDivisions<n[0]||this.props.numDivisions>n[1],s=p.createElement("div",null,p.createElement("input",{type:"button",className:"simple-button",value:t._("Switch direction"),onClick:this.handleReverse}),p.createElement("input",{type:"button",className:"simple-button",value:u(["le","ge"]).contains(this.props.rel)?t._("Make circle open"):t._("Make circle filled"),onClick:this.handleToggleStrict}));if(this.props.isTickCtrl){var a;a=this.props.apiOptions.customKeypad?f:this.props.apiOptions.staticRender?d:h,e=p.createElement("label",null,t._("Number of divisions:")," ",p.createElement(a,{ref:"tick-ctrl",value:this.state.numDivisionsEmpty?null:this.props.numDivisions||n[0],checkValidity:function(e){return e>=n[0]&&e<=n[1]},onChange:this.onNumDivisionsChange,onFocus:this._handleTickCtrlFocus,onBlur:this._handleTickCtrlBlur,useArrowKeys:!0,keypadElement:this.props.keypadElement}))}return p.createElement("div",{className:"perseus-widget perseus-widget-interactive-number-line"},e,this.isValid()?this.props.isTickCtrl&&i?p.createElement("div",{className:"perseus-error"},r({divRangeString:o},"Please make sure the number of divisions is in the range { divRangeString }.")):this._renderGraphie():p.createElement("div",{className:"perseus-error"},"Invalid number line configuration."),!this.props.static&&this.props.isInequality&&s)}});u.extend(I,{validate:function(e,t){var n=t.range,r=e.divisionRange,o=null!=t.initialX?t.initialX:n[0],i=t.isInequality?"ge":"eq",s=t.correctRel||"eq",a=T.equal(e.numLinePosition,t.correctX||0),p=e.numDivisions>r[1]||e.numDivisions<r[0];return e.isTickCrtl&&p?{type:"invalid",message:"Number of divisions is outside the allowed range."}:a&&s===e.rel?{type:"points",earned:1,total:1,message:null}:e.numLinePosition===o&&e.rel===i?{type:"invalid",message:null}:{type:"points",earned:0,total:1,message:null}}});var _=function(e){var t,n=u.pick(e,["range","labelRange","labelStyle","labelTicks","divisionRange","snapDivisions","isTickCtrl","isInequality","showTooltips"]),r=null!=e.initialX?e.initialX:e.range[0],o=e.range[1]-e.range[0];return t=null!=e.numDivisions?e.numDivisions:null!=e.tickStep?o/e.tickStep:void 0,u.extend(n,{numLinePosition:r,numDivisions:t,snapDivisions:n.snapDivisions||void 0}),n},R=function(e){var t,n=u.pick(e,["range","labelRange","labelStyle","labelTicks","divisionRange","snapDivisions","isInequality"]),r=null!=e.correctX?e.correctX:e.range[0],o=e.range[1]-e.range[0];return t=null!=e.numDivisions?e.numDivisions:null!=e.tickStep?o/e.tickStep:void 0,u.extend(n,{numLinePosition:r,numDivisions:t,rel:e.isInequality?e.correctRel:null,snapDivisions:n.snapDivisions||void 0}),n};e.exports={name:"number-line",displayName:"Number line",widget:I,transform:_,staticTransform:R}}).call(t,n(23),n(245))},706:function(e,t,n){(function(t){var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(0),i=n(8),s=n(1),a=n(32),p=n(19),l=n(13).ClassNames,u=n(22),c=u.linterContextProps,h=u.linterContextDefault,d=o.createClass({displayName:"PlaceholderCard",propTypes:{width:o.PropTypes.number.isRequired,height:o.PropTypes.number.isRequired},render:function(){return o.createElement("div",{className:"card-wrap "+l.INTERACTIVE,style:{width:this.props.width}},o.createElement("div",{className:"card placeholder",style:{height:this.props.height}}))}}),f=o.createClass({displayName:"DragHintCard",render:function(){return o.createElement("div",{className:"card-wrap "+l.INTERACTIVE},o.createElement("div",{className:"card drag-hint"}))}}),g={position:o.PropTypes.shape({left:o.PropTypes.number,top:o.PropTypes.number})},m=o.createClass({displayName:"Card",propTypes:{floating:o.PropTypes.bool.isRequired,animating:o.PropTypes.bool,width:o.PropTypes.number,stack:o.PropTypes.bool,onMouseDown:o.PropTypes.func,onMouseMove:o.PropTypes.func,onMouseUp:o.PropTypes.func,startMouse:g.position,startOffset:g.position,animateTo:g.position,onAnimationEnd:o.PropTypes.func,linterContext:c},getDefaultProps:function(){return{stack:!1,animating:!1,linterContext:h}},render:function(){var e={};this.props.floating&&(e={position:"absolute",left:this.props.startOffset.left,top:this.props.startOffset.top}),this.props.width&&(e.width=this.props.width);var n=["card"];this.props.stack&&n.push("stack"),this.props.floating&&!this.props.animating&&(n.push("dragging"),e.left+=this.props.mouse.left-this.props.startMouse.left,e.top+=this.props.mouse.top-this.props.startMouse.top);var i=s.pick(this.props,"content"),p=this.props.animating?t.noop:this.onMouseDown;return o.createElement("div",{className:"card-wrap "+l.INTERACTIVE,style:e,onMouseDown:p,onTouchStart:p,onTouchMove:this.onMouseMove,onTouchEnd:this.onMouseUp,onTouchCancel:this.onMouseUp},o.createElement("div",{className:n.join(" ")},o.createElement(a,r({},i,{linterContext:this.props.linterContext}))))},shouldComponentUpdate:function(e,t){return this.props.floating||e.floating||this.props.content!==e.content||this.props.fakeRef!==e.fakeRef},componentDidMount:function(){this.mouseMoveUpBound=!1},componentDidUpdate:function(e,n){if(this.props.animating&&!e.animating){var r=15*Math.sqrt(Math.sqrt(Math.pow(this.props.animateTo.left-this.props.startOffset.left,2)+Math.pow(this.props.animateTo.top-this.props.startOffset.top,2)));t(i.findDOMNode(this)).animate(this.props.animateTo,Math.max(r,1),this.props.onAnimationEnd)}},componentWillUnmount:function(){this.mouseMoveUpBound&&(console.warn("Removing an element with bound event handlers."),this.unbindMouseMoveUp(),p.resetTouchHandlers())},bindMouseMoveUp:function(){this.mouseMoveUpBound=!0,t(document).on("mousemove",this.onMouseMove),t(document).on("mouseup",this.onMouseUp)},unbindMouseMoveUp:function(){this.mouseMoveUpBound=!1,t(document).off("mousemove",this.onMouseMove),t(document).off("mouseup",this.onMouseUp)},onMouseDown:function(e){e.preventDefault();var t=p.extractPointerLocation(e);t&&(this.bindMouseMoveUp(),this.props.onMouseDown&&this.props.onMouseDown(t,this))},onMouseMove:function(e){e.preventDefault();var t=p.extractPointerLocation(e);t&&this.props.onMouseMove&&this.props.onMouseMove(t)},onMouseUp:function(e){e.preventDefault();var t=p.extractPointerLocation(e);t&&(this.unbindMouseMoveUp(),this.props.onMouseUp&&this.props.onMouseUp(t))}}),y=o.createClass({displayName:"Orderer",propTypes:{correctOptions:o.PropTypes.array,current:o.PropTypes.array,height:o.PropTypes.oneOf(["normal","auto"]),layout:o.PropTypes.oneOf(["horizontal","vertical"]),options:o.PropTypes.array,trackInteraction:o.PropTypes.func.isRequired,linterContext:c},getDefaultProps:function(){return{current:[],options:[],correctOptions:[],height:"normal",layout:"horizontal",linterContext:h}},getInitialState:function(){return{current:[],dragging:!1,placeholderIndex:null}},componentWillReceiveProps:function(e){s.isEqual(this.props.current,e.current)||this.setState({current:e.current})},render:function(){var e=this,n=this.state.dragging&&o.createElement(m,{ref:"dragging",floating:!0,content:this.state.dragContent,startOffset:this.state.offsetPos,startMouse:this.state.grabPos,mouse:this.state.mousePos,width:this.state.dragWidth,onMouseUp:this.onRelease,onMouseMove:this.onMouseMove,key:this.state.dragKey||"draggingCard",linterContext:this.props.linterContext}),r=this.state.animating&&o.createElement(m,{floating:!0,animating:!0,content:this.state.dragContent,startOffset:this.state.offsetPos,width:this.state.dragWidth,animateTo:this.state.animateTo,onAnimationEnd:this.state.onAnimationEnd,key:this.state.dragKey||"draggingCard",linterContext:this.props.linterContext}),i=s.map(this.state.current,function(e,n){return o.createElement(m,{ref:"sortable"+n,fakeRef:"sortable"+n,floating:!1,content:e.content,width:e.width,key:e.key,linterContext:this.props.linterContext,onMouseDown:this.state.animating?t.noop:this.onClick.bind(null,"current",n)})},this);if(null!=this.state.placeholderIndex){var a=o.createElement(d,{ref:"placeholder",width:this.state.dragWidth,height:this.state.dragHeight,key:"placeholder"});i.splice(this.state.placeholderIndex,0,a)}var p=i.length>0;i.push(n,r);var u=o.createElement("div",{className:"perseus-clearfix draggable-box"},!p&&o.createElement(f,null),o.createElement("div",{ref:"dragList"},i)),c=o.createElement("div",{ref:"bank",className:"bank perseus-clearfix"},s.map(this.props.options,function(n,r){return o.createElement(m,{ref:"bank"+r,floating:!1,content:n.content,stack:!0,key:r,linterContext:e.props.linterContext,onMouseDown:e.state.animating?t.noop:e.onClick.bind(null,"bank",r),onMouseMove:e.onMouseMove,onMouseUp:e.onRelease})},this));return o.createElement("div",{className:"draggy-boxy-thing orderer height-"+this.props.height+" layout-"+this.props.layout+" above-scratchpad blank-background perseus-clearfix "+l.INTERACTIVE,ref:"orderer"},c,u)},onClick:function(e,n,r,o){var s,a=t(i.findDOMNode(o)),p=this.state.current.slice(),l=null;"current"===e?(p.splice(n,1),s=this.state.current[n],l=n):"bank"===e&&(s=this.props.options[n]),this.setState({current:p,dragging:!0,placeholderIndex:l,dragKey:s.key,dragContent:s.content,dragWidth:a.width(),dragHeight:a.height(),grabPos:r,mousePos:r,offsetPos:a.position()})},onRelease:function(e){var n=this,r=this.refs.dragging;if(null!=r){var o=this.isCardInBank(r),a=this.state.placeholderIndex,p=function(){var e=n.state.current.slice();if(!o){var t={content:n.state.dragContent,key:s.uniqueId("perseus_draggable_card_"),width:n.state.dragWidth};e.splice(a,0,t)}n.props.onChange({current:e}),n.setState({current:e,dragging:!1,placeholderIndex:null,animating:!1}),n.props.trackInteraction()},l=t(i.findDOMNode(r)).position(),u=null;o?s.each(this.props.options,function(e,n){if(e.content===this.state.dragContent){var r=i.findDOMNode(this.refs["bank"+n]);u=t(r).position()}},this):null!=this.refs.placeholder&&(u=t(i.findDOMNode(this.refs.placeholder)).position()),null==u?p():this.setState({offsetPos:l,animateTo:u,onAnimationEnd:p,animating:!0,dragging:!1})}},onMouseMove:function(e){var t=this.refs.dragging;if(null!=t){var n;n=this.isCardInBank(t)?null:this.findCorrectIndex(t,this.state.current),this.setState({mousePos:e,placeholderIndex:n})}},findCorrectIndex:function(e,n){var r="horizontal"===this.props.layout,o=t(i.findDOMNode(this.refs.dragList)),a=o.offset().left,p=o.offset().top,l=t(i.findDOMNode(e)).offset().left-a,u=t(i.findDOMNode(e)).offset().top-p,c=0,h=0,d=0;return r?s.each(n,function(e,n){var r=i.findDOMNode(this.refs["sortable"+n]),o=t(r).outerWidth(!0);l>h+o/2&&(c+=1),h+=o},this):s.each(n,function(e,n){var r=i.findDOMNode(this.refs["sortable"+n]),o=t(r).outerHeight(!0);u>d+o/2&&(c+=1),d+=o},this),c},isCardInBank:function(e){if(null==e)return!1;var n="horizontal"===this.props.layout,r=t(i.findDOMNode(e)),o=t(i.findDOMNode(this.refs.bank)),s=r.offset(),a=o.offset(),p=r.outerHeight(!0),l=o.outerHeight(!0),u=o.outerWidth(!0),c=i.findDOMNode(this.refs.dragList),h=(t(c).width(),r.outerWidth(!0));return n?s.top+p/2<a.top+l:s.left+h/2<a.left+u},getUserInput:function(){return{current:s.map(this.props.current,function(e){return e.content})}},simpleValidate:function(e){return y.validate(this.getUserInput(),e)}});s.extend(y,{validate:function(e,t){return 0===e.current.length?{type:"invalid",message:null}:{type:"points",earned:s.isEqual(e.current,s.pluck(t.correctOptions,"content"))?1:0,total:1,message:null}}}),e.exports={name:"orderer",displayName:"Orderer",widget:y,isLintable:!0}}).call(t,n(10))},707:function(e,t,n){(function(t){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n(6),a=s.StyleSheet,p=s.css,l=n(0),u=n(8),c=n(1),h=n(10),d=n(708),f=n(32),g=n(714),m=n(22),y=m.linterContextDefault,v=(n(143).babelPluginFlowReactPropTypes_proptype_ChangeableProps||n(0).PropTypes.any,n(670).babelPluginFlowReactPropTypes_proptype_SerializedHighlightSet||n(0).PropTypes.any,function(e){function t(){return r(this,t),o(this,e.apply(this,arguments))}return i(t,e),t.prototype.measureLineHeight=function(){return"number"!=typeof this._cachedLineHeight&&this.forceMeasureLineHeight(),this._cachedLineHeight},t.prototype.forceMeasureLineHeight=function(){this.$body.text(" "),this._cachedLineHeight=this.$end.offset().top-this.$body.offset().top,this.$body.text("")},t.prototype.render=function(){var e=this;return l.createElement("div",{className:p(b.measurer)},l.createElement("div",null,l.createElement("div",{ref:function(t){return e.$body=h(t)},className:"paragraph"}),l.createElement("div",{ref:function(t){return e.$end=h(t)}})))},t}(l.Component)),b=a.create({measurer:{position:"absolute",width:"100%",top:0,left:0}}),T=function(e){function n(){var t,i,s;r(this,n);for(var a=arguments.length,p=Array(a),l=0;l<a;l++)p[l]=arguments[l];return t=i=o(this,e.call.apply(e,[this].concat(p))),i.state={nLines:null,startLineNumbersAfter:0,stylesAreApplied:!1},i._handleSerializedHighlightsUpdate=function(e){i.props.onChange({highlights:e})},s=t,o(i,s)}return i(n,e),n.prototype.componentDidMount=function(){var e=this;this._updateState(),this._onResize=c.throttle(function(){e.shouldRenderJipt()||(e._lineHeightMeasurer.forceMeasureLineHeight(),e._updateState())},500),window.addEventListener("resize",this._onResize),window.setTimeout(function(){e.setState({stylesAreApplied:!0})},0)},n.prototype.shouldComponentUpdate=function(e,t){return!c.isEqual(this.props,e)||!c.isEqual(this.state,t)},n.prototype.componentDidUpdate=function(){this._updateState()},n.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this._onResize)},n.prototype._updateState=function(){this.shouldRenderJipt()||this.setState({nLines:this._measureLines(),startLineNumbersAfter:this._getInitialLineNumber()})},n.prototype._measureLines=function(){var e=h(u.findDOMNode(this.refs.content)),t=e.height(),n=this._getLineHeight();return Math.round(t/n)},n.prototype._getInitialLineNumber=function(){var e=this,t=!0;return this.props.findWidgets(function(n,r){return"passage"===r.type&&(n===e.props.widgetId&&(t=!1),t)}).map(function(e){return e.getLineCount()}).reduce(function(e,t){return e+t},0)},n.prototype._getLineHeight=function(){return this._lineHeightMeasurer.measureLineHeight()},n.prototype.getLineCount=function(){return null!=this.state.nLines?this.state.nLines:this._measureLines()},n.prototype._getStartRefLineNumber=function(e){var t=g.START_REF_PREFIX+e,n=this.refs[t];if(!n)return null;var r=h(u.findDOMNode(n)),o=r.next();0===o.length&&(o=r);var i=o.offset().top;return this.state.startLineNumbersAfter+1+this._convertPosToLineNumber(i)},n.prototype._getEndRefLineNumber=function(e){var t=g.END_REF_PREFIX+e,n=this.refs[t];if(!n)return null;var r=h(u.findDOMNode(n)),o=r.prev();0===o.length&&(o=r);var i=o.height(),s=o.offset().top,a=this._convertPosToLineNumber(s+i);return 0===i&&(a+=1),this.state.startLineNumbersAfter+a},n.prototype._convertPosToLineNumber=function(e){var t=h(u.findDOMNode(this.refs.content)),n=e-t.offset().top,r=this._getLineHeight();return Math.round(n/r)},n.prototype._getRefContent=function(e){var t=g.START_REF_PREFIX+e,n=this.refs[t];return n?n.getRefContent():null},n.prototype.getReference=function(e){var t=this._getStartRefLineNumber(e),n=this._getEndRefLineNumber(e);return null==t||null==n?null:{startLine:t,endLine:n,content:this._getRefContent(e)}},n.prototype.getUserInput=function(){return null},n.prototype.simpleValidate=function(e){return n.validate(this.getUserInput(),e)},n.validate=function(e,t){return{type:"points",earned:0,total:0,message:null}},n.prototype._renderInstructions=function(e){var n=e.firstQuestionRef,r=e.firstSentenceRef,o="";n&&(o+=t._("The symbol { questionSymbol } indicates that question { questionNumber } references this portion of the passage.",{questionSymbol:"[["+n+"]]",questionNumber:n})),r&&(o+=t._(" The symbol { sentenceSymbol } indicates that the following sentence is referenced in a question.",{sentenceSymbol:"["+r+"]"}));var i=g.parse(o);return l.createElement("div",{className:"perseus-widget-passage-instructions"},g.output(i))},n.prototype.shouldRenderJipt=function(){return"undefined"!=typeof KA&&"en-pt"===KA.language&&-1!==this.props.passageText.indexOf("crwdns")},n.prototype._renderContent=function(e){var t=this,n=this.state.stylesAreApplied,r=!this.props.reviewModeRubric;return l.createElement(d,{editable:r,enabled:n,onSerializedHighlightsUpdate:this._handleSerializedHighlightsUpdate,serializedHighlights:this.props.highlights},l.createElement("div",{ref:"content"},l.createElement(v,{ref:function(e){return t._lineHeightMeasurer=e}}),g.output(e)))},n.prototype._hasFootnotes=function(){return!/^\s*$/.test(this.props.footnotes)},n.prototype._renderFootnotes=function(){var e=this.props.footnotes,t=g.parse(e);return g.output(t)},n.prototype.render=function(){var e=this,n=void 0,r=this.state.nLines;this.props.showLineNumbers&&r&&(n=c.range(1,r+1).map(function(t){return 4===t&&r>4?l.createElement("span",{key:"line-marker",className:"line-marker"},"Line"):l.createElement("span",{key:t},t+e.state.startLineNumbersAfter)}));var o={firstSentenceRef:null,firstQuestionRef:null},i=g.parse(this.props.passageText,o),s=/\S/.test(this.props.passageTitle);return l.createElement("div",null,l.createElement("div",{className:"perseus-widget-passage-container"},this._renderInstructions(o),l.createElement("div",{className:"perseus-widget-passage"},s&&l.createElement("h3",{className:"passage-title"},l.createElement(f,{content:this.props.passageTitle,linterContext:this.props.linterContext})),n&&l.createElement("div",{className:"line-numbers","aria-hidden":!0},n),!s&&l.createElement("h3",{className:"perseus-sr-only"},t._("Beginning of reading passage.")),l.createElement("div",{className:"passage-text"},this.shouldRenderJipt()?l.createElement(f,{content:this.props.passageText}):this._renderContent(i)),this._hasFootnotes()&&[l.createElement("h4",{key:"footnote-start",className:"perseus-sr-only"},t._("Beginning of reading passage footnotes.")),l.createElement("div",{key:"footnotes",className:"footnotes"},this._renderFootnotes())],l.createElement("div",{className:"perseus-sr-only"},t._("End of reading passage.")))))},n}(l.Component);T.defaultProps={passageTitle:"",passageText:"",footnotes:"",showLineNumbers:!0,highlights:{},linterContext:y},e.exports={name:"passage",displayName:"Passage (SAT only)",widget:T,transform:function(e){return c.pick(e,"passageTitle","passageText","footnotes","showLineNumbers")},isLintable:!0}}).call(t,n(23))},708:function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=n(0),p=n(6),l=p.StyleSheet,u=p.css,c=n(709),h=n(712),d=n(713),f=d.addHighlight,g=d.buildHighlight,m=d.deserializeHighlight,y=d.serializeHighlight,v=(n(670).babelPluginFlowReactPropTypes_proptype_DOMRange||n(0).PropTypes.any,n(670).babelPluginFlowReactPropTypes_proptype_SerializedHighlightSet||n(0).PropTypes.any),b=(n(670).babelPluginFlowReactPropTypes_proptype_DOMHighlightSet||n(0).PropTypes.any,n(670).babelPluginFlowReactPropTypes_proptype_DOMHighlight||n(0).PropTypes.any,function(e){function t(){var n,i,a;r(this,t);for(var p=arguments.length,l=Array(p),u=0;u<p;u++)l[u]=arguments[u];return n=i=o(this,e.call.apply(e,[this].concat(l))),i.state={wordRanges:[]},i._handleAddHighlight=function(e){for(var t=f(i._getDOMHighlights(),e),n={},r=Object.keys(t),o=Array.isArray(r),s=0,r=o?r:r[Symbol.iterator]();;){var a;if(o){if(s>=r.length)break;a=r[s++]}else{if(s=r.next(),s.done)break;a=s.value}var p=a;n[p]=y(t[p])}i.props.onSerializedHighlightsUpdate(n)},i._handleRemoveHighlight=function(e){var t=i.props.serializedHighlights,n=s({},t);delete n[e],i.props.onSerializedHighlightsUpdate(n)},i._handleWordsUpdate=function(e){i.setState({wordRanges:e})},a=n,o(i,a)}return i(t,e),t.prototype._buildHighlight=function(e){return g(this._getDOMHighlights(),this.state.wordRanges,e)},t.prototype._getDOMHighlights=function(){for(var e=this.props.serializedHighlights,t=this.state.wordRanges,n={},r=Object.keys(e),o=Array.isArray(r),i=0,r=o?r:r[Symbol.iterator]();;){var s;if(o){if(i>=r.length)break;s=r[i++]}else{if(i=r.next(),i.done)break;s=i.value}var a=s;n[a]=m(e[a],t)}return n},t.prototype.render=function(){var e=this,t=this._getDOMHighlights(),n=function(t){return e._buildHighlight(t)};return a.createElement("div",{className:u(T.container),ref:function(t){return e._container=t}},a.createElement("div",null,this.props.enabled&&this._container&&this._content&&a.createElement(c,{buildHighlight:n,contentNode:this._content,editable:this.props.editable,highlights:t,offsetParent:this._container,zIndexes:{aboveContent:2,belowContent:0},onAddHighlight:this._handleAddHighlight,onRemoveHighlight:this._handleRemoveHighlight})),a.createElement("div",{className:u(T.content),ref:function(t){return e._content=t}},a.createElement(h,{onWordsUpdate:this._handleWordsUpdate},this.props.children)))},t}(a.PureComponent));b.propTypes={children:n(0).PropTypes.any,editable:n(0).PropTypes.bool.isRequired,enabled:n(0).PropTypes.bool.isRequired,onSerializedHighlightsUpdate:n(0).PropTypes.func.isRequired,serializedHighlights:v};var T=l.create({container:{position:"relative",zIndex:0},content:{position:"relative",zIndex:1}});e.exports=b},709:function(e,t,n){(function(t){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n(0),a=n(710),p=n(679),l=n(672),u=l.rangesOverlap,c=n(680),h=n(669).babelPluginFlowReactPropTypes_proptype_ZIndexes||n(0).PropTypes.any,d=(n(669).babelPluginFlowReactPropTypes_proptype_DOMRange||n(0).PropTypes.any,n(669).babelPluginFlowReactPropTypes_proptype_DOMHighlightSet||n(0).PropTypes.any),f=(n(669).babelPluginFlowReactPropTypes_proptype_DOMHighlight||n(0).PropTypes.any,n(680).babelPluginFlowReactPropTypes_proptype_TrackedSelection||n(0).PropTypes.any,function(e){function n(){return r(this,n),o(this,e.apply(this,arguments))}return i(n,e),n.prototype._handleAddHighlight=function(e){this.props.onAddHighlight(e);var t=document.getSelection();t&&t.collapseToEnd()},n.prototype._selectionIsValid=function(e){if(!e)return!1;var t=this.props.contentNode,n=new Range;n.selectNodeContents(t);var r=new Range;return r.setStart(e.focusNode,e.focusOffset),r.collapse(!0),u(n,r)},n.prototype.render=function(){var e=this;return s.createElement(c,{buildHighlight:this.props.buildHighlight,enabled:this.props.editable},function(n,r){return s.createElement("div",null,s.createElement(a,{editable:e.props.editable&&!e._selectionIsValid(n),highlights:e.props.highlights,offsetParent:e.props.offsetParent,onRemoveHighlight:e.props.onRemoveHighlight,zIndexes:e.props.zIndexes}),e._selectionIsValid(n)&&!r&&s.createElement(p,{label:t._("Add highlight"),onClick:function(){return e._handleAddHighlight(n.proposedHighlight)},focusNode:n.focusNode,focusOffset:n.focusOffset,offsetParent:e.props.offsetParent,zIndex:e.props.zIndexes.aboveContent}))})},n}(s.PureComponent));f.propTypes={buildHighlight:n(0).PropTypes.func.isRequired,contentNode:n(0).PropTypes.any.isRequired,editable:n(0).PropTypes.bool.isRequired,highlights:d,offsetParent:n(0).PropTypes.any.isRequired,onAddHighlight:n(0).PropTypes.func.isRequired,onRemoveHighlight:n(0).PropTypes.func.isRequired,zIndexes:h},e.exports=f}).call(t,n(23))},710:function(e,t,n){(function(t){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n(0),a=n(711),p=n(679),l=n(669).babelPluginFlowReactPropTypes_proptype_ZIndexes||n(0).PropTypes.any,u=(n(669).babelPluginFlowReactPropTypes_proptype_Position||n(0).PropTypes.any,n(669).babelPluginFlowReactPropTypes_proptype_DOMHighlightSet||n(0).PropTypes.any),c=function(e){function n(){var t,i,s;r(this,n);for(var a=arguments.length,p=Array(a),l=0;l<a;l++)p[l]=arguments[l];return t=i=o(this,e.call.apply(e,[this].concat(p))),i.state={mouseClientPosition:null,hoveringTooltipFor:null},i._highlightRenderers={},i._handleMouseMove=function(e){i.setState({mouseClientPosition:{left:e.clientX,top:e.clientY}})},s=t,o(i,s)}return i(n,e),n.prototype.componentDidMount=function(){this._updateEditListeners(!1,this.props.editable)},n.prototype.componentWillReceiveProps=function(e){this._updateEditListeners(this.props.editable,e.editable),"string"!=typeof this.state.hoveringTooltipFor||this.state.hoveringTooltipFor in e.highlights||this.setState({hoveringTooltipFor:null})},n.prototype.componentWillUnmount=function(){this._updateEditListeners(this.props.editable,!1)},n.prototype._updateEditListeners=function(e,t){!e&&t?window.addEventListener("mousemove",this._handleMouseMove):e&&!t&&(window.removeEventListener("mousemove",this._handleMouseMove),this.setState({mouseClientPosition:null}))},n.prototype._getHoveredHighlightKey=function(){var e=this,t=this.state.hoveringTooltipFor;return"string"==typeof t?t:Object.keys(this.props.highlights).find(function(t){var n=e._highlightRenderers[t];return n&&n.isHovered(e.state.mouseClientPosition)})},n.prototype._renderTooltip=function(){var e=this,n=this._getHoveredHighlightKey();if("string"!=typeof n)return null;var r=this.props.highlights[n];return s.createElement(p,{label:t._("Remove highlight"),focusNode:r.domRange.endContainer,focusOffset:r.domRange.endOffset,offsetParent:this.props.offsetParent,zIndex:this.props.zIndexes.aboveContent,onClick:function(){return e.props.onRemoveHighlight(n)},onMouseEnter:function(){return e.setState({hoveringTooltipFor:n})},onMouseLeave:function(){return e.setState({hoveringTooltipFor:null})}})},n.prototype.render=function(){var e=this;return s.createElement("div",null,Object.keys(this.props.highlights).map(function(t){return s.createElement(a,{ref:function(n){n?e._highlightRenderers[t]=n:delete e._highlightRenderers[t]},editable:e.props.editable,key:t,highlight:e.props.highlights[t],highlightKey:t,mouseClientPosition:e.state.mouseClientPosition,offsetParent:e.props.offsetParent,onRemoveHighlight:e.props.onRemoveHighlight,zIndexes:e.props.zIndexes})}),this.props.editable&&this._renderTooltip())},n}(s.PureComponent);c.propTypes={editable:n(0).PropTypes.bool.isRequired,highlights:u,offsetParent:n(0).PropTypes.any.isRequired,onRemoveHighlight:n(0).PropTypes.func.isRequired,zIndexes:l},e.exports=c}).call(t,n(23))},711:function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n(0),a=n(6),p=a.StyleSheet,l=a.css,u=n(678),c=u.getClientRectsForTextInRange,h=u.getRelativePosition,d=u.getRelativeRect,f=n(669).babelPluginFlowReactPropTypes_proptype_ZIndexes||n(0).PropTypes.any,g=(n(669).babelPluginFlowReactPropTypes_proptype_Rect||n(0).PropTypes.any,n(669).babelPluginFlowReactPropTypes_proptype_Position||n(0).PropTypes.any,n(669).babelPluginFlowReactPropTypes_proptype_DOMHighlight||n(0).PropTypes.any),m=function(e){function t(){var n,i,s;r(this,t);for(var a=arguments.length,p=Array(a),l=0;l<a;l++)p[l]=arguments[l];return n=i=o(this,e.call.apply(e,[this].concat(p))),i.state={cachedHighlightRects:i._computeRects(i.props),tooltipIsHovered:!1},s=n,o(i,s)}return i(t,e),t.prototype.componentWillReceiveProps=function(e){this.props.highlight===e.highlight&&this.props.offsetParent===e.offsetParent||this.setState({cachedHighlightRects:this._computeRects(e)})},t.prototype._computeRects=function(e){var t=e.highlight,n=e.offsetParent,r=c(t.domRange),o=n.getBoundingClientRect();return r.map(function(e){return d(e,o)})},t.prototype._rectIsHovered=function(e,t){var n=h(t,e);return 0<=n.left&&n.left<e.width&&0<=n.top&&n.top<e.height},t.prototype.isHovered=function(e){var t=this;if(!e)return!1;var n=this.props.offsetParent,r=this.state.cachedHighlightRects,o=n.getBoundingClientRect(),i=h(e,o);return r.some(function(e){return t._rectIsHovered(e,i)})},t.prototype.render=function(){var e=this,t=this.state.cachedHighlightRects;return s.createElement("div",null,t.map(function(t,n){return s.createElement("div",{key:n,className:l(y.highlightRect),style:{position:"absolute",width:t.width,height:t.height,top:t.top,left:t.left,zIndex:e.props.zIndexes.belowContent}})}))},t}(s.PureComponent);m.propTypes={highlight:g,highlightKey:n(0).PropTypes.string.isRequired,offsetParent:n(0).PropTypes.any.isRequired,zIndexes:f};var y=p.create({highlightRect:{background:"#fffabe"}});e.exports=m},712:function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n(0),a=(n(670).babelPluginFlowReactPropTypes_proptype_DOMRange||n(0).PropTypes.any,function(e){function t(){return r(this,t),o(this,e.apply(this,arguments))}return i(t,e),t.prototype.componentDidMount=function(){this._sendWordsUpdate()},t.prototype.componentDidUpdate=function(){this._sendWordsUpdate()},t.prototype._sendWordsUpdate=function(){this.props.onWordsUpdate(this._getWordRanges())},t.prototype._getWordRanges=function(){var e=this._container;if(!e)throw new Error("invariant violation: `this._container` is not defined, but this method is only called after mount/update");for(var t=e.ownerDocument.createTreeWalker(e,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,function(){return NodeFilter.FILTER_ACCEPT},!1),n=[],r=null;t.nextNode();){var o=t.currentNode;if(o.nodeType===Node.ELEMENT_NODE){var i=o;"inline"!==getComputedStyle(i).display&&(r=null)}else if(o.nodeType===Node.TEXT_NODE){for(var s=o.nodeValue,a=/\S+/g,p=void 0,l=null;null!==(p=a.exec(s));){var u=p.index,c=p.index+p[0].length,h=void 0;0===u&&r?(h=r,h.setEnd(o,c)):(h=o.ownerDocument.createRange(),h.setStart(o,u),h.setEnd(o,c),n.push(h)),c===s.length&&(l=h)}r=l}}return n},t.prototype.render=function(){var e=this;return s.createElement("div",{ref:function(t){return e._container=t}},this.props.children)},t}(s.PureComponent));a.propTypes={children:n(0).PropTypes.any,onWordsUpdate:n(0).PropTypes.func.isRequired},e.exports=a},713:function(e,t,n){function r(e,t){for(var n={},r=t.domRange,o=t.firstWordIndex,s=t.lastWordIndex,a=Object.keys(e),p=Array.isArray(a),l=0,a=p?a:a[Symbol.iterator]();;){var c;if(p){if(l>=a.length)break;c=a[l++]}else{if(l=a.next(),l.done)break;c=l.value}var h=c,d=e[h],f=u(d.domRange,r);f?(r=f,o=Math.min(d.firstWordIndex,o),s=Math.max(d.lastWordIndex,s)):n[h]=d}var g={firstWordIndex:o,lastWordIndex:s,domRange:r};return n[i(Object.keys(n))]=g,n}function o(e,t,n){for(var r=Object.keys(e),o=Array.isArray(r),i=0,r=o?r:r[Symbol.iterator]();;){var s;if(o){if(i>=r.length)break;s=r[i++]}else{if(i=r.next(),i.done)break;s=i.value}var a=s,p=e[a].domRange;if(h(p,n))return null}var u=l(n,t);if(!u)return null;var d=u[0],f=u[1],g=t[d],m=t[f];return{firstWordIndex:d,lastWordIndex:f,domRange:c(g,m)}}function i(e){var t=""+(new Date).getTime();if(!e.includes(t))return t;var n=0,r=void 0;do{r=t+"-"+n,n++}while(e.includes(r));return r}function s(e,t){var n=e.range,r=n.firstWordIndex,o=n.lastWordIndex,i=t[r];if(!i)throw new Error("first word index "+i+" is out of bounds: must be 0–"+(t.length-1)+" inclusive");var s=t[o];if(!s)throw new Error("last word index "+s+" is out of bounds: must be 0–"+(t.length-1)+" inclusive");return{firstWordIndex:r,lastWordIndex:o,domRange:c(i,s)}}function a(e){return{range:{type:"word-indexes",firstWordIndex:e.firstWordIndex,lastWordIndex:e.lastWordIndex}}}var p=n(672),l=p.findFirstAndLastWordIndexes,u=p.unionRanges,c=p.spanRanges,h=p.rangeIncludes;n(670).babelPluginFlowReactPropTypes_proptype_DOMRange||n(0).PropTypes.any,n(670).babelPluginFlowReactPropTypes_proptype_SerializedHighlight||n(0).PropTypes.any,n(670).babelPluginFlowReactPropTypes_proptype_DOMHighlightSet||n(0).PropTypes.any,n(670).babelPluginFlowReactPropTypes_proptype_DOMHighlight||n(0).PropTypes.any;e.exports={addHighlight:r,buildHighlight:o,deserializeHighlight:s,serializeHighlight:a}},714:function(e,t,n){(function(t){var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(0),i=n(147),s=n(1),a={display:"inline-block",width:0,visibility:"hidden"},p={display:"inline",whiteSpace:"nowrap"},l={display:"inline-block",color:"rgb(255, 255, 255)",backgroundColor:"rgb(90, 90, 90)",paddingLeft:10,paddingRight:10,userSelect:"none",WebkitUserSelect:"none"},u={display:"inline-block",color:"rgb(255, 255, 255)",backgroundColor:"rgb(90, 90, 90)",userSelect:"none",WebkitUserSelect:"none",width:22,height:22,borderRadius:"50%",textAlign:"center"},c=o.createClass({displayName:"RefStart",propTypes:{refContent:o.PropTypes.node.isRequired},render:function(){return o.createElement("span",{style:a},"_")},getRefContent:function(){return this.props.refContent}}),h=o.createClass({displayName:"RefEnd",render:function(){return o.createElement("span",{style:a},"_")}}),d={newline:i.defaultRules.newline,paragraph:i.defaultRules.paragraph,escape:i.defaultRules.escape,passageFootnote:{order:i.defaultRules.escape.order+.1,match:i.inlineRegex(/^\^/),parse:function(e,t,n){var r=n.lastFootnote.id+1,o={id:r,text:1===r?"*":""+r};return"*"===n.lastFootnote.text&&(n.lastFootnote.text=""+n.lastFootnote.id),n.lastFootnote=o,o},react:function(e,t,n){return o.createElement("sup",{key:n.key},e.text)}},refStart:{order:i.defaultRules.escape.order+.2,match:function(e,t){var n=/^\{\{/.exec(e);if(n){for(var r=2,o=0;r<e.length;){var i=e.slice(r,r+2);if("{{"===i)o++,r++;else if("}}"===i){if(!(o>0))break;o--,r++}r++}var s=e.slice(2,r);return[n[0],s]}return null},parse:function(e,t,n){if(!n.useRefs)return{ref:null,refContent:null};var r=n.lastRef+1;return n.lastRef=r,n.currentRef.push(r),{ref:r,refContent:t("(“"+e[1]+"”)\n\n",s.defaults({useRefs:!1},f))}},react:function(e,t,n){if(null==e.ref)return null;var r=t(e.refContent,{});return o.createElement(c,{ref:"start-ref-"+e.ref,key:"start-ref-"+e.ref,refContent:r})}},refEnd:{order:i.defaultRules.escape.order+.3,match:i.inlineRegex(/^\}\}/),parse:function(e,t,n){return n.useRefs?{ref:n.currentRef.pop()||null}:{ref:null}},react:function(e,t,n){return null!=e.ref?o.createElement(h,{ref:"end-ref-"+e.ref,key:"end-ref-"+e.ref}):null}},squareLabel:{order:i.defaultRules.escape.order+.4,match:i.inlineRegex(/^\[\[(\w+)\]\]( *)/),parse:function(e,t,n){return n.firstQuestionRef||(n.firstQuestionRef=e[1]),{content:e[1],space:e[2].length>0}},react:function(e,n,r){return[o.createElement("span",{key:"visual-square",className:"perseus-passage-square-label",style:p,"aria-hidden":"true"},o.createElement("span",{style:l},e.content)),o.createElement("span",{key:"alt-text",className:"perseus-sr-only"},t({number:e.content},"[Marker for question { number }]")),e.space?" ":null]}},circleLabel:{order:i.defaultRules.escape.order+.5,match:i.inlineRegex(/^\(\((\w+)\)\)( *)/),parse:function(e,t,n){return{content:e[1],space:e[2].length>0}},react:function(e,n,r){return[o.createElement("span",{key:"visual-circle",className:"perseus-passage-circle-label",style:p,"aria-hidden":!0},o.createElement("span",{style:u},e.content)),o.createElement("span",{key:"alt-text",className:"perseus-sr-only"},t({number:e.content},"[Circle marker { number }]")),e.space?" ":null]}},squareBracketRef:{order:i.defaultRules.escape.order+.6,match:i.inlineRegex(/^\[(\d+)\]( *)/),parse:function(e,t,n){return n.firstSentenceRef||(n.firstSentenceRef=e[1]),{content:e[1],space:e[2].length>0}},react:function(e,n,r){return[o.createElement("span",{key:"visual-brackets",className:"perseus-passage-bracket-label","aria-hidden":"true"},"[",e.content,"]"),o.createElement("span",{key:"alt-text",className:"perseus-sr-only"},t({number:e.content},"[Sentence { number }]")),e.space?" ":null]}},highlight:{order:i.defaultRules.escape.order+.7,match:i.inlineRegex(/^{highlighting.start}(.+?){highlighting.end}/),parse:function(e,t,n){return{content:e[1]}},react:function(e,t,n){return[o.createElement("span",{className:"perseus-highlight"},e.content)]}},reviewHighlight:{order:i.defaultRules.escape.order+.7,match:i.inlineRegex(/^{review-highlighting.start}(.+?){review-highlighting.end}/),parse:function(e,t,n){return{content:e[1]}},react:function(e,t,n){return[o.createElement("span",{className:"perseus-review-highlight"},e.content)]}},strong:i.defaultRules.strong,u:i.defaultRules.u,em:i.defaultRules.em,del:i.defaultRules.del,text:r({},i.defaultRules.text,{react:function(e,t,n){return o.createElement("span",{key:n.key},e.content)}})},f={currentRef:[],useRefs:!0,lastRef:0,lastFootnote:{id:0,text:""}},g=i.parserFor(d),m=function(e,t){return t=t||{},g(e+"\n\n",s.extend(t,f))};e.exports={parse:m,output:i.reactFor(i.ruleOutput(d,"react")),START_REF_PREFIX:"start-ref-",END_REF_PREFIX:"end-ref-",_rulesForTesting:d}}).call(t,n(245))},715:function(e,t,n){var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(0),i=n(1),s=n(143),a=n(242),p=n(32),l=n(22),u=l.linterContextProps,c=l.linterContextDefault,h=o.createClass({displayName:"PassageRefTarget",propTypes:r({},s.propTypes,{content:o.PropTypes.string,linterContext:u}),getDefaultProps:function(){return{content:"",linterContext:c}},getUserInput:function(){return a.getUserInput.call(this)},render:function(){return o.createElement(p,{content:this.props.content,inline:!0,apiOptions:this.props.apiOptions,linterContext:this.props.linterContext})},change:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.change.apply(this,t)},simpleValidate:function(e){return h.validate(this.getUserInput(),e)}});i.extend(h,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),e.exports={name:"passage-ref-target",displayName:"PassageRefTarget",defaultAlignment:"inline",widget:h,hidden:!0,transform:function(e){return i.pick(e,"content")},version:{major:0,minor:0},isLintable:!0}},716:function(e,t,n){(function(t){var r=n(0),o=n(8),i=n(1),s=n(13).ClassNames,a=n(19).deepEq,p=n(43),l=n(42),u=n(144),c=n(243),h=n(93),d=(r.PropTypes.oneOf(["bar","line","pic","histogram","dotplot"]),r.PropTypes.arrayOf(r.PropTypes.string),r.PropTypes.arrayOf(r.PropTypes.oneOfType([r.PropTypes.number,r.PropTypes.string])),r.PropTypes.number,r.PropTypes.number,r.PropTypes.number,r.PropTypes.number,r.PropTypes.number,r.PropTypes.string,r.PropTypes.arrayOf(r.PropTypes.number),r.PropTypes.number,r.PropTypes.arrayOf(r.PropTypes.number),r.PropTypes.bool,r.createClass({displayName:"Plotter",propTypes:{onChange:r.PropTypes.func.isRequired,trackInteraction:r.PropTypes.func.isRequired},getDefaultProps:function(){return{type:"bar",labels:["",""],categories:[""],scaleY:1,maxY:10,snapsPerLine:2,picSize:40,picBoxHeight:48,picUrl:"",plotDimensions:[380,300],labelInterval:1}},getInitialState:function(){return{values:this.props.starting||[1]}},DOT_PLOT_POINT_SIZE:function(){return this.props.apiOptions.isMobile?6:4},DOT_PLOT_POINT_PADDING:function(){return 8},DOT_TICK_POINT_SIZE:function(){return 2},render:function(){var e={marginBottom:this.props.labels[0]?75:0};return r.createElement("div",{className:"perseus-widget-plotter graphie "+s.INTERACTIVE,ref:"graphieDiv",style:e})},componentDidUpdate:function(e,t){this.shouldSetupGraphie&&this.setupGraphie(t)},componentDidMount:function(){this.setupGraphie(this.state)},componentWillReceiveProps:function(e){var t=["type","labels","categories","scaleY","maxY","snapsPerLine","picUrl","labelInterval","static"];this.shouldSetupGraphie=i.any(t,function(t){return!i.isEqual(this.props[t],e[t])},this),i.isEqual(this.props.starting,e.starting)||i.isEqual(this.state.values,e.starting)||(this.shouldSetupGraphie=!0,this.setState({values:e.starting}))},setupGraphie:function(e){var n=this;n.shouldSetupGraphie=!1;var r=o.findDOMNode(n.refs.graphieDiv);t(r).empty();var s=u.createGraphie(r);n.graphie=s,n.graphie.pics=[],n.graphie.dotTicks=[];var a="bar"===n.props.type,c="line"===n.props.type,d="pic"===n.props.type,f="histogram"===n.props.type,g="dotplot"===n.props.type,m=d||g,y={},v=y,b=this.props.apiOptions.isMobile;v.graph={lines:[],bars:[],points:[],dividers:[]},v.scaleY=n.props.scaleY,v.dimX=n.props.categories.length;var T=b?[288,336]:n.props.plotDimensions;if(c)v.dimX+=b?-.2:1;else if(f)v.barPad=0,v.barWidth=1;else if(a)v.barPad=b?.08:.15,v.barWidth=1-2*v.barPad,v.dimX+=(b?-2:2)*v.barPad;else if(m){v.picBoxHeight=n.props.picBoxHeight,v.picBoxWidthPx=T[0]/n.props.categories.length;var P=T[0]-v.dimX*v.picBoxWidthPx;v.picPad=P/(2*v.dimX+2);var x=v.picBoxWidthPx+2*v.picPad;v.picPad=v.picPad/x,v.picBoxWidth=v.picBoxWidthPx/x,v.dimX+=2*v.picPad}g&&(v.picBoxHeight=2*this.DOT_PLOT_POINT_SIZE()+this.DOT_PLOT_POINT_PADDING()),v.dimY=Math.ceil(n.props.maxY/v.scaleY)*v.scaleY;var C=25,w=25;if((a||c)&&b&&(C=0!==n.props.labels[1].length?17:11),g&&(C/=2),b&&m&&0===n.props.labels[1].length&&(C=0),v.scale=b?i.map([[v.dimX,C],[v.dimY,w]],function(e,t){var n=e[0],r=e[1];return(T[t]-4*r)/n}):i.map([v.dimX,v.dimY],function(e,t){return T[t]/e}),C/=v.scale[0],w/=v.scale[1],m&&(v.scale[1]=v.picBoxHeight/v.scaleY),s.init({range:[[-3*C,v.dimX+C],[-3*w,v.dimY+w]],scale:v.scale,isMobile:this.props.apiOptions.isMobile}),s.addMouseLayer({allowScratchpad:!0,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable}),!m)for(var E=b?v.scaleY:0,k=E;k<=v.dimY;k+=v.scaleY)s.label([0,k],p.roundToApprox(k,2),"left",!0),s.style({stroke:b?"#e9ebec":"#000",strokeWidth:1,opacity:b?1:.3},function(){s.line([0,k],[v.dimX,k])});(a||c)&&b&&(n.graphie.dragPrompt=s.label([v.dimX/2,v.dimY/2],"Drag handles to make graph","center",!1).css("font-weight","bold").css("color",l.KA_GREEN).css("display","none")),n.setupCategories(y),m&&b&&(n.graphie.dotPrompt=s.label([v.dimX/2,v.dimY/2],"Tap to add points","center",!1).css("font-weight","bold").css("color",l.KA_GREEN).css("display","none")),m&&n.drawPicHeights(n.state.values,e.values),s.style({stroke:"#000",strokeWidth:2,opacity:1},function(){m?g?s.style({stroke:b?l.GRAY_G:"#000",strokeWidth:b?1:2},function(){return s.line([b?0:.5,0],[v.dimX-(b?0:.5),0])}):(s.line([0,0],[v.dimX,0]),0===n.props.labels[1].length&&b||s.style({stroke:b?l.GRAY_G:"#000",strokeWidth:b?1:2},function(){return s.line([0,0],[0,v.dimY])})):(s.style({stroke:b?l.GRAY_G:"#000",strokeWidth:b?1:2},function(){return s.line([b?3*-C:0,0],[v.dimX+(b?C:0),0])}),(a||c)&&b||s.style({stroke:b?l.GRAY_G:"#000",strokeWidth:b?1:2},function(){return s.line([0,0],[0,v.dimY])}))}),s.label([v.dimX/2,b?3*-w:-35/v.scale[1]],n.props.labels[0],b?"above":"below",!1).css("font-weight","bold").css("color",b&&l.GRAY_F),s.label([(b?-35:-60)/v.scale[0],v.dimY/2],n.props.labels[1],"center",!1).css("font-weight","bold").css("color",b&&l.GRAY_F).addClass("rotate"),this.props.apiOptions.isMobile&&(this.horizHairline=new h(this.graphie,[0,0],[0,0],{normalStyle:{strokeWidth:1}}),this.horizHairline.attr({stroke:l.INTERACTIVE}),this.horizHairline.hide(),this.hairlineRange=[[0,v.dimX],[0,v.dimY]])},showHairlines:function(e){this.props.apiOptions.isMobile&&"none"!==this.props.markings&&(this.horizHairline.moveTo([this.hairlineRange[0][0],e[1]],[this.hairlineRange[0][1],e[1]]),this.horizHairline.show())},hideHairlines:function(){this.props.apiOptions.isMobile&&this.horizHairline.hide()},labelCategory:function(e,t){var n=this.props.apiOptions.isMobile,r=this.graphie;t+="";var o=!1,i=t.match(/^\$(.*)\$$/);i&&(t=i[1],o=!0);this.props.labels[0].length;r.style({color:n?l.GRAY_G:"inherit",transform:n&&!i?"translateX(-50%) translateX(5px) translateY(-50%) rotate(-45deg)":"none",transformOrigin:"100%"},function(){return r.label([e,n?-.5:0],t,"below",o)})},setupCategories:function(e){var t=this,n=e,r=t.graphie,o=this.props.apiOptions.isMobile;"histogram"===t.props.type?(i.times(t.props.categories.length-1,function(n){t.setupBar({index:n,startHeight:t.state.values[n],config:e,isHistogram:!0})}),i.each(t.props.categories,function(e,i){var s=.5+i*n.barWidth;t.labelCategory(s,e);var a=6/n.scale[1];r.style({stroke:"#000",strokeWidth:o?1:2,opacity:1},function(){r.line([s,-a],[s,0])})})):i.each(t.props.categories,function(i,s){var a,p=t.state.values[s];"bar"===t.props.type?a=t.setupBar({index:s,startHeight:p,config:e,isHistogram:!1}):"line"===t.props.type?a=t.setupLine(s,p,e):"pic"===t.props.type?a=t.setupPic(s,e):"dotplot"===t.props.type&&(a=t.setupDotplot(s,e));var u=0,c=-6/n.scale[1];"dotplot"!==t.props.type||o||(u=-c),"dotplot"===t.props.type?s%t.props.labelInterval!=0&&s!==t.props.categories.length-1||(t.labelCategory(a,i),u*=1.5,c*=1.5):t.labelCategory(a,i),r.style({stroke:o?l.GRAY_G:"#000",strokeWidth:o?1:2,opacity:1},function(){r.line([a,u],[a,c])})})},_clampValue:function(e,t,n){return Math.max(Math.min(e,n),t)},_maybeShowDragPrompt:function(){null!=this.graphie.dragPrompt&&(this.graphie.dragPrompt[0].style.display="inline")},_maybeHideDragPrompt:function(){null!=this.graphie.dragPrompt&&(this.graphie.dragPrompt[0].style.display="none")},setupBar:function(e){var t,n=this,r=this.props.apiOptions.isMobile,o=e.index,s=e.startHeight,a=e.config,p=e.isHistogram,u=this,h=u.graphie,d=a.barWidth/2;t=p?.5+o*a.barWidth+d:(r?d:.5+a.barPad)+o;var f=function(e,t){var n=h.scalePoint(0);if(a.graph.bars[e].scale(1,Math.max(r?.2:.01,t/a.scaleY),n[0],n[1]),p){var o=a.graph.dividers[e-1],i=a.graph.dividers[e];if(o){var s=Math.min(u.state.values[e-1],t);o.scale(1,Math.max(.01,s/a.scaleY),n[0],n[1])}if(i){var s=Math.min(u.state.values[e+1],t);i.scale(1,Math.max(.01,s/a.scaleY),n[0],n[1])}}};if(h.style({stroke:"none",fill:r?l.BLUE_C:l.LIGHT_BLUE,opacity:1},function(){a.graph.bars[o]=h.path([[t-d,0],[t-d,a.scaleY],[t+d,a.scaleY],[t+d,0],[t-d,0]])}),p&&o>0&&h.style({stroke:"#000",strokeWidth:1,opacity:.3},function(){a.graph.dividers.push(h.path([[t-d,0],[t-d,a.scaleY]]))}),r){var g=a.scaleY/u.props.snapsPerLine;a.graph.lines[o]=c.addMaybeMobileMovablePoint(this,{coord:[t,s],constraints:[function(e,r,o){return[t,n._clampValue(Math.round(e[1]/g)*g,0,a.dimY)]}],onMoveStart:function(){a.graph.bars[o].attr({fill:l.INTERACTIVE})},onMove:function(){var e=a.graph.lines[o].coord()[1],t=i.clone(u.state.values);t[o]=e,u.setState({values:t}),u.changeAndTrack({values:t}),u._maybeHideDragPrompt(),f(o,e)},onMoveEnd:function(){a.graph.bars[o].attr({fill:l.BLUE_C})}}),a.graph.lines[o].state.visibleShape.wrapper.style.zIndex="1",u._maybeShowDragPrompt()}else a.graph.lines[o]=h.addMovableLineSegment({coordA:[t-d,s],coordZ:[t+d,s],snapY:a.scaleY/u.props.snapsPerLine,constraints:{constrainX:!0},normalStyle:{stroke:l.INTERACTIVE,"stroke-width":this.props.static?0:4}}),a.graph.lines[o].onMove=function(e,t){var n=this.coordA[1];(n<0||n>a.dimY)&&(n=Math.min(Math.max(n,0),a.dimY),this.coordA[1]=this.coordZ[1]=n,this.transform());var r=i.clone(u.state.values);r[o]=n,u.setState({values:r}),u.changeAndTrack({values:r}),f(o,n)};return f(o,s),t},setupLine:function(e,t,n){var r=this,o=this.props.apiOptions.isMobile,s=this,a=n,p=s.graphie,u=e+(o?.4:1);if(o){var h=n.scaleY/s.props.snapsPerLine;a.graph.points[e]=c.addMaybeMobileMovablePoint(this,{coord:[u,t],constraints:[function(e,t,o){return[u,r._clampValue(Math.round(e[1]/h)*h,0,n.dimY)]}],onMove:function(){var t=a.graph.points[e].coord()[1],n=i.clone(s.state.values);n[e]=t,s.setState({values:n}),s.changeAndTrack({values:n}),s._maybeHideDragPrompt()}}),s._maybeShowDragPrompt(),e>0&&(a.graph.lines[e]=c.addMovableLine(p,{points:[a.graph.points[e-1],a.graph.points[e]],constraints:c.MovablePoint.constraints.fixed(),normalStyle:{stroke:l.BLUE_C,"stroke-width":2},highlightStyle:{stroke:l.BLUE_C,"stroke-width":2}}))}else a.graph.points[e]=p.addMovablePoint({coord:[u,t],constraints:{constrainX:!0},normalStyle:{fill:l.INTERACTIVE,stroke:l.INTERACTIVE},snapY:a.scaleY/s.props.snapsPerLine}),a.graph.points[e].onMove=function(t,n){n=Math.min(Math.max(n,0),a.dimY);var r=i.clone(s.state.values);return r[e]=n,s.setState({values:r}),s.changeAndTrack({values:r}),[t,n]},e>0&&(a.graph.lines[e]=p.addMovableLineSegment({pointA:a.graph.points[e-1],pointZ:a.graph.points[e],constraints:{fixed:!0},normalStyle:{stroke:"#9ab8ed","stroke-width":2}}));return u},setupDotplot:function(e,t){var n=this,r=this.graphie,o=this.props.apiOptions.isMobile;return this.setupTiledPlot(e,o?.5:1,t,function(e,t){return r.ellipse([e,t],[n.DOT_PLOT_POINT_SIZE()/r.scale[0],n.DOT_PLOT_POINT_SIZE()/r.scale[1]],{fill:l.INTERACTIVE,stroke:l.INTERACTIVE})})},setupPic:function(e,t){var n=this,r=this.graphie;return this.setupTiledPlot(e,0,t,function(e,t){var o=r.scalePoint([e,t]),i=n.props.picSize;return r.raphael.image(n.props.picUrl,o[0]-i/2,o[1]-i/2,i,i)})},setupTiledPlot:function(e,n,r,o){var s=this,a=r,p=s.graphie,l=p.pics,u=p.dotTicks,c=e+.5+a.picPad;p.mouselayer.canvas.style.touchAction="none",l[e]=[],u[e]=[];var h=Math.round(a.dimY/a.scaleY)+1;return i(h).times(function(r){r-=1;var i=(r+.5)*a.scaleY,h=c-a.picBoxWidth/2,d=i+.5*a.scaleY,f=p.scalePoint([h,d+n]),g=p.mouselayer.rect(f[0],f[1],a.picBoxWidthPx,a.picBoxHeight);t(g[0]).css({fill:"#000",opacity:0,cursor:"pointer"}).on("vmousedown",function(r){r.preventDefault(),s.whichPicClicked=e,s.setPicHeight(e,d),t(document).on("vmouseup.plotTile",function(e){t(document).unbind(".plotTile")}),t(document).on("vmousemove.plotTile",function(e){e.preventDefault();var t=p.getMouseCoord(e)[1],r=Math.floor(t-n),o=Math.max(-1,Math.floor(r/a.scaleY)),i=(o+.5)*a.scaleY,l=i+.5*a.scaleY;s.setPicHeight(s.whichPicClicked,l)})}),r<0||(l[e][r]=o(c,i+n),u[e][r]=p.ellipse([c,i+n],[s.DOT_TICK_POINT_SIZE()/p.scale[0],s.DOT_TICK_POINT_SIZE()/p.scale[1]],{fill:"#dee1e3",stroke:"#dee1e3"}))}),c},setPicHeight:function(e,t){var n=i.clone(this.state.values);n[e]=t,this.drawPicHeights(n,this.state.values),this.setState({values:n}),this.changeAndTrack({values:n})},changeAndTrack:function(e){this.props.onChange(e),this.props.trackInteraction()},drawPicHeights:function(e,n){var r=this,o=r.graphie,s=o.pics,a=this.props.apiOptions.isMobile;if(a){var p=e.every(function(e){return 0===e});o.dotPrompt[0].style.display=p?"inline":"none"}i.each(s,function(s,p){i.each(s,function(i,s){var l=(s+1)*r.props.scaleY,u=l<=e[p];if("dotplot"===r.props.type){var c=l<=n[p];u&&!c&&i.animate({"stroke-width":8},75,function(){return i.animate({"stroke-width":2},75)})}t(i[0]).css({display:u?"inline":"none"}),o.dotTicks[p][s][0].style.display=u||!a?"none":"inline"})})},getUserInput:function(){return this.state.values},simpleValidate:function(e){return d.validate(this.getUserInput(),e)}}));i.extend(d,{validate:function(e,t){return a(e,t.starting)?{type:"invalid",message:null}:{type:"points",earned:a(e,t.correct)?1:0,total:1,message:null}}});var f=i.identity;e.exports={name:"plotter",displayName:"Plotter",widget:d,staticTransform:f}}).call(t,n(10))},717:function(e,t,n){var r=n(0),o=n(677).molecule,i=r.createClass({displayName:"Separator",propTypes:{data:r.PropTypes.any,index:r.PropTypes.number},componentDidMount:function(){this.drawArrow()},componentDidUpdate:function(){this.drawArrow()},arrowLength:100,drawArrow:function(){var e=this.refs["arrowCanvas"+this.props.index],t=e.getContext("2d");t.clearRect(0,0,e.width,e.height);var n=new Path2D;t.strokeStyle="rgb(0,0,0)",t.lineWidth=1.2,t.lineCap="round";n.moveTo(5,e.height/2),n.lineTo(e.width-5,e.height/2),n.moveTo(e.width-10,e.height/2-5),n.lineTo(e.width-5,e.height/2),n.moveTo(e.width-10,e.height/2+5),n.lineTo(e.width-5,e.height/2),t.stroke(n)},render:function(){return r.createElement("div",{className:"arrow-container"},r.createElement("div",{className:"above-text"},this.props.data.topText),r.createElement("canvas",{height:"30",id:"arrowCanvas"+this.props.index,ref:"arrowCanvas"+this.props.index,width:this.arrowLength},"Reaction arrow pointing to the right."),r.createElement("div",{className:"below-text"},this.props.data.bottomText))}}),s=r.createClass({displayName:"ReactionDiagramWidget",propTypes:{rotationAngle:r.PropTypes.arrayOf(r.PropTypes.number),separators:r.PropTypes.arrayOf(r.PropTypes.object),smiles:r.PropTypes.arrayOf(r.PropTypes.string),widgetId:r.PropTypes.string},getDefaultProps:function(){return{smiles:[],rotationAngle:[],separators:[]}},simpleValidate:function(){return{type:"points",earned:0,total:0,message:null}},getUserInput:function(){return[]},validate:function(e,t){return{type:"points",earned:0,total:0,message:null}},focus:function(){return!0},render:function(){var e=this;return r.createElement("div",{className:"reaction",ref:"reaction"},this.props.smiles.map(function(t,n){var s=e.props.widgetId+"-"+n;return r.createElement("div",{key:s,className:"molecule-container"},r.createElement(o,{id:s,rotationAngle:e.props.rotationAngle[n],smiles:t}),n===e.props.smiles.length-1?null:r.createElement(i,{data:e.props.separators[n],index:n}))}))}});e.exports={name:"reaction-diagram",displayName:"Chemical reaction",hidden:!0,widget:s}},718:function(e,t,n){var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(0),i=n(1),s=n(13).Options,a=n(143),p=n(90),l=p.iconOk,u=n(91),c=n(32),h=n(19),d=n(22),f=d.linterContextProps,g=d.linterContextDefault,m=o.createClass({displayName:"Sequence",propTypes:r({},a.propTypes,{apiOptions:s.propTypes,json:o.PropTypes.arrayOf(o.PropTypes.shape({content:o.PropTypes.string,images:o.PropTypes.object,widgets:o.PropTypes.object})),trackInteraction:o.PropTypes.func.isRequired,linterContext:f}),getDefaultProps:function(){return{json:[{content:"",widgets:{},images:{}}],linterContext:g}},getInitialState:function(){return{visible:1}},shouldComponentUpdate:function(e,t){return e!==this.props||t!==this.state},render:function(){var e=this,t=o.createElement(u,r({},l,{style:{color:"green"}})),n=i.chain(this.props.json).first(this.state.visible).map(function(e,t){return"[["+h.snowman+" group "+t+"]]"}).join("\n\n").value(),s={};return i.each(this.props.json,function(n,r){s["group "+r]={type:"group",graded:!0,version:{major:0,minor:0},options:i.extend({},n,{icon:r<e.state.visible-1?t:null})}}),o.createElement("div",{className:"perseus-sequence"},o.createElement(c,{ref:"renderer",content:n,widgets:s,onInteractWithWidget:this._handleInteraction,apiOptions:this.props.apiOptions,linterContext:this.props.linterContext}))},change:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.change.apply(this,t)},_handleInteraction:function(e){var t=parseInt(e.split(" ")[1]);if(t===this.state.visible-1){var n=this.refs.renderer.getWidgetInstance("group "+t);n.showRationalesForCurrentlySelectedChoices();var r=n.simpleValidate();"points"===r.type&&r.total===r.earned&&(this.setState({visible:this.state.visible+1}),this.props.trackInteraction({visible:this.state.visible+1}))}}}),y=function(e,t){var n=e.json;i.isArray(n)||(n=[n]);var r=i.map(n,function(e){return t(e)});return i.extend({},e,{json:r})};e.exports={name:"sequence",displayName:"Graded Sequence",widget:m,traverseChildWidgets:y,tracking:"all",hidden:!0,isLintable:!0}},719:function(e,t,n){(function(t){var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(675),i=n(0),s=n(8),a=n(1),p=n(143),l=n(13).Options,u=n(33).assert,c=n(241),h=c.Path,d=c.Arc,f=(c.Circle,c.Label),g=c.Line,m=c.MovablePoint,y=c.MovableLine,v=n(671),b=n(240),T=(n(19).seededRNG,n(19)),P=n(9).number,x=n(42),C=n(43),w=i.createClass({displayName:"Histogram",propTypes:{data:i.PropTypes.arrayOf(i.PropTypes.number),xAxisLabel:i.PropTypes.string,yAxisLabel:i.PropTypes.string,box:i.PropTypes.arrayOf(i.PropTypes.number)},getDefaultProps:function(){return{data:null,xAxisLabel:"Proportion (%)",yAxisLabel:"Number of times seen",box:[400,400]}},getInitialState:function(){return{threshold:this._getInitialThreshold(this._range())}},componentWillReceiveProps:function(e){var t=this._range(),n=this._range(e);T.deepEq(t,n)||this.setState({threshold:this._getInitialThreshold(n)})},_renderThresholdLine:function(){var e=this,t=[0,this._range()[1][1]],n=a.map(t,function(t){return[e.state.threshold,t]}),r=function(e,t){return i.createElement(m,{key:t,static:!0,coord:e,normalStyle:{stroke:"none",fill:"none"}})};return i.createElement(y,{onMove:this.handleMouseInteraction},a.map(n,r))},_renderCircle:function(){var e=this,t=this.props.data,n=a.reduce(t,function(e,t){return e+t},0),r=a.reduce(t,function(t,n,r){return null!=e.state.threshold&&r<=e.state.threshold?t+n:t},0),o=r/n,s=[this.props.box[0]-30,30],p=this._range()[0],l=Math.min(Math.max(this.state.threshold,p[0]),p[1]).toFixed(2);return[o>0&&function(){var e={key:"below",center:s,radius:20,startAngle:0,endAngle:o<1?360*o:360-1e-5,sector:1!==o,unscaled:!0,style:{fill:x.LIGHT_RED,stroke:x.RED}};return i.createElement(d,e)}(),o<1&&function(){var e={key:"above",center:s,radius:20,startAngle:o>0?360*o:1e-5,endAngle:360,sector:0!==o,unscaled:!0,style:{fill:x.LIGHT_BLUE,stroke:x.BLUE}};return i.createElement(d,e)}(),function(){var e={key:"label",coord:[s[0],s[1]+30],text:r+" of "+n+" results below "+l+"%",direction:"center",tex:!1,unscaled:!0,style:{fontSize:"12px"}};return i.createElement(f,e)}()]},_renderData:function(){var e=this,t=this.props.data,n=(this._range(),function(t,n){if(t){var r=null!=e.state.threshold&&n<=e.state.threshold,o={fill:r?x.LIGHT_RED:x.LIGHT_BLUE,stroke:r?x.RED:x.BLUE},s=[[n,0],[n,t],[n+1,t],[n+1,0]];return i.createElement(h,{key:n,coords:s,style:o})}});return a.map(t,n)},render:function(){var e=this.props.data,t=this._range(),n={xAxisLabel:this.props.xAxisLabel,yAxisLabel:this.props.yAxisLabel,box:this.props.box,range:t,data:e,scale:[T.scaleFromExtent(t[0],this.props.box[0]),T.scaleFromExtent(t[1],this.props.box[1])]},r={stroke:"#000",strokeWidth:1,opacity:1},o=[t[0][0],0],s=[t[0][1],0];return i.createElement(c,{box:n.box,range:n.range,options:n,setup:this._setupGraphie,onMouseMove:this.handleMouseInteraction,onMouseDown:this.handleMouseInteraction,setDrawingAreaAvailable:this.props.setDrawingAreaAvailable},i.createElement(g,{start:o,end:s,style:r}),e&&this._renderData(),e&&this._renderCircle(),e&&this._renderThresholdLine())},_setupGraphie:function(e,t){var n=t.data,r=t.range,o=t.scale,i=r[0][1]-r[0][0],s=r[1][1]-0,p=Math.ceil(s/20);if(a.each(a.range(0,r[1][1],p),function(t){n&&e.label([r[0][0],t],C.roundToApprox(t,2),"left",!0),e.line([r[0][0],t],[r[0][1],t],{stroke:"#000",strokeWidth:1,opacity:.3})}),n){var l=Math.ceil(i/15);a.each(a.range(r[0][0],r[0][1],l),function(t){e.label([t,0],P.round(t,2),"below",!0);e.line([t,0],[t,-8/o[1]],{stroke:"#000",strokeWidth:1})})}var u={stroke:"#000",strokeWidth:2,opacity:1},c=[r[0][0],0],h=[r[0][0],r[1][1]];e.line(c,h,u);var d=r[0][0]+i/2,f=n?25:0;e.label([d,-f/o[1]],t.xAxisLabel,"below",!1).css("font-weight","bold");var g=0+s/2,m=n?55:28;e.label([r[0][0]-m/o[0],g],t.yAxisLabel,"center",!1).css("font-weight","bold").css("-webkit-transform","rotate(-90deg)")},handleMouseInteraction:function(e){this.setState({threshold:e[0]})},_range:function(e){var t=[[0,100],[-1,10]];return e=e||this.props,e.data?this._getRangeForData(e.data):t},_getRangeForData:function(e){var t=a.indexOf(e,a.find(e,function(e){return e>0})),n=Math.max(0,t-10),r=a.lastIndexOf(e,a.last(a.filter(e,function(e){return e>0}))),o=Math.min(101,r+1+10);return[[n,o],[-1,a.max(e)]]},_getInitialThreshold:function(e){var t=e[0];return t[0]+(t[1]-t[0])/3}}),E=i.createClass({displayName:"Simulator",propTypes:r({},p.propTypes,{apiOptions:l.propTypes,data:i.PropTypes.arrayOf(i.PropTypes.number),numTrials:i.PropTypes.number,proportionLabel:i.PropTypes.string,proportionOrPercentage:i.PropTypes.string,randomSeed:i.PropTypes.number,sampleSize:i.PropTypes.number,trackInteraction:i.PropTypes.func.isRequired,userProportion:i.PropTypes.number,xAxisLabel:i.PropTypes.string,yAxisLabel:i.PropTypes.string}),getInitialState:function(){return{invalidInput:!1}},getDefaultProps:function(){return{data:null,userProportion:null,sampleSize:null,numTrials:null,randomSeed:0,xAxisLabel:"Proportion (%)",yAxisLabel:"Number of times seen",proportionLabel:"Underlying proportion",proportionOrPercentage:"proportion",apiOptions:l.defaults}},componentWillMount:function(){null!=this.props.randomSeed&&(this.generateNumber=T.seededRNG(this.props.randomSeed))},componentWillReceiveProps:function(e){e.randomSeed!==this.props.randomSeed&&(this.generateNumber=T.seededRNG(e.randomSeed))},render:function(){var e=this,n={marginLeft:"5px"},r="0px 0px 0px 2px rgba(255, 165, 0, 1)",s=a.extend({},n,{WebkitBoxShadow:r,MozBoxShadow:r,boxShadow:r,transition:"all 0.15s"}),p=a.extend({},n,{transition:"all 0.15s"}),l=this.state.invalidInput?s:p,u=this.props.apiOptions.staticRender?b:v,c=i.createElement("div",null,i.createElement(u,{ref:"userProportion",style:l,value:this.calculateDisplayProportion(),checkValidity:this.checkProportionValidity,disabled:this.props.apiOptions.readOnly,onChange:this.handleUserProportionChange,onFocus:function(){return e.props.onFocus(["userProportion"])},onBlur:function(){return e.props.onBlur(["userProportion"])}}),i.createElement(o,null,i.createElement("p",null,"This controls the proportion or percentage that will be used in your simulation."))),h=i.createElement("div",null,i.createElement(u,{ref:"sampleSize",style:l,value:this.props.sampleSize,checkValidity:function(e){return e>=0},disabled:this.props.apiOptions.readOnly,onChange:this.handleSampleSizeChange,onFocus:function(){return e.props.onFocus(["sampleSize"])},onBlur:function(){return e.props.onBlur(["sampleSize"])}}),i.createElement(o,null,i.createElement("p",null,"This controls the sample size that will be used in your simulation. For example, if you set this to 100, then for each trial, responses from 100 participants will be simulated."))),d=i.createElement("div",{style:{textAlign:"right"}},i.createElement("b",null,this.props.numTrials),i.createElement(o,null,i.createElement("p",null,"This is the number of trials used in the simulation. For example, if set to 50, then the survey will be conducted 50 times."))),f=[{title:this.props.proportionLabel+":",value:c},{title:"Sample size:",value:h},{title:"Number of trials:",value:d}],g={margin:"20px 0"},m=i.createElement("button",{className:"simple-button",style:g,disabled:this.props.apiOptions.readOnly,onClick:this.handleRunSimulation},t._("Run simulation")),y={paddingBottom:this.props.data?40:0},T=i.createElement("div",{style:y},i.createElement(w,{data:this.props.data,xAxisLabel:this.props.xAxisLabel,yAxisLabel:this.props.yAxisLabel,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable}));return i.createElement("div",null,function(e){var t=i.createElement("thead",null,i.createElement("tr",null,i.createElement("th",null,"Parameter"),i.createElement("th",null,"Value"))),n=i.createElement("tbody",null,a.map(e,function(e,t){return i.createElement("tr",{key:t},i.createElement("td",null,e.title),i.createElement("td",null,e.value))}));return i.createElement("table",null,t,n)}(f),m,T)},calculateDisplayProportion:function(){var e=this.props.userProportion;return"percentage"===this.props.proportionOrPercentage?Math.round(100*e):e},change:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return p.change.apply(this,t)},checkProportionValidity:function(e){return e>=0&&"proportion"===this.props.proportionOrPercentage&&e<=1||"percentage"===this.props.proportionOrPercentage&&e<=100},handleUserProportionChange:function(e,t){var n;n="percentage"===this.props.proportionOrPercentage?e/100:e,null!=n&&(n=Math.min(1,Math.max(0,n))),this.props.onChange({userProportion:n},t)},handleSampleSizeChange:function(e,t){null!=e&&(e=Math.min(1e3,Math.max(0,Math.floor(e)))),this.props.onChange({sampleSize:e},t)},handleRunSimulation:function(){if(null==this.props.numTrials||null==this.props.userProportion||null==this.props.sampleSize)return void this.setState({invalidInput:!0});this.setState({invalidInput:!1}),this.props.onChange({data:this.generateData()}),this.props.trackInteraction()},generateData:function(e){var t=this;return e=e||this.props,function(e,n,r){var o=function(){return t.generateNumber()<r},i=a.times(101,function(){return 0});return a.times(n,function(){var t=a.times(e,o),n=a.filter(t,a.identity).length,r=Math.floor(100*n/e);i[r]++}),i}(e.sampleSize,e.numTrials,e.userProportion)},getInputPaths:function(){return[["userProportion"],["sampleSize"]]},focus:function(){var e=a.head(this.getInputPaths());return this.focusInputPath(e),!0},focusInputPath:function(e){u(e.length>0);var t=a.head(e);this.refs[t].focus()},blurInputPath:function(e){u(e.length>0);var t=a.head(e);this.refs[t].blur()},getDOMNodeForPath:function(e){u(e.length>0);var t=a.head(e);return s.findDOMNode(this.refs[t])},getGrammarTypeForPath:function(e){return u(e.length>0),"number"},setInputValue:function(e,t,n){u(e.length>0);var r=a.head(e);this["handle"+(r.charAt(0).toUpperCase()+r.slice(1))+"Change"](t,n)},getUserInput:function(){return null},simpleValidate:function(e){return E.validate(this.getUserInput(),e)}});a.extend(E,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}});var k=function(e){var t=a.clone(e);return t.randomSeed=e.problemNum,t};e.exports={name:"simulator",displayName:"Simulator",widget:E,transform:k,hidden:!0}}).call(t,n(23))},720:function(e,t,n){var r=n(0),o=n(1),i=n(676),s=n(13).Options,a=n(19).shuffle,p=n(22),l=p.linterContextProps,u=p.linterContextDefault,c=r.createClass({displayName:"Sorter",propTypes:{apiOptions:s.propTypes,correct:r.PropTypes.array,layout:r.PropTypes.oneOf(["horizontal","vertical"]),onChange:r.PropTypes.func,padding:r.PropTypes.bool,problemNum:r.PropTypes.number,trackInteraction:r.PropTypes.func.isRequired,linterContext:l},getDefaultProps:function(){return{correct:[],layout:"horizontal",padding:!0,problemNum:0,onChange:function(){},linterContext:u}},render:function(){var e=a(this.props.correct,this.props.problemNum,!0),t=this.props.apiOptions.isMobile?8:5;return r.createElement("div",{className:"perseus-widget-sorter perseus-clearfix"},r.createElement(i,{options:e,layout:this.props.layout,margin:t,padding:this.props.padding,onChange:this.handleChange,linterContext:this.props.linterContext,ref:"sortable"}))},handleChange:function(e){this.props.onChange(e),this.props.trackInteraction()},getUserInput:function(){return{options:this.refs.sortable.getOptions()}},simpleValidate:function(e){return c.validate(this.getUserInput(),e)}});o.extend(c,{validate:function(e,t){return{type:"points",earned:o.isEqual(e.options,t.correct)?1:0,total:1,message:null}}}),e.exports={name:"sorter",displayName:"Sorter",widget:c,isLintable:!0}},721:function(e,t,n){var r=n(0),o=n(8),i=n(1),s=n(240),a=n(145),p=n(32),l=n(19),u=n(27).propTypes.keypadElementPropType,c=n(13).Options,h=n(67),d=n(22),f=d.linterContextProps,g=d.linterContextDefault,m=n(33).assert,y=function(e,t){return[""+e,""+t]},v=function(){return y(0,0)},b=function(e){return m(i.isArray(e)&&2===e.length),+e[0]},T=function(e){return m(i.isArray(e)&&2===e.length),+e[1]},P=function(e){return"answer"+b(e)+","+T(e)},x=r.createClass({displayName:"Table",propTypes:{answers:r.PropTypes.arrayOf(r.PropTypes.arrayOf(r.PropTypes.string)),editableHeaders:r.PropTypes.bool,Editor:r.PropTypes.func,headers:r.PropTypes.arrayOf(r.PropTypes.string),keypadElement:u,trackInteraction:r.PropTypes.func.isRequired,linterContext:f},getDefaultProps:function(){var e=i(4).times(function(){return l.stringArrayOfSize(1)});return{apiOptions:c.defaults,headers:[""],editableHeaders:!1,rows:4,columns:1,answers:e,linterContext:g}},_getRows:function(){return this.props.answers.length},_getColumns:function(){return this.props.answers[0].length},render:function(){var e=this,t=this._getRows(),n=this._getColumns(),o=this.props.headers,l=void 0,u=void 0;return this.props.apiOptions.customKeypad?(l=a,u={width:80}):this.props.apiOptions.staticRender?(l=s,u={}):(l="input",u={}),r.createElement("table",{className:"perseus-widget-table-of-values non-markdown"},r.createElement("thead",null,r.createElement("tr",null,i.map(o,function(t,n){return e.props.editableHeaders?r.createElement("th",{key:n},r.createElement(e.props.Editor,{ref:"columnHeader"+n,apiOptions:e.props.apiOptions,content:t,widgetEnabled:!1,onChange:i.partial(e.onHeaderChange,n)})):r.createElement("th",{key:n},r.createElement(p,{content:t,linterContext:e.props.linterContext}))}))),r.createElement("tbody",null,i(t).times(function(t){return r.createElement("tr",{key:t},i(n).times(function(n){return r.createElement("td",{key:n},r.createElement(l,{ref:P(y(t,n)),type:"text",value:e.props.answers[t][n],keypadElement:e.props.keypadElement,disabled:e.props.apiOptions.readOnly,onFocus:i.partial(e._handleFocus,y(t,n)),onBlur:i.partial(e._handleBlur,y(t,n)),onChange:i.partial(e.onValueChange,t,n),style:u}))}))})))},getUserInput:function(){return i.map(this.props.answers,i.clone)},onValueChange:function(e,t,n){var r=i.map(this.props.answers,i.clone);r[e][t]=n.target?n.target.value:n,this.props.onChange({answers:r}),this.props.trackInteraction()},onHeaderChange:function(e,t){var n=this.props.headers.slice();n[e]=t.content,this.props.onChange({headers:n})},simpleValidate:function(e){return x.validate(this.getUserInput(),e)},_handleFocus:function(e){this.props.onFocus(e)},_handleBlur:function(e){this.props.onBlur(e)},focus:function(){return this.focusInputPath(v()),!0},focusInputPath:function(e){var t=P(e),n=this.refs[t];this.props.apiOptions.customKeypad?n.focus():this.props.apiOptions.staticRender?n.focus():o.findDOMNode(n).focus()},blurInputPath:function(e){var t=P(e),n=this.refs[t];this.props.apiOptions.customKeypad?n.blur():this.props.apiOptions.staticRender?n.blur():o.findDOMNode(n).blur()},getDOMNodeForPath:function(e){var t=P(e);return o.findDOMNode(this.refs[t])},getInputPaths:function(){var e=this._getRows(),t=this._getColumns(),n=[];return i(e).times(function(e){i(t).times(function(t){var r=y(e,t);n.push(r)})}),n},getGrammarTypeForPath:function(e){return"number"},setInputValue:function(e,t,n){var r=b(e),o=T(e),s=i.map(this.props.answers,i.clone);s[r][o]=t,this.props.onChange({answers:s},n)}});i.extend(x,{validate:function(e,t){var n=function(e){return i.filter(e,function(e){return i.some(e,i.identity)})},r=n(t.answers),o=n(e);if(i.some(o,function(e){return i.some(e,function(e){return""===e})})||!o.length)return{type:"invalid",message:null};if(o.length!==r.length)return{type:"points",earned:0,total:1,message:null};var s=h.number.createValidatorFunctional,a=null;return{type:"points",earned:i.every(r,function(e){var t;for(t=0;t<o.length;t++){var n=o[t];if(i.every(n,function(t,n){var r=e[n],o=s(r,{simplify:!0}),i=o(t);return i.message&&(a=i.message),i.correct}))return o.splice(t,1),!0}return!1})?1:0,total:1,message:a}}});var C=function(e){var t=e.answers.length,n=e.answers[0].length,r=i(t).times(function(){return l.stringArrayOfSize(n)});return i.extend({},e,{answers:r})};e.exports={name:"table",displayName:"Table of values",accessible:!0,widget:x,transform:C,hidden:!0,isLintable:!0}},722:function(e,t,n){(function(t,r,o){function i(e,t){return v.object(v.map(e,function(e,n){return[n,e[t]]}))}function s(e){return e.constraints.fixed?z.DYNAMIC:z.INTERACTIVE}function a(e,t){var n=t[0][1]-t[0][0],r=t[1][1]-t[1][0];return e*Math.max(n,r)/20}function p(e,t,n){var r=D.subtract(e,t),o=D.scale(r,n);return D.add(t,o)}function l(e){return String(U.roundTo(9,e))}function u(e){var t=U.toFraction(e,A.DEFAULT_TOLERANCE);return 1===t[1]?l(e):l(t[0])+"/"+l(t[1])}function c(e){return[m.createElement(C,null,"("),l(e[0]),m.createElement(C,null,", {}"),l(e[1]),m.createElement(C,null,")")]}function h(e){return[m.createElement(C,null,"\\langle"),l(e[0]),m.createElement(C,null,", {}"),l(e[1]),m.createElement(C,null,"\\rangle")]}function d(e){return l(e)+S}function f(e,t){return e=v.clone(e).sort(F.compare),t=v.clone(t).sort(F.compare),v.all(v.map(e,function(e,n){var r=t[n];return F.equal(e,r)}))}var g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m=n(0),y=n(8),v=n(1),b=n(674),T=n(91),P=n(671),x=n(240),C=n(68),w=n(145),E=n(13).Options,k=n(27).propTypes.keypadElementPropType,S="°",M=n(90),I=M.iconPlus,_=M.iconUndo,R=n(19).deepEq,O=n(19).getGridStep,N=n(19).captureScratchpadTouchStart,A=n(9).number,D=n(9).vector,F=n(9).point,L=n(9).ray,H=n(9).line,U=n(43),z=n(42),q=n(33).assert,G={url:null},B=function(e,t){e=e||{};var n=e.labels||["x","y"],r=e.range||[[-10,10],[-10,10]],o=e.step||[1,1];return{box:[t,t],labels:n,range:r,step:o,gridStep:e.gridStep||O(r,o,t),valid:!0,backgroundImage:G,markings:"grid",showProtractor:!1}},V={apiOptions:E.defaults,gradeEmpty:!1,graphMode:"interactive",listMode:"dynamic",graph:{},tools:{translation:{enabled:!0,required:!1,constraints:{}},rotation:{enabled:!0,required:!1,constraints:{fixed:!1},coord:[1,6]},reflection:{enabled:!0,required:!1,constraints:{fixed:!1},coords:[[2,-4],[2,2]]},dilation:{enabled:!0,required:!1,constraints:{fixed:!1},coord:[6,6]}},drawSolutionShape:!0,starting:{shape:{type:"polygon-3",coords:[[2,2],[2,6],[7,2]]},transformations:[]},correct:{shape:{type:"polygon-3",coords:[[2,2],[2,6],[7,2]]},transformations:[]}},W=function(e){return e.customKeypad?w:e.staticRender?x:P},j={apply:function(e){return Y[e.type].isValid(e)?Y[e.type].apply(e):v.identity},append:function(e,t){var n=j._appendAndCollapseLastTwo(e,t);return j._collapseFinalNoOps(n)},_collapseFinalNoOps:function(e){return e.length&&j.isNoOp(v.last(e))?v.initial(e):e},_appendAndCollapseLastTwo:function(e,t){if(e.length){var n=j.collapse(v.last(e),t);return v.initial(e).concat(n)}return[t]},isNoOp:function(e){return Y[e.type].isNoOp(e)},collapse:function(e,t){return e.type!==t.type?[e,t]:j.isEmpty(e)&&j.isEmpty(t)?[]:j.isValid(e)&&j.isValid(t)?j._collapseValidMonotypedTransforms(e,t):[e,t]},isValid:function(e){return Y[e.type].isValid(e)},isEmpty:function(e){return Y[e.type].isEmpty(e)},_collapseValidMonotypedTransforms:function(e,t){var n=Y[e.type].collapse(e,t);return n?(v.isArray(n)||(n=[n]),v.each(n,function(t){t.type=e.type}),n):[e,t]},toTeX:function(e){return Y[e.type].toTeX(e)},ListItem:m.createClass({displayName:"ListItem",render:function(){if("dynamic"===this.props.mode)return m.createElement("div",null,j.toTeX(this.props.transform));if("interactive"===this.props.mode){var e=Y[this.props.transform.type].Input;return m.createElement(e,g({ref:"transform",onChange:this.handleChange,onFocus:this.props.onFocus,onBlur:this.props.onBlur,keypadElement:this.props.keypadElement,apiOptions:this.props.apiOptions},this.props.transform))}throw new Error("Invalid mode: "+this.props.mode)},value:function(){return"interactive"===this.props.mode?v.extend({type:this.props.transform.type},this.refs.transform.value()):this.props.transform},handleChange:v.debounce(function(e){this.props.onChange(this.value(),e)},300),_getComponentAtPath:function(e){var t=this.refs.transform,n=v.head(e);return t.refs[n]},focus:function(){var e=this.refs.transform,t=v.head(e.getInputPaths());t&&this.focusInputPath(t)},focusInputPath:function(e){this._getComponentAtPath(e).focus()},blurInputPath:function(e){this._getComponentAtPath(e).blur()},getDOMNodeForPath:function(e){return y.findDOMNode(this._getComponentAtPath(e))},getGrammarTypeForPath:function(e){return"number"},setInputValue:function(e,t,n){t.length&&(t=parseFloat(t),isNaN(t))||this.refs.transform.setInputValue(e,t,n)},getInputPaths:function(){return"dynamic"===this.props.mode?[]:this.refs.transform.getInputPaths()}})},Y={translation:{verbName:t._("Translate"),nounName:t._("Translation"),lowerNounName:t._("translation"),apply:function(e){return function(t){return D.add(t,e.vector)}},isValid:function(e){return v.isFinite(e.vector[0])&&v.isFinite(e.vector[1])},isEmpty:function(e){return null===e.vector[0]&&null===e.vector[1]},isNoOp:function(e){return D.equal(e.vector,[0,0])},collapse:function(e,t){return{vector:D.add(e.vector,t.vector)}},toTeX:function(e){return r({vector:h(e.vector)},"Translation by { vector }")},Input:m.createClass({displayName:"Input",getInitialState:function(){return{vector:this.props.vector||[null,null]}},componentDidUpdate:function(e){R(this.props,e)||this.setState({vector:this.props.vector})},render:function(){var e=this,t=W(this.props.apiOptions),n=[m.createElement(C,null,"\\langle"),m.createElement(t,{ref:"x",placeholder:0,value:this.state.vector[0],useArrowKeys:!0,onChange:function(t){var n=e.state.vector[1];e.setState({vector:[t,n]},function(){e.props.onChange()})},onFocus:v.partial(this.props.onFocus,"x"),onBlur:v.partial(this.props.onBlur,"x"),keypadElement:this.props.keypadElement}),m.createElement(C,null,", {}"),m.createElement(t,{ref:"y",placeholder:0,value:this.state.vector[1],useArrowKeys:!0,onChange:function(t){var n=e.state.vector[0];e.setState({vector:[n,t]},function(){e.props.onChange()})},onFocus:v.partial(this.props.onFocus,"y"),onBlur:v.partial(this.props.onBlur,"y"),keypadElement:this.props.keypadElement}),m.createElement(C,null,"\\rangle")];return m.createElement("div",null,r({vector:n},"Translation by { vector }"))},value:function(){return{vector:[this.refs.x.getValue(),this.refs.y.getValue()]}},setInputValue:function(e,t,n){var r=this,o=v.first(e),i=v.clone(this.state.vector);"x"===o?i[0]=t:"y"===o&&(i[1]=t),this.setState({vector:i},function(){r.props.onChange(n)})},getInputPaths:function(){return[["x"],["y"]]}})},rotation:{verbName:t._("Rotate"),nounName:t._("Rotation"),lowerNounName:t._("rotation"),apply:function(e){return function(t){return F.rotateDeg(t,e.angleDeg,e.center)}},isValid:function(e){return v.isFinite(e.angleDeg)&&v.isFinite(e.center[0])&&v.isFinite(e.center[1])},isEmpty:function(e){return null===e.angleDeg&&null===e.center[0]&&null===e.center[1]},isNoOp:function(e){return A.equal(e.angleDeg,0)},collapse:function(e,t){return!!F.equal(e.center,t.center)&&{center:e.center,angleDeg:e.angleDeg+t.angleDeg}},toTeX:function(e){return r({degrees:d(e.angleDeg),point:c(e.center)},"Rotation by { degrees } about { point }")},Input:m.createClass({displayName:"Input",getInitialState:function(){return{center:this.props.center||[null,null],angleDeg:this.props.angleDeg||null}},componentDidUpdate:function(e){R(this.props,e)||this.setState({center:this.props.center,angleDeg:this.props.angleDeg})},render:function(){var e=this,t=W(this.props.apiOptions),n=[m.createElement(C,null,"("),m.createElement(t,{ref:"centerX",placeholder:0,value:this.state.center[0],useArrowKeys:!0,onChange:function(t){var n=e.state.center[1];e.setState({center:[t,n]},function(){e.props.onChange()})},onFocus:v.partial(this.props.onFocus,"centerX"),onBlur:v.partial(this.props.onBlur,"centerX"),keypadElement:this.props.keypadElement}),m.createElement(C,null,", {}"),m.createElement(t,{ref:"centerY",placeholder:0,value:this.state.center[1],useArrowKeys:!0,onChange:function(t){var n=e.state.center[0];e.setState({center:[n,t]},function(){e.props.onChange()})},onFocus:v.partial(this.props.onFocus,"centerY"),onBlur:v.partial(this.props.onBlur,"centerY"),keypadElement:this.props.keypadElement}),m.createElement(C,null,")")],o=[m.createElement(t,{ref:"angleDeg",placeholder:0,value:this.state.angleDeg,useArrowKeys:!0,onChange:function(t){e.setState({angleDeg:t},function(){e.props.onChange()})},onFocus:v.partial(this.props.onFocus,"angleDeg"),onBlur:v.partial(this.props.onBlur,"angleDeg"),keypadElement:this.props.keypadElement}),S],i=r({point:n,degrees:o},"Rotation about { point } by { degrees }");return m.createElement("div",null,i)},value:function(){return{angleDeg:this.refs.angleDeg.getValue(),center:[this.refs.centerX.getValue(),this.refs.centerY.getValue()]}},setInputValue:function(e,t,n){var r=this,o=v.first(e),i=v.clone(this.state.angleDeg),s=v.clone(this.state.center);"angleDeg"===o?i=t:"centerX"===o?s[0]=t:"centerY"===o&&(s[1]=t),this.setState({angleDeg:i,center:s},function(){r.props.onChange(n)})},getInputPaths:function(){return[["centerX"],["centerY"],["angleDeg"]]}})},reflection:{verbName:t._("Reflect"),nounName:t._("Reflection"),lowerNounName:t._("reflection"),apply:function(e){return function(t){return F.reflectOverLine(t,e.line)}},isValid:function(e){return v.all(v.flatten(e.line),v.isFinite)&&!F.equal(e.line[0],e.line[1])},isEmpty:function(e){return v.all(v.flatten(e.line),v.isNull)},isNoOp:function(e){return!1},collapse:function(e,t){return!!H.equal(e.line,t.line)&&[]},toTeX:function(e){var t=e.line[0],n=e.line[1];return r({point1:c(t),point2:c(n)},"Reflection over the line from { point1 } to { point2 }")},Input:m.createClass({displayName:"Input",getInitialState:function(){return{line:this.props.line||[[null,null],[null,null]]}},componentDidUpdate:function(e){R(this.props,e)||this.setState({line:this.props.line})},render:function(){var e=W(this.props.apiOptions),t=[m.createElement(C,null,"("),m.createElement(e,{ref:"x1",value:this.state.line[0][0],useArrowKeys:!0,onChange:this.changePoint.bind(this,0,0),onFocus:v.partial(this.props.onFocus,"x1"),onBlur:v.partial(this.props.onBlur,"x1"),keypadElement:this.props.keypadElement}),m.createElement(C,null,", {}"),m.createElement(e,{ref:"y1",value:this.state.line[0][1],useArrowKeys:!0,onChange:this.changePoint.bind(this,0,1),onFocus:v.partial(this.props.onFocus,"y1"),onBlur:v.partial(this.props.onBlur,"y1"),keypadElement:this.props.keypadElement}),m.createElement(C,null,")")],n=[m.createElement(C,null,"("),m.createElement(e,{ref:"x2",value:this.state.line[1][0],useArrowKeys:!0,onChange:this.changePoint.bind(this,1,0),onFocus:v.partial(this.props.onFocus,"x2"),onBlur:v.partial(this.props.onBlur,"x2"),keypadElement:this.props.keypadElement}),m.createElement(C,null,", {}"),m.createElement(e,{ref:"y2",value:this.state.line[1][1],useArrowKeys:!0,onChange:this.changePoint.bind(this,1,1),onFocus:v.partial(this.props.onFocus,"y2"),onBlur:v.partial(this.props.onBlur,"y2"),keypadElement:this.props.keypadElement}),m.createElement(C,null,")")];return m.createElement("div",null,r({point1:t,point2:n},"Reflection over the line from { point1 } to { point2 }"))},changePoint:function(e,t,n,r){var o=this,i=v.map(this.state.line,v.clone);i[e][t]=n,this.setState({line:i},function(){o.props.onChange(r)})},value:function(){return{line:[[this.refs.x1.getValue(),this.refs.y1.getValue()],[this.refs.x2.getValue(),this.refs.y2.getValue()]]}},setInputValue:function(e,t,n){var r,o=v.first(e);"x"===o[0]?r=0:"y"===o[0]&&(r=1);var i;"1"===o[1]?i=0:"2"===o[1]&&(i=1),this.changePoint(i,r,t,n)},getInputPaths:function(){return[["x1"],["y1"],["x2"],["y2"]]}})},dilation:{verbName:t._("Dilate"),nounName:t._("Dilation"),lowerNounName:t._("dilation"),apply:function(e){return function(t){return p(t,e.center,e.scale)}},isValid:function(e){return v.isFinite(e.scale)&&v.isFinite(e.center[0])&&v.isFinite(e.center[1])},isEmpty:function(e){return null===e.scale&&null===e.center[0]&&null===e.center[1]},isNoOp:function(e){return A.equal(e.scale,1)},collapse:function(e,t){return!!F.equal(e.center,t.center)&&{center:e.center,scale:e.scale*t.scale}},toTeX:function(e){var t=u(e.scale);return r({scale:t,point:c(e.center)},"Dilation of scale { scale } about { point }")},Input:m.createClass({displayName:"Input",getInitialState:function(){return{center:this.props.center||[null,null],scale:this.props.scale||null}},componentDidUpdate:function(e){R(this.props,e)||this.setState({center:this.props.center,scale:this.props.scale})},render:function(){var e=this,t=W(this.props.apiOptions),n=[m.createElement(C,null,"("),m.createElement(t,{ref:"x",placeholder:0,value:this.state.center[0],useArrowKeys:!0,onChange:function(t){var n=e.state.center[1];e.setState({center:[t,n]},function(){e.props.onChange()})},onFocus:v.partial(this.props.onFocus,"x"),onBlur:v.partial(this.props.onBlur,"x"),keypadElement:this.props.keypadElement}),m.createElement(C,null,", {}"),m.createElement(t,{ref:"y",placeholder:0,value:this.state.center[1],useArrowKeys:!0,onChange:function(t){var n=e.state.center[0];e.setState({center:[n,t]},function(){e.props.onChange()})},onFocus:v.partial(this.props.onFocus,"y"),onBlur:v.partial(this.props.onBlur,"y"),keypadElement:this.props.keypadElement}),m.createElement(C,null,")")],o=m.createElement(t,{ref:"scale",placeholder:1,value:this.state.scale,useArrowKeys:!0,onChange:function(t){e.setState({scale:t},function(){e.props.onChange()})},onFocus:v.partial(this.props.onFocus,"scale"),onBlur:v.partial(this.props.onBlur,"scale"),keypadElement:this.props.keypadElement});return m.createElement("div",null,r({point:n,scale:o},"Dilation about { point } by { scale }"))},value:function(){return{scale:this.refs.scale.getValue(),center:[this.refs.x.getValue(),this.refs.y.getValue()]}},setInputValue:function(e,t,n){var r=this,o=v.first(e),i=this.state.scale,s=v.clone(this.state.center);"x"===o?s[0]=t:"y"===o?s[1]=t:"scale"===o&&(i=t),this.setState({scale:i,center:s},function(){r.props.onChange(n)})},getInputPaths:function(){return[["x"],["y"],["scale"]]}})}},X={getPointCountForType:function(e){var t=e.split("-");return"polygon"===t[0]?t[1]||3:"line"===t[0]||"lineSegment"===t[0]?2:"angle"===t[0]?3:"circle"===t[0]?2:"point"===t[0]?1:void 0},addMovableShape:function(e,t){if(t.editable&&t.translatable)throw new Error("It doesn't make sense to have a movable shape where you can stretch the points and translate them simultaneously. options: "+JSON.stringify(t));var n,r=v.map(t.shape.coords,function(o){var i,s=!1,a=o,p=function(e,o){s||(a=i.coord,s=!0);var p=D.subtract([e,o],i.coord);t.onMove&&(p=t.onMove(p[0],p[1])),t.translatable&&v.each(r,function(e){e!==i&&e.setCoord(D.add(e.coord,p))});var l=i.coord,u=D.add(i.coord,p);return i.coord=u,n.update(),i.coord=l,u},l=function(){if(t.onMoveEnd&&s){s=!1;var e=D.subtract(i.coord,a);t.onMoveEnd(e[0],e[1])}n.update()};return i=e.addMovablePoint({coord:o,normalStyle:t.normalPointStyle,highlightStyle:t.highlightPointStyle,constraints:{fixed:!t.translatable&&!t.editable},visible:t.showPoints,snapX:t.snap&&t.snap[0]||0,snapY:t.snap&&t.snap[1]||0,bounded:!1,onMove:p,onMoveEnd:l}),i.bounded=!0,i});n=X.addShape(e,t,r);var o=n.remove;return n.remove=function(){o.apply(n),v.invoke(r,"remove")},n},addShape:function(e,t,n){n=n||t.shape.coords;var r=X._typesOf(t.shape),o=t.shape.options||X.defaultOptions(r),i=X._mapTypes(r,n,function(n,r,i){var s=v.extend({},t,o[i]);return X._addType(e,n,r,s)}),s=v.filter(v.pluck(i,"update"),v.identity),a=function(){v.invoke(s,"call")},p=v.filter(v.pluck(i,"remove"),v.identity),l=function(){v.invoke(p,"call")},u=function(){return v.map(i,function(e){return e.getOptions?e.getOptions():{}})};return{type:r,points:n,update:a,remove:l,toJSON:function(){var e=v.map(n,function(e){return v.isArray(e)?e:e.coord});return{type:r,coords:e,options:u()}},getOptions:u}},equal:function(e,t){var n=X._typesOf(e),r=X._typesOf(t);if(n.length!==r.length)return!1;var o=X._mapTypes(n,e.coords,X._combine),i=X._mapTypes(r,t.coords,X._combine);return v.all(v.map(o,function(e,t){var n=i[t];return e.type===n.type&&X._forType(e.type).equal(e.coords,n.coords)}))},_typesOf:function(e){var t=e.type;return v.isArray(t)||(t=[t]),v.map(t,function(e){return"polygon"===e?"polygon-3":e})},defaultOptions:function(e){return v.map(e,function(e){var t=X._forType(e).defaultOptions;return v.extend({},t)})},_forType:function(e){var t=e.split("-")[0];return X[t]},_mapTypes:function(e,t,n,r){return v.map(e,function(e,o){var i=X.getPointCountForType(e),s=v.first(t,i);return t=v.rest(t,i),n.call(r,e,s,o)})},_addType:function(e,t,n,r){var o=v.isArray(n[0])?{coordA:n[0],coordZ:n[1]}:{pointA:n[0],pointZ:n[1]};if("polygon"===(t=t.split("-")[0])){var i=e.addMovablePolygon(v.extend({},r,{fixed:!r.editable,snapX:r.snap&&r.snap[0]||0,snapY:r.snap&&r.snap[1]||0,points:n,constrainToGraph:!1}));return{update:i.transform.bind(i),remove:i.remove.bind(i)}}if("line"===t||"lineSegment"===t){var s=e.addMovableLineSegment(v.extend({},r,o,{movePointsWithLine:!0,fixed:!0,constraints:{fixed:!0},extendLine:"line"===t}));return{update:s.transform.bind(s,!0),remove:s.remove.bind(s)}}if("angle"===t){var a=!!r.editable&&null,p=e.addMovableAngle({angleLabel:"$deg0",fixed:!0,points:n,normalStyle:r.normalStyle,reflex:r.reflex});return v.isArray(n[0])||r.editable||(n[0].remove(),n[2].remove()),{update:p.update.bind(p,a),remove:p.remove.bind(p),getOptions:function(){return{reflex:p.isReflex()}}}}if("circle"===t){var l={remove:v.identity},u=function(){var t=n[0].coord||n[0],o=n[1].coord||n[1],i=F.distanceToPoint(t,o);l.remove(),l=e.circle(t,i,v.extend({stroke:z.DYNAMIC,"stroke-width":2},r.normalStyle))};return u(),n[1].remove&&!r.editable&&n[1].remove(),{update:u,remove:function(){l.remove()}}}if("point"===t)return{update:null,remove:null};throw new Error("Invalid shape type "+t)},_combine:function(e,t){return{type:e,coords:t}},polygon:{equal:f},line:{equal:H.equal},lineSegment:{equal:f},angle:{equal:function(e,t){if(!F.equal(e[1],t[1]))return!1;var n=[e[1],e[0]],r=[e[1],e[2]],o=[t[1],t[0]],i=[t[1],t[2]],s=L.equal(n,o)&&L.equal(r,i),a=L.equal(n,i)&&L.equal(r,o);return s||a},defaultOptions:{reflex:!1}},circle:{equal:function(e,t){var n=F.distanceToPoint(e[0],e[1]),r=F.distanceToPoint(t[0],t[1]);return F.equal(e[0],t[0])&&A.equal(n,r)}},point:{equal:F.equal}},K=j.ListItem,Q=m.createClass({displayName:"TransformationList",render:function(){if("static"===this.props.mode)return m.createElement("span",null);var e=v.map(this.props.transformations,function(e,t){return m.createElement(K,{ref:"transformation"+t,key:"transformation"+t,transform:e,mode:this.props.mode,onChange:this.handleChange,onFocus:v.partial(this.props.onFocus,""+t),onBlur:v.partial(this.props.onBlur,""+t),keypadElement:this.props.keypadElement,apiOptions:this.props.apiOptions})},this);return m.createElement("div",{className:"perseus-transformation-list"},e)},_transformationRefs:function(){var e=this;return v.times(this.props.transformations.length,function(t){return e.refs["transformation"+t]})},value:function(){return v.invoke(this._transformationRefs(),"value")},handleChange:function(e,t){this.props.onChange(this.value(),t)},focusLast:function(){var e=this._transformationRefs();0!==e.length&&v.last(e).focus()}}),Z=m.createClass({displayName:"ToolButton",render:function(){var e=this.props.toggled?"simple-button exercise-orange toggled highlighted-tool-button":"simple-button";return m.createElement("button",{type:"button",className:e,disabled:this.props.disabled,onClick:this.props.onClick,onTouchStart:N},this.props.children)}}),J=m.createClass({displayName:"ToolsBar",getInitialState:function(){return{selected:null}},render:function(){var e=v.map(Y,function(e,t){if(this.props.enabled[t])return m.createElement(Z,{key:t,disabled:this.props.apiOptions.readOnly,toggled:this.state.selected===t,onClick:this.changeSelected.bind(this,t)},e.verbName)},this);return m.createElement("div",{className:"transformer-tools-bar"},m.createElement("span",{className:"simple-button-group"},e),m.createElement("button",{className:"transformer-undo-button simple-button",type:"button",disabled:this.props.apiOptions.readOnly,onClick:this.props.onUndoClick,onTouchStart:N},m.createElement(T,_)," ","Undo"),m.createElement("div",{className:"clear"}))},changeSelected:function(e){this.props.removeTool(this.state.selected),e&&e!==this.state.selected?(this.props.addTool(e),this.setState({selected:e})):this.setState({selected:null})}}),$=m.createClass({displayName:"AddTransformBar",render:function(){var e=v.map(Y,function(e,t){if(this.props.enabled[t])return m.createElement(Z,{key:t,toggled:!1,disabled:this.props.apiOptions.readOnly,onClick:this.changeSelected.bind(this,t)},m.createElement(T,I)," ",e.nounName)},this);return m.createElement("div",{className:"transformer-tools-bar"},e,m.createElement("button",{className:"transformer-undo-button simple-button",type:"button",onClick:this.props.onUndoClick,disabled:this.props.apiOptions.readOnly,onTouchStart:N},m.createElement(T,_)," ","Undo"),m.createElement("div",{className:"clear"}))},changeSelected:function(e){e&&this.props.addTool(e)}}),ee=m.createClass({displayName:"Transformer",propTypes:{apiOptions:E.propTypes,keypadElement:k,trackInteraction:m.PropTypes.func.isRequired},getDefaultProps:function(){return v.defaults({transformations:[]},V)},render:function(){var e=v.extend(B(this.props.graph,400),this.props.graph),t="interactive"===this.props.graphMode,n=t?J:$,r=m.createElement("div",{style:{width:e.box[0]}},m.createElement(n,{ref:"toolsBar",enabled:i(this.props.tools,"enabled"),apiOptions:this.props.apiOptions,addTool:this.addTool,removeTool:this.removeTool,onUndoClick:this.handleUndoClick}));return m.createElement("div",{className:"perseus-widget perseus-widget-transformer"},m.createElement(b,{ref:"graph",box:e.box,range:e.range,labels:e.labels,step:e.step,gridStep:e.gridStep,markings:e.markings,backgroundImage:e.backgroundImage,showProtractor:e.showProtractor,onGraphieUpdated:this.setupGraphie,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable}),!t&&"Add transformations below:","static"===this.props.graphMode&&[m.createElement("br",{key:"static-br"}),m.createElement("em",{key:"static-nomove"}," ","Note: For this question, the shape will not move."," ")],t&&r,m.createElement(Q,{ref:"transformationList",mode:this.props.listMode,transformations:this.props.transformations,onChange:this.setTransformationProps,onFocus:this._handleFocus,onBlur:this._handleBlur,keypadElement:this.props.keypadElement,apiOptions:this.props.apiOptions}),!t&&r)},componentDidMount:function(){this.setupGraphie(this.graphie())},componentDidUpdate:function(e){this.shouldSetupGraphie(this.props,e)?this.refs.graph.reset():R(this.props.transformations,this.transformations)||this.setTransformations(this.props.transformations)},shouldSetupGraphie:function(e,t){return!R(t.starting,e.starting)||t.graphMode!==e.graphMode||t.listMode!==e.listMode||t.drawSolutionShape!==e.drawSolutionShape||!(!e.drawSolutionShape||R(t.correct.shape,e.correct.shape))||!R(this.tools,e.tools)},graphie:function(){return this.refs.graph.graphie()},setupGraphie:function(e){this.props.drawSolutionShape&&this.props.correct.shape&&this.props.correct.shape.coords&&X.addShape(e,{fixed:!0,shape:this.props.correct.shape,normalStyle:{stroke:z.GRAY,"stroke-dasharray":"","stroke-width":2}}),this.currentTool=null,this.refs.toolsBar.changeSelected(null),this.addTransformerShape(this.props.starting.shape,!1),this.setTransformations(this.props.transformations),this.tools={translation:v.clone(this.props.tools.translation),rotation:v.clone(this.props.tools.rotation),reflection:v.clone(this.props.tools.reflection),dilation:v.clone(this.props.tools.dilation)}},setTransformations:function(e){this.resetCoords(),this.transformations=v.clone(e),v.each(this.transformations,this.applyTransform)},addTransformerShape:function(e,t){var n=this,r=this.graphie();this.shape=X.addMovableShape(r,{shape:e,editable:!1,showPoints:"static"!==this.props.graphMode,translatable:t,onMove:function(e,t){return e=U.roundToNearest(r.snap[0],e),t=U.roundToNearest(r.snap[1],t),n.addTransform({type:"translation",vector:[e,t]}),[e,t]},normalPointStyle:{fill:t?z.INTERACTIVE:z.DYNAMIC,stroke:t?z.INTERACTIVE:z.DYNAMIC},highlightPointStyle:{fill:z.INTERACTING,stroke:z.INTERACTING}})},addTool:function(e){var t=this;if("interactive"===this.props.graphMode)if("translation"===e)this.currentTool=this.addTranslationTool();else if("rotation"===e)this.currentTool=this.addRotationTool();else if("reflection"===e)this.currentTool=this.addReflectionTool();else{if("dilation"!==e)throw new Error("Invalid tool id: "+e);this.currentTool=this.addDilationTool()}else{var n;if("translation"===e)n={type:e,vector:[null,null]};else if("rotation"===e)n={type:e,center:[null,null],angleDeg:null};else if("reflection"===e)n={type:e,line:[[null,null],[null,null]]};else{if("dilation"!==e)throw new Error("Invalid tool id: "+e);n={type:e,center:[null,null],scale:null}}this.doTransform(n,function(){t.refs.transformationList.focusLast()})}},removeTool:function(e){this.currentTool&&this.currentTool.remove(),this.currentTool=null},addTranslationTool:function(){var e=this;return this.shape.remove(),this.addTransformerShape(this.shape.toJSON(),!0),{remove:function(){e.shape.remove(),e.addTransformerShape(e.shape.toJSON(),!1)}}},snapCoord:function(e){var t=this.graphie();return v.map(e,function(e,n){return U.roundToNearest(t.snap[n],e)})},normalizeReflectionCoords:function(e){var t=this.snapCoord(H.midpoint(e)),n=D.polarDegFromCart(D.subtract(e[0],e[1])),r=[1,U.roundToNearest(45,n[1])],o=D.cartFromPolarDeg(r);return v.map([-1,1],function(e){var n=D.add(t,D.scale(o,e*this.scaleToCurrentRange(2)));return this.snapCoord(n)},this)},addReflectionTool:function(){var e=this.props.tools.reflection;if(e.enabled){var t,n=this,r=this.refs.graph.graphie(),i=function(){n.changeTool("reflection",{coords:v.pluck(p,"coord")})},a=this.normalizeReflectionCoords(e.coords),p=v.map(a,function(e){return r.addMovablePoint({coord:e,visible:!1})},this),l=s(e);r.style({},function(){t=r.addMovableLineSegment({fixed:e.constraints.fixed,constraints:e.constraints,pointA:p[0],pointZ:p[1],snapX:r.snap[0],snapY:r.snap[1],extendLine:!0,normalStyle:{stroke:l,"stroke-width":2,"stroke-dasharray":"- "},highlightStyle:{stroke:z.INTERACTING,"stroke-width":2,"stroke-dasharray":"- "},movePointsWithLine:!0,onMoveEnd:i})});var u=r.addReflectButton({fixed:e.constraints.fixed,line:t,size:this.scaleToCurrentRange(1),onClick:function(){n.doTransform({type:"reflection",line:v.pluck(p,"coord")}),c&&(c.setCoord(D.add(u.coord,D.subtract(u.coord,c.coord))),c.update())},normalStyle:{stroke:l,"stroke-width":2,fill:l},highlightStyle:{stroke:z.INTERACTING,"stroke-width":3,fill:z.INTERACTING},onMoveEnd:i}),c=null;if(!e.constraints.fixed){var h=D.polarDegFromCart(D.subtract(p[1].coord,p[0].coord))[1]+90;c=r.addRotateHandle({center:u,radius:this.scaleToCurrentRange(2),angleDeg:h,width:this.scaleToCurrentRange(.24),hoverWidth:this.scaleToCurrentRange(.4),lengthAngle:17,onMove:function(e){return U.roundToNearest(45,e)},onMoveEnd:i})}return o(t).on("move",function(){u.update(),o(u).trigger("move")}),c&&o(c).on("move",function(){var e=n.snapCoord(c.coord),r=D.subtract(e,u.coord),o=u.isFlipped()?1:0;p[o].setCoord(D.add(u.coord,D.rotateDeg(r,90))),p[1-o].setCoord(D.add(u.coord,D.rotateDeg(r,-90))),t.transform(!0),u.update()}),{remove:function(){u.remove(),c&&c.remove(),t.remove(),p[0].remove(),p[1].remove()}}}},scaleToCurrentRange:function(e){return a(e,this.refs.graph.props.range)},addRotationTool:function(){var e=this.props.tools.rotation;if(e.enabled){var t=this,n=this.refs.graph.graphie(),r=s(e);return this.rotatePoint=n.addMovablePoint({constraints:e.constraints,coord:e.coord,snapX:n.snap[0],snapY:n.snap[1],normalStyle:{"stroke-dasharray":"",stroke:r,fill:r},highlightStyle:{"stroke-dasharray":"",stroke:z.INTERACTING,fill:z.INTERACTING}}),this.rotateHandle=n.addRotateHandle({center:this.rotatePoint,radius:this.scaleToCurrentRange(1.5),width:this.scaleToCurrentRange(.24),hoverWidth:this.scaleToCurrentRange(.4),onMove:function(e,n){var r=t.getRotationTransformFromAngle(t.rotatePoint.coord,e-n);return t.doTransform(r),n+r.angleDeg}}),this.rotatePoint.onMoveEnd=function(e,n){t.changeTool("rotation",{coord:[e,n]})},{remove:function(){t.rotateHandle.remove(),t.rotatePoint.remove()}}}},addDilationTool:function(){var e=this.props.tools.dilation;if(e.enabled){var t=this,n=this.refs.graph.graphie(),r=s(e);t.dilationCircle=n.addCircleGraph({centerConstraints:e.constraints,center:e.coord,radius:t.scaleToCurrentRange(2),snapX:n.snap[0],snapY:n.snap[1],minRadius:t.scaleToCurrentRange(1),snapRadius:t.scaleToCurrentRange(.5),onResize:function(e,n){t.doTransform({type:"dilation",center:t.dilationCircle.centerPoint.coord,scale:e/n})},circleNormalStyle:{stroke:r,"stroke-width":2,"stroke-dasharray":"- ","fill-opacity":0},circleHighlightStyle:{stroke:z.INTERACTING,"stroke-width":2,"stroke-dasharray":"",fill:z.INTERACTING,"fill-opacity":.05},centerNormalStyle:{stroke:r,fill:r,"stroke-width":2,"stroke-dasharray":""},centerHighlightStyle:{stroke:r,fill:r,"stroke-width":2,"stroke-dasharray":""}});var o=this.dilationCircle.centerPoint.onMoveEnd;return this.dilationCircle.centerPoint.onMoveEnd=function(){o&&o.apply(this,v.toArray(arguments)),t.changeTool("dilation",{coord:t.dilationCircle.centerPoint.coord})},{remove:function(){t.dilationCircle.remove()}}}},getRotationTransformFromAngle:function(e,t){return t=(t+360)%360,t>180&&(t-=360),{type:"rotation",center:e,angleDeg:15*Math.round(t/15)}},doTransform:function(e,t){this.applyTransform(e),this.addTransform(e,t)},applyTransform:function(e){if("static"!==this.props.graphMode){var t=j.apply(e);this.applyCoordTransformation(t)}},applyCoordTransformation:function(e){v.each(this.shape.points,function(t){var n=e(t.coord);t.setCoord(n)}),this.shape.update()},resetCoords:function(){var e=this.props.starting.shape.coords;v.each(this.shape.points,function(t,n){t.setCoord(e[n])}),this.shape.update()},handleUndoClick:function(){this.refs.toolsBar.changeSelected(null),this.props.transformations.length&&this.props.onChange({transformations:v.initial(this.props.transformations)})},setTransformationProps:function(e,t){this.props.onChange({transformations:e},t)},addTransform:function(e,t){this.transformations=j.append(this.transformations,e),this.props.onChange({transformations:v.clone(this.transformations)},t)},changeTool:function(e,t){var n=v.clone(this.props.tools);n[e]=v.extend({},this.props.tools[e],t),this.tools[e]=v.clone(n[e]),this.props.onChange({tools:n}),this.props.trackInteraction()},simpleValidate:function(e){return ee.validate(this.getUserInput(),e)},getCoords:function(){var e=this.props.starting.shape.coords,t=this.props.transformations;return v.reduce(t,function(e,t){return v.map(e,j.apply(t))},e)},getEditorJSON:function(){var e=v.pick(this.props,"grading","starting","graphMode","listMode","tools","drawSolutionShape","gradeEmpty");return e.graph=this.refs.graph.toJSON(),e.version=1.2,e.answer=this.getUserInput(),e},getUserInput:function(){return{transformations:this.props.transformations,shape:{type:this.shape.type,coords:this.getCoords(),options:this.shape.getOptions()}}},_handleFocus:function(){var e=Array.prototype.slice.call(arguments);this.props.onFocus(e)},_handleBlur:function(){var e=Array.prototype.slice.call(arguments);this.props.onBlur(e)},_getTransformationForID:function(e){var t=["transformationList","transformation"+e],n=this;return v.each(t,function(e){n=n.refs[e]}),n},getInputPaths:function(){var e=this;if("static"===this.props.listMode)return[];var t=[];return v.each(this.props.transformations,function(n,r){var n=e._getTransformationForID(r),o=n.getInputPaths(),i=v.map(o,function(e){return[""+r].concat(e)});t=t.concat(i)}),t},_passToInner:function(e,t){if(t&&t.length){var n=v.rest(t),r=[n].concat(v.rest(arguments,2)),o=v.head(t),i=this._getTransformationForID(o);return i[e].apply(i,r)}},focus:function(){var e=this.getInputPaths();return e.length>0&&(this.focusInputPath(e[0]),!0)},focusInputPath:function(e){return 0!==e.length&&(q(e.length>=2),this._passToInner("focusInputPath",e))},blurInputPath:function(e){return 0!==e.length&&(q(e.length>=2),this._passToInner("blurInputPath",e))},setInputValue:function(e,t,n){return q(e.length>=2),this._passToInner("setInputValue",e,t,n)},getDOMNodeForPath:function(e){return q(e.length>=2),this._passToInner("getDOMNodeForPath",e)},getGrammarTypeForPath:function(e){return q(e.length>=2),this._passToInner("getGrammarTypeForPath",e)}});v.extend(ee,{validate:function(e,n){for(var r in Y)if(n.tools[r].required){var o=v.any(v.map(e.transformations,function(e){return e.type===r&&!j.isEmpty(e)&&!j.isNoOp(e)}));if(!o)return{type:"invalid",message:t._("Your transformation must use a { type }.",{type:Y[r].lowerNounName})}}return X.equal(e.shape,n.correct.shape)?{type:"points",earned:1,total:1,message:null}:!n.gradeEmpty&&R(e.shape.coords,n.starting.shape.coords)?{type:"invalid",message:t._("Use the interactive graph to define a correct transformation.")}:{type:"points",earned:0,total:1,message:null}}}),e.exports={name:"transformer",displayName:"Transformer",widget:ee}}).call(t,n(23),n(245),n(10))},723:function(e,t,n){(function(t,r,o){var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=n(148),a=n(0),p=n(8),l=n(1),u=n(13).ClassNames,c=n(13).Options,h=n(143),d=n(240),f=n(724),g=f.SignificantFigures,m=f.displaySigFigs,y=function(e){return new g(e).sigFigs},v=function(e,t){return m(e,t,-10,!1)},b=a.createClass({displayName:"OldUnitInput",propTypes:i({},h.propTypes,{value:a.PropTypes.string}),getDefaultProps:function(){return{apiOptions:c.defaults,value:""}},render:function(){var e=this.props.apiOptions.staticRender?a.createFactory(d):a.DOM.input,n=e({onChange:this.handleChange,ref:"input",className:u.INTERACTIVE,value:this.props.value,onFocus:this.handleFocus,onBlur:this.handleBlur});return a.createElement("div",{className:"old-unit-input"},n,a.createElement("div",{ref:"error",className:"error",style:{display:"none"}},t._("I don't understand that")))},_errorTimeout:null,_showError:function(){if(""!==this.props.value){var e=r(p.findDOMNode(this.refs.error));e.is(":visible")||e.css({top:50,opacity:.1}).show().animate({top:0,opacity:1},300)}},_hideError:function(){var e=r(p.findDOMNode(this.refs.error));e.is(":visible")&&e.animate({top:50,opacity:.1},300,function(){r(this).hide()})},change:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return h.change.apply(this,t)},componentDidUpdate:function(){clearTimeout(this._errorTimeout),o.unitParse(this.props.value).parsed?this._hideError():this._errorTimeout=setTimeout(this._showError,2e3)},componentWillUnmount:function(){clearTimeout(this._errorTimeout)},handleBlur:function(){this.props.onBlur([]),clearTimeout(this._errorTimeout),o.unitParse(this.props.value).parsed||this._showError()},handleChange:function(e){this._hideError(),this.props.onChange({value:e.target.value})},simpleValidate:function(e,t){return t=t||function(){},b.validate(this.getUserInput(),e)},getUserInput:function(){return this.props.value},getInputPaths:function(){return[[]]},focusInputPath:function(e){p.findDOMNode(this.refs.input).focus()},handleFocus:function(){this.props.onFocus([])},blurInputPath:function(e){p.findDOMNode(this.refs.input).blur()},setInputValue:function(e,t,n){this.props.onChange({value:t},n)},getDOMNodeForPath:function(){return p.findDOMNode(this.refs.input)},getGrammarTypeForPath:function(e){return"unit"}}),T=function(e){return e.simplify().asMul().partition()[1].flatten().simplify()};l.extend(b,{validate:function(e,n){var r=o.unitParse(n.value).expr,i=o.unitParse(e);if(!i.parsed)return{type:"invalid",message:t._("I couldn't understand those units.")};var s=null,a=n.sigfigs,p=y(i.coefficient)===a;p||(s=t._("Check your significant figures."));var u;try{var c=new o.Var("x"),h=new o.Eq(r.simplify(),"=",new o.Mul(c,i.expr.simplify())),d=h.solveLinearEquationForVariable(c);u=Number(d.eval()).toPrecision(a)===Number(1).toPrecision(a)}catch(e){u=!1}u||(s=t._("That answer is numerically incorrect."));var f,g=T(i.expr.simplify()),m=T(r.simplify());if(!(f="all"===n.accepting?o.compare(g,m).equal:l(n.acceptingUnits).any(function(e){var t=T(o.unitParse(e).unit.simplify());return o.compare(t,g).equal})))var s=t._("Check your units.");return{type:"points",earned:f&&u&&p?1:0,total:1,message:s}}}),e.exports={name:"unit-input",displayName:"Unit",defaultAlignment:"inline-block",widget:b,transform:function(e){return s(e).del(["value"]).freeze()},version:{major:0,minor:1},countSigfigs:y,sigfigPrint:v,hidden:!0}}).call(t,n(23),n(10),n(146))},724:function(e,t){function n(e){this.order=a(e),this.mantissa=s(e),this.positive=i(e),this.sigFigs=this.mantissa.length,this.sigDecs=this.order-this.mantissa.length}function r(e,t,n,r){var l,u,c,h=""+e,d=a(h),f=s(h),g=i(h),m=!1;if(0==e||""==f||"0"==f){for(f="",C=0;C<t;C++)f+="0";d=t+n,n<0&&-n>=t&&(m=!0)}else{if(u=d-f.length-n,c=t-f.length,(l=Math.min(c,u))<0){var y=p(f,-l);y.length>f.length+l&&(d++,u>c&&(y=p(y,1))),f=y}else if(l>0)for(C=0;C<l;C++)f+="0";""!=f&&"0"!=f||(f="0",g=!0,0!=(d=1+n)&&(m=!0))}var v=r||f.length>20||d>4||d<-2||d-f.length>0&&o(f)>0||m,b="";if(g||(b+="-"),v)b+=f.charAt(0),f.length>1&&(b+="."+f.substring(1,f.length)),d-1!=0&&(b+=" x 10^"+(d-1));else{var T="",P="",x=!0;if(d>0)if(f.length>d)T=f.substring(0,d),P=f.substring(d,f.length);else{T=f,x=0!=o(f);for(var C=0;C<d-f.length;C++)T+="0"}else{for(C=0;C<-d;C++)P+="0";P+=f}b+=(""==T?"0":T)+(x?".":"")+P}return b}function o(e){for(var t=0,n=e.length-1;n>=0;n--){if("0"!=e.charAt(n))return t;t++}return t}function i(e){for(var t=!0,n=!1,r=!1,o="",i="",s="",a=0,p=0,l=!0,u=0;u<e.length;u++){var c=e.charAt(u);if(c>="1"&&c<="9")s+=o+c,o="",r=!0,n||(p++,a++),t=!1;else if("0"==c)n?r?(s+=o+c,o=""):(i+=c,a--):(p++,r?(i+=c,a++,o+=c):i+=c),t=!1;else if(n||"."!=c)if("e"==c||"E"==c&&u+1<e.length){var h=parseInt(e.substring(u+1,e.length));a+=h,p+=h,u=e.length}else!t||"+"!=c&&"-"!=c||"-"==c&&(l=!l);else s+=o,o="",n=!0,t=!1}return""==s||l}function s(e){for(var t=!0,n=!1,r=!1,o="",i="",s="",a=0,p=0,l=!0,u=0;u<e.length;u++){var c=e.charAt(u);if(c>="1"&&c<="9")s+=o+c,o="",r=!0,n||(p++,a++),t=!1;else if("0"==c)n?r?(s+=o+c,o=""):(i+=c,a--):(p++,r?(i+=c,a++,o+=c):i+=c),t=!1;else if(n||"."!=c)if("e"==c||"E"==c&&u+1<e.length){var h=parseInt(e.substring(u+1,e.length));a+=h,p+=h,u=e.length}else!t||"+"!=c&&"-"!=c||"-"==c&&(l=!l);else s+=o,o="",n=!0,t=!1}return""==s?i:s}function a(e){for(var t=!0,n=!1,r=!1,o="",i="",s="",a=0,p=0,l=!0,u=0;u<e.length;u++){var c=e.charAt(u);if(c>="1"&&c<="9")s+=o+c,o="",r=!0,n||(p++,a++),t=!1;else if("0"==c)n?r?(s+=o+c,o=""):(i+=c,a--):(p++,r?(i+=c,a++,o+=c):i+=c),t=!1;else if(n||"."!=c)if("e"==c||"E"==c&&u+1<e.length){var h=parseInt(e.substring(u+1,e.length));a+=h,p+=h,u=e.length}else!t||"+"!=c&&"-"!=c||"-"==c&&(l=!l);else s+=o,o="",n=!0,t=!1}return""==s?p:a}function p(e,t){var n=e.length-t-1;if(n<0)return"";if(n>=e.length-1)return e;var r=e.charAt(n+1),o=e.charAt(n),i=!1;if(r>"5")i=!0;else if("5"==r){for(var s=n+2;s<e.length;s++)"0"!=e.charAt(s)&&(i=!0);o%2==1&&(i=!0)}for(var a="",p=n;p>=0;p--){var l=e.charAt(p);if(i){var u;if("9"==l)u="0";else{switch(l){case"0":u="1";break;case"1":u="2";break;case"2":u="3";break;case"3":u="4";break;case"4":u="5";break;case"5":u="6";break;case"6":u="7";break;case"7":u="8";break;case"8":u="9"}i=!1}a=u+a}else a=l+a}return i&&(a="1"+a),a}e.exports={SignificantFigures:n,displaySigFigs:r}},725:function(e,t,n){var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(0),i=n(1),s=n(143),a=n(246),p="https://{hostname}/embed_video?slug={slug}&internal_video_only=1",l=/^https?:\/\//,u=/khanacademy\.org/,c=o.createClass({displayName:"Video",propTypes:r({},s.propTypes,{alignment:o.PropTypes.string,location:o.PropTypes.string}),getUserInput:function(){return null},simpleValidate:function(e){return c.validate(null,e)},change:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.change.apply(this,t)},render:function(){var e=this.props.location;if(!e)return o.createElement("div",null);var t;if(l.test(e))t=e;else{t=p.replace("{slug}",e);var n=document.location.hostname,r="www.khanacademy.org";u.test(n)&&(r=n),t=t.replace("{hostname}",r)}return o.createElement(a,{width:1280,height:720,key:e+this.props.alignment},o.createElement("iframe",{className:"perseus-video-widget",sandbox:"allow-same-origin allow-scripts",width:1280,height:720,src:t,allowFullScreen:!0}))}});i.extend(c,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),e.exports={name:"video",displayName:"Video",defaultAlignment:"block",supportedAlignments:["block","float-left","float-right","full-width"],widget:c}}});